# .gitignore

```
*.iml .gradle /local.properties /.idea/caches /.idea/libraries /.idea/modules.xml /.idea/workspace.xml /.idea/navEditor.xml /.idea/assetWizardSettings.xml .DS_Store /build /captures .externalNativeBuild .cxx local.properties
```

# .idea\.gitignore

```
# Default ignored files /shelf/ /workspace.xml
```

# .idea\.name

```
AlayaApp
```

# .idea\AndroidProjectSystem.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="AndroidProjectSystem"> <option name="providerId" value="com.android.tools.idea.GradleProjectSystem" /> </component> </project>
```

# .idea\caches\deviceStreaming.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="DeviceStreaming"> <option name="deviceSelectionList"> <list> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="Sony" /> <option name="codename" value="A402SO" /> <option name="id" value="A402SO" /> <option name="labId" value="google" /> <option name="manufacturer" value="Sony" /> <option name="name" value="Xperia 10" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2520" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="27" /> <option name="brand" value="DOCOMO" /> <option name="codename" value="F01L" /> <option name="id" value="F01L" /> <option name="labId" value="google" /> <option name="manufacturer" value="FUJITSU" /> <option name="name" value="F-01L" /> <option name="screenDensity" value="360" /> <option name="screenX" value="720" /> <option name="screenY" value="1280" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="OnePlus" /> <option name="codename" value="OP535DL1" /> <option name="id" value="OP535DL1" /> <option name="labId" value="google" /> <option name="manufacturer" value="OnePlus" /> <option name="name" value="CPH2409" /> <option name="screenDensity" value="401" /> <option name="screenX" value="1080" /> <option name="screenY" value="2412" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="OnePlus" /> <option name="codename" value="OP5552L1" /> <option name="id" value="OP5552L1" /> <option name="labId" value="google" /> <option name="manufacturer" value="OnePlus" /> <option name="name" value="CPH2415" /> <option name="screenDensity" value="480" /> <option name="screenX" value="1080" /> <option name="screenY" value="2412" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="OPPO" /> <option name="codename" value="OP573DL1" /> <option name="id" value="OP573DL1" /> <option name="labId" value="google" /> <option name="manufacturer" value="OPPO" /> <option name="name" value="CPH2557" /> <option name="screenDensity" value="480" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="28" /> <option name="brand" value="DOCOMO" /> <option name="codename" value="SH-01L" /> <option name="id" value="SH-01L" /> <option name="labId" value="google" /> <option name="manufacturer" value="SHARP" /> <option name="name" value="AQUOS sense2 SH-01L" /> <option name="screenDensity" value="480" /> <option name="screenX" value="1080" /> <option name="screenY" value="2160" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="a15" /> <option name="id" value="a15" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="A15" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="a15x" /> <option name="id" value="a15x" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="A15 5G" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="a16x" /> <option name="id" value="a16x" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="A16 5G" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="a35x" /> <option name="id" value="a35x" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="A35" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="31" /> <option name="brand" value="samsung" /> <option name="codename" value="a51" /> <option name="id" value="a51" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy A51" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="akita" /> <option name="id" value="akita" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 8a" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="motorola" /> <option name="codename" value="arcfox" /> <option name="id" value="arcfox" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="razr plus 2024" /> <option name="screenDensity" value="360" /> <option name="screenX" value="1080" /> <option name="screenY" value="1272" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="motorola" /> <option name="codename" value="austin" /> <option name="id" value="austin" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="moto g 5G (2022)" /> <option name="screenDensity" value="280" /> <option name="screenX" value="720" /> <option name="screenY" value="1600" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="samsung" /> <option name="codename" value="b0q" /> <option name="id" value="b0q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S22 Ultra" /> <option name="screenDensity" value="600" /> <option name="screenX" value="1440" /> <option name="screenY" value="3088" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="b6q" /> <option name="id" value="b6q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Flip 6" /> <option name="screenDensity" value="340" /> <option name="screenX" value="1080" /> <option name="screenY" value="2640" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="32" /> <option name="brand" value="google" /> <option name="codename" value="bluejay" /> <option name="id" value="bluejay" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 6a" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="caiman" /> <option name="id" value="caiman" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro" /> <option name="screenDensity" value="360" /> <option name="screenX" value="960" /> <option name="screenY" value="2142" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="google" /> <option name="codename" value="caiman" /> <option name="id" value="caiman" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro" /> <option name="screenDensity" value="360" /> <option name="screenX" value="960" /> <option name="screenY" value="2142" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="comet" /> <option name="default" value="true" /> <option name="id" value="comet" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro Fold" /> <option name="screenDensity" value="390" /> <option name="screenX" value="2076" /> <option name="screenY" value="2152" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="google" /> <option name="codename" value="comet" /> <option name="default" value="true" /> <option name="id" value="comet" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro Fold" /> <option name="screenDensity" value="390" /> <option name="screenX" value="2076" /> <option name="screenY" value="2152" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="29" /> <option name="brand" value="samsung" /> <option name="codename" value="crownqlteue" /> <option name="id" value="crownqlteue" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Note9" /> <option name="screenDensity" value="420" /> <option name="screenX" value="2220" /> <option name="screenY" value="1080" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="dm2q" /> <option name="id" value="dm2q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="S23 Plus" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="dm3q" /> <option name="id" value="dm3q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S23 Ultra" /> <option name="screenDensity" value="600" /> <option name="screenX" value="1440" /> <option name="screenY" value="3088" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="motorola" /> <option name="codename" value="dubai" /> <option name="id" value="dubai" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="edge 30" /> <option name="screenDensity" value="405" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="e1q" /> <option name="default" value="true" /> <option name="id" value="e1q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S24" /> <option name="screenDensity" value="480" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="e3q" /> <option name="id" value="e3q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S24 Ultra" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1440" /> <option name="screenY" value="3120" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="eos" /> <option name="id" value="eos" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Eos" /> <option name="screenDensity" value="320" /> <option name="screenX" value="384" /> <option name="screenY" value="384" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="felix" /> <option name="id" value="felix" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel Fold" /> <option name="screenDensity" value="420" /> <option name="screenX" value="2208" /> <option name="screenY" value="1840" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="felix" /> <option name="id" value="felix" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel Fold" /> <option name="screenDensity" value="420" /> <option name="screenX" value="2208" /> <option name="screenY" value="1840" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="felix_camera" /> <option name="id" value="felix_camera" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel Fold (Camera-enabled)" /> <option name="screenDensity" value="420" /> <option name="screenX" value="2208" /> <option name="screenY" value="1840" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="motorola" /> <option name="codename" value="fogona" /> <option name="id" value="fogona" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="moto g play - 2024" /> <option name="screenDensity" value="280" /> <option name="screenX" value="720" /> <option name="screenY" value="1600" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="motorola" /> <option name="codename" value="fogos" /> <option name="id" value="fogos" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="moto g34 5G" /> <option name="screenDensity" value="280" /> <option name="screenX" value="720" /> <option name="screenY" value="1600" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="g0q" /> <option name="id" value="g0q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-S906U1" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="gta9pwifi" /> <option name="id" value="gta9pwifi" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-X210" /> <option name="screenDensity" value="240" /> <option name="screenX" value="1200" /> <option name="screenY" value="1920" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="samsung" /> <option name="codename" value="gts7lwifi" /> <option name="id" value="gts7lwifi" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-T870" /> <option name="screenDensity" value="340" /> <option name="screenX" value="1600" /> <option name="screenY" value="2560" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="gts7xllite" /> <option name="id" value="gts7xllite" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-T738U" /> <option name="screenDensity" value="340" /> <option name="screenX" value="1600" /> <option name="screenY" value="2560" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="samsung" /> <option name="codename" value="gts8uwifi" /> <option name="formFactor" value="Tablet" /> <option name="id" value="gts8uwifi" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Tab S8 Ultra" /> <option name="screenDensity" value="320" /> <option name="screenX" value="1848" /> <option name="screenY" value="2960" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="gts8wifi" /> <option name="formFactor" value="Tablet" /> <option name="id" value="gts8wifi" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Tab S8" /> <option name="screenDensity" value="274" /> <option name="screenX" value="1600" /> <option name="screenY" value="2560" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="gts9fe" /> <option name="id" value="gts9fe" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Tab S9 FE 5G" /> <option name="screenDensity" value="280" /> <option name="screenX" value="1440" /> <option name="screenY" value="2304" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="gts9wifi" /> <option name="id" value="gts9wifi" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-X710" /> <option name="screenDensity" value="340" /> <option name="screenX" value="1600" /> <option name="screenY" value="2560" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="husky" /> <option name="id" value="husky" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 8 Pro" /> <option name="screenDensity" value="390" /> <option name="screenX" value="1008" /> <option name="screenY" value="2244" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="30" /> <option name="brand" value="motorola" /> <option name="codename" value="java" /> <option name="id" value="java" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="G20" /> <option name="screenDensity" value="280" /> <option name="screenX" value="720" /> <option name="screenY" value="1600" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="komodo" /> <option name="id" value="komodo" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro XL" /> <option name="screenDensity" value="360" /> <option name="screenX" value="1008" /> <option name="screenY" value="2244" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="google" /> <option name="codename" value="komodo" /> <option name="id" value="komodo" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9 Pro XL" /> <option name="screenDensity" value="360" /> <option name="screenX" value="1008" /> <option name="screenY" value="2244" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="lynx" /> <option name="id" value="lynx" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 7a" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="motorola" /> <option name="codename" value="manaus" /> <option name="id" value="manaus" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="edge 40 neo" /> <option name="screenDensity" value="400" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="motorola" /> <option name="codename" value="maui" /> <option name="id" value="maui" /> <option name="labId" value="google" /> <option name="manufacturer" value="Motorola" /> <option name="name" value="moto g play - 2023" /> <option name="screenDensity" value="280" /> <option name="screenX" value="720" /> <option name="screenY" value="1600" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="o1q" /> <option name="id" value="o1q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S21" /> <option name="screenDensity" value="421" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="31" /> <option name="brand" value="google" /> <option name="codename" value="oriole" /> <option name="id" value="oriole" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 6" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="samsung" /> <option name="codename" value="pa3q" /> <option name="id" value="pa3q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S25 Ultra" /> <option name="screenDensity" value="600" /> <option name="screenX" value="1440" /> <option name="screenY" value="3120" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="panther" /> <option name="id" value="panther" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 7" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="q5q" /> <option name="id" value="q5q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Z Fold5" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1812" /> <option name="screenY" value="2176" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="q6q" /> <option name="id" value="q6q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy Z Fold6" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1856" /> <option name="screenY" value="2160" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="30" /> <option name="brand" value="google" /> <option name="codename" value="r11" /> <option name="formFactor" value="Wear OS" /> <option name="id" value="r11" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel Watch" /> <option name="screenDensity" value="320" /> <option name="screenX" value="384" /> <option name="screenY" value="384" /> <option name="type" value="WEAR_OS" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="r11q" /> <option name="id" value="r11q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-S711U" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="30" /> <option name="brand" value="google" /> <option name="codename" value="redfin" /> <option name="id" value="redfin" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 5" /> <option name="screenDensity" value="440" /> <option name="screenX" value="1080" /> <option name="screenY" value="2340" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="shiba" /> <option name="id" value="shiba" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 8" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="t2q" /> <option name="id" value="t2q" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="Galaxy S21 Plus" /> <option name="screenDensity" value="394" /> <option name="screenX" value="1080" /> <option name="screenY" value="2400" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="33" /> <option name="brand" value="google" /> <option name="codename" value="tangorpro" /> <option name="formFactor" value="Tablet" /> <option name="id" value="tangorpro" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel Tablet" /> <option name="screenDensity" value="320" /> <option name="screenX" value="1600" /> <option name="screenY" value="2560" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="google" /> <option name="codename" value="tegu" /> <option name="id" value="tegu" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9a" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2424" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="google" /> <option name="codename" value="tokay" /> <option name="default" value="true" /> <option name="id" value="tokay" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2424" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="35" /> <option name="brand" value="google" /> <option name="codename" value="tokay" /> <option name="default" value="true" /> <option name="id" value="tokay" /> <option name="labId" value="google" /> <option name="manufacturer" value="Google" /> <option name="name" value="Pixel 9" /> <option name="screenDensity" value="420" /> <option name="screenX" value="1080" /> <option name="screenY" value="2424" /> </PersistentDeviceSelectionData> <PersistentDeviceSelectionData> <option name="api" value="34" /> <option name="brand" value="samsung" /> <option name="codename" value="xcover7" /> <option name="id" value="xcover7" /> <option name="labId" value="google" /> <option name="manufacturer" value="Samsung" /> <option name="name" value="SM-G556B" /> <option name="screenDensity" value="450" /> <option name="screenX" value="1080" /> <option name="screenY" value="2408" /> </PersistentDeviceSelectionData> </list> </option> </component> </project>
```

# .idea\compiler.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="CompilerConfiguration"> <bytecodeTargetLevel target="21" /> </component> </project>
```

# .idea\deploymentTargetSelector.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="deploymentTargetSelector"> <selectionStates> <SelectionState runConfigName="app"> <option name="selectionMode" value="DROPDOWN" /> <DropdownSelection timestamp="2025-06-15T18:25:17.015305100Z"> <Target type="DEFAULT_BOOT"> <handle> <DeviceId pluginId="PhysicalDevice" identifier="serial=3B6F5TE910B9NBBS" /> </handle> </Target> </DropdownSelection> <DialogSelection /> </SelectionState> </selectionStates> </component> </project>
```

# .idea\gradle.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="GradleMigrationSettings" migrationVersion="1" /> <component name="GradleSettings"> <option name="linkedExternalProjectsSettings"> <GradleProjectSettings> <option name="testRunner" value="CHOOSE_PER_TEST" /> <option name="externalProjectPath" value="$PROJECT_DIR$" /> <option name="gradleJvm" value="#GRADLE_LOCAL_JAVA_HOME" /> <option name="modules"> <set> <option value="$PROJECT_DIR$" /> <option value="$PROJECT_DIR$/app" /> </set> </option> </GradleProjectSettings> </option> </component> </project>
```

# .idea\migrations.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="ProjectMigrations"> <option name="MigrateToGradleLocalJavaHome"> <set> <option value="$PROJECT_DIR$" /> </set> </option> </component> </project>
```

# .idea\misc.xml

```xml
<project version="4"> <component name="ExternalStorageConfigurationManager" enabled="true" /> <component name="ProjectRootManager" version="2" languageLevel="JDK_21" default="true" project-jdk-name="jbr-21" project-jdk-type="JavaSDK"> <output url="file://$PROJECT_DIR$/build/classes" /> </component> <component name="ProjectType"> <option name="id" value="Android" /> </component> </project>
```

# .idea\runConfigurations.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="RunConfigurationProducerService"> <option name="ignoredProducers"> <set> <option value="com.intellij.execution.junit.AbstractAllInDirectoryConfigurationProducer" /> <option value="com.intellij.execution.junit.AllInPackageConfigurationProducer" /> <option value="com.intellij.execution.junit.PatternConfigurationProducer" /> <option value="com.intellij.execution.junit.TestInClassConfigurationProducer" /> <option value="com.intellij.execution.junit.UniqueIdConfigurationProducer" /> <option value="com.intellij.execution.junit.testDiscovery.JUnitTestDiscoveryConfigurationProducer" /> <option value="org.jetbrains.kotlin.idea.junit.KotlinJUnitRunConfigurationProducer" /> <option value="org.jetbrains.kotlin.idea.junit.KotlinPatternConfigurationProducer" /> </set> </option> </component> </project>
```

# .idea\vcs.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="VcsDirectoryMappings"> <mapping directory="$PROJECT_DIR$" vcs="Git" /> </component> </project>
```

# .idea\workspace.xml

```xml
<?xml version="1.0" encoding="UTF-8"?> <project version="4"> <component name="AndroidLayouts"> <shared> <config /> </shared> <layouts> <layout url="file://$PROJECT_DIR$/app/src/main/res/drawable/bg_itinerary_number_indicator.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_change_password.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_home.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_itineraries.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_itinerary_adapter.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_itinerary_item.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_itinerary_log_detail.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_login.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_manual_location_picker.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_maps.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_place_details.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_profile.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_reset_password.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_sign_up.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_transportation_mode.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_trip_history.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/activity_welcome_page.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/custom_info_window.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_changes_saved.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_customize_itinerary.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_edit_text.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_enter_name.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_enter_phone.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_itinerary_alternatives.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_location_notification.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_prompt_birthday.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_success_password_change.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/dialog_welcome_alaya.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_alternative_itinerary_card.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_customize_spinner_row.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_footer_message.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_header.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_horizontal_list.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_location_header.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_log_entry_detail.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_recommended.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_place_card.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_transport_option.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/item_trip_history.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/list_item_itinerary.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> <layout url="file://$PROJECT_DIR$/app/src/main/res/layout/list_item_location_suggestion.xml"> <config> <theme>@style/Theme.AlayaApp</theme> </config> </layout> </layouts> </component> <component name="AutoImportSettings"> <option name="autoReloadType" value="NONE" /> </component> <component name="ChangeListManager"> <list default="true" id="01420886-470c-47ac-81ec-ac261690f18c" name="Changes" comment="updated codebase.md"> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItinerariesActivity.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItinerariesActivity.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryAdapter.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryAdapter.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryGenerator.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryGenerator.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryItem.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryItem.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryState.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryState.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryViewModel.java" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/java/com/example/alayaapp/ItineraryViewModel.java" afterDir="false" /> <change beforePath="$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_location_header.xml" beforeDir="false" afterPath="$PROJECT_DIR$/app/src/main/res/layout/item_itinerary_location_header.xml" afterDir="false" /> <change beforePath="$PROJECT_DIR$/project_summary.md" beforeDir="false" afterPath="$PROJECT_DIR$/project_summary.md" afterDir="false" /> </list> <option name="SHOW_DIALOG" value="false" /> <option name="HIGHLIGHT_CONFLICTS" value="true" /> <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" /> <option name="LAST_RESOLUTION" value="IGNORE" /> </component> <component name="ClangdSettings"> <option name="formatViaClangd" value="false" /> </component> <component name="ExecutionTargetManager" SELECTED_TARGET="device_and_snapshot_combo_box_target[DeviceId(pluginId=PhysicalDevice, isTemplate=false, identifier=serial=3B6F5TE910B9NBBS)]" /> <component name="ExternalProjectsData"> <projectState path="$PROJECT_DIR$"> <ProjectState /> </projectState> </component> <component name="ExternalProjectsManager"> <system id="GRADLE"> <state> <task path="$PROJECT_DIR$/app"> <activation /> </task> <projects_view> <tree_state> <expand> <path> <item name="" type="6a2764b6:ExternalProjectsStructure$RootNode" /> <item name="AlayaApp" type="f1a62948:ProjectNode" /> </path> <path> <item name="" type="6a2764b6:ExternalProjectsStructure$RootNode" /> <item name="AlayaApp" type="f1a62948:ProjectNode" /> <item name="app" type="2d1252cf:ModuleNode" /> </path> <path> <item name="" type="6a2764b6:ExternalProjectsStructure$RootNode" /> <item name="AlayaApp" type="f1a62948:ProjectNode" /> <item name="app" type="2d1252cf:ModuleNode" /> <item name="Tasks" type="e4a08cd1:TasksNode" /> </path> <path> <item name="" type="6a2764b6:ExternalProjectsStructure$RootNode" /> <item name="AlayaApp" type="f1a62948:ProjectNode" /> <item name="app" type="2d1252cf:ModuleNode" /> <item name="Tasks" type="e4a08cd1:TasksNode" /> <item name="other" type="c8890929:TasksNode$1" /> </path> </expand> <select /> </tree_state> </projects_view> </state> </system> </component> <component name="FileTemplateManagerImpl"> <option name="RECENT_TEMPLATES"> <list> <option value="valueResourceFile" /> <option value="resourceFile" /> <option value="Class" /> <option value="layoutResourceFile" /> </list> </option> </component> <component name="Git.Settings"> <option name="RECENT_BRANCH_BY_REPOSITORY"> <map> <entry key="$PROJECT_DIR$" value="FunctionTest" /> </map> </option> <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" /> </component> <component name="ProblemsViewState"> <option name="selectedTabId" value="CurrentFile" /> </component> <component name="ProjectColorInfo">{ &quot;associatedIndex&quot;: 3 }</component> <component name="ProjectId" id="2wRunvZDOSrTA8PqpTivsjYb5zE" /> <component name="ProjectViewState"> <option name="hideEmptyMiddlePackages" value="true" /> <option name="showLibraryContents" value="true" /> </component> <component name="PropertiesComponent">{ &quot;keyToString&quot;: { &quot;Android App.app.executor&quot;: &quot;Run&quot;, &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;, &quot;RunOnceActivity.cidr.known.project.marker&quot;: &quot;true&quot;, &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;, &quot;RunOnceActivity.readMode.enableVisualFormatting&quot;: &quot;true&quot;, &quot;ScreenRecorder.SavePath&quot;: &quot;C:\\Users\\Fretz\\Videos&quot;, &quot;ScreenshotViewer.SavePath&quot;: &quot;C:/Users/Fretz/Pictures&quot;, &quot;cf.first.check.clang-format&quot;: &quot;false&quot;, &quot;cidr.known.project.marker&quot;: &quot;true&quot;, &quot;git-widget-placeholder&quot;: &quot;mapsroute&quot;, &quot;ignore.virus.scanning.warn.message&quot;: &quot;true&quot;, &quot;kotlin-language-version-configured&quot;: &quot;true&quot;, &quot;last_opened_file_path&quot;: &quot;C:/Users/Fretz/Videos&quot;, &quot;project.structure.last.edited&quot;: &quot;Modules&quot;, &quot;project.structure.proportion&quot;: &quot;0.17&quot;, &quot;project.structure.side.proportion&quot;: &quot;0.2&quot;, &quot;settings.editor.selected.configurable&quot;: &quot;reference.settingsdialog.project.gradle&quot; } }</component> <component name="RecentsManager"> <key name="MoveFile.RECENT_KEYS"> <recent name="C:\Users\Fretz\Documents\Android Studio Projects\app\src\main\res\drawable" /> </key> </component> <component name="RunManager"> <configuration name="app" type="AndroidRunConfigurationType" factoryName="Android App" activateToolWindowBeforeRun="false"> <module name="AlayaApp.app" /> <option name="ANDROID_RUN_CONFIGURATION_SCHEMA_VERSION" value="1" /> <option name="DEPLOY" value="true" /> <option name="DEPLOY_APK_FROM_BUNDLE" value="false" /> <option name="DEPLOY_AS_INSTANT" value="false" /> <option name="ARTIFACT_NAME" value="" /> <option name="PM_INSTALL_OPTIONS" value="" /> <option name="ALL_USERS" value="false" /> <option name="ALWAYS_INSTALL_WITH_PM" value="false" /> <option name="ALLOW_ASSUME_VERIFIED" value="false" /> <option name="CLEAR_APP_STORAGE" value="false" /> <option name="DYNAMIC_FEATURES_DISABLED_LIST" value="" /> <option name="ACTIVITY_EXTRA_FLAGS" value="" /> <option name="MODE" value="default_activity" /> <option name="RESTORE_ENABLED" value="false" /> <option name="RESTORE_FILE" value="" /> <option name="RESTORE_FRESH_INSTALL_ONLY" value="false" /> <option name="CLEAR_LOGCAT" value="false" /> <option name="SHOW_LOGCAT_AUTOMATICALLY" value="false" /> <option name="TARGET_SELECTION_MODE" value="DEVICE_AND_SNAPSHOT_COMBO_BOX" /> <option name="SELECTED_CLOUD_MATRIX_CONFIGURATION_ID" value="-1" /> <option name="SELECTED_CLOUD_MATRIX_PROJECT_ID" value="" /> <option name="DEBUGGER_TYPE" value="Auto" /> <Auto> <option name="USE_JAVA_AWARE_DEBUGGER" value="false" /> <option name="SHOW_STATIC_VARS" value="true" /> <option name="WORKING_DIR" value="" /> <option name="TARGET_LOGGING_CHANNELS" value="lldb process:gdb-remote packets" /> <option name="SHOW_OPTIMIZED_WARNING" value="true" /> <option name="ATTACH_ON_WAIT_FOR_DEBUGGER" value="false" /> <option name="DEBUG_SANDBOX_SDK" value="false" /> </Auto> <Hybrid> <option name="USE_JAVA_AWARE_DEBUGGER" value="false" /> <option name="SHOW_STATIC_VARS" value="true" /> <option name="WORKING_DIR" value="" /> <option name="TARGET_LOGGING_CHANNELS" value="lldb process:gdb-remote packets" /> <option name="SHOW_OPTIMIZED_WARNING" value="true" /> <option name="ATTACH_ON_WAIT_FOR_DEBUGGER" value="false" /> <option name="DEBUG_SANDBOX_SDK" value="false" /> </Hybrid> <Java> <option name="ATTACH_ON_WAIT_FOR_DEBUGGER" value="false" /> <option name="DEBUG_SANDBOX_SDK" value="false" /> </Java> <Native> <option name="USE_JAVA_AWARE_DEBUGGER" value="false" /> <option name="SHOW_STATIC_VARS" value="true" /> <option name="WORKING_DIR" value="" /> <option name="TARGET_LOGGING_CHANNELS" value="lldb process:gdb-remote packets" /> <option name="SHOW_OPTIMIZED_WARNING" value="true" /> <option name="ATTACH_ON_WAIT_FOR_DEBUGGER" value="false" /> <option name="DEBUG_SANDBOX_SDK" value="false" /> </Native> <Profilers> <option name="ADVANCED_PROFILING_ENABLED" value="false" /> <option name="STARTUP_PROFILING_ENABLED" value="false" /> <option name="STARTUP_CPU_PROFILING_ENABLED" value="false" /> <option name="STARTUP_CPU_PROFILING_CONFIGURATION_NAME" value="Java/Kotlin Method Sample (legacy)" /> <option name="STARTUP_NATIVE_MEMORY_PROFILING_ENABLED" value="false" /> <option name="NATIVE_MEMORY_SAMPLE_RATE_BYTES" value="2048" /> </Profilers> <option name="DEEP_LINK" value="" /> <option name="ACTIVITY" value="" /> <option name="ACTIVITY_CLASS" value="" /> <option name="SEARCH_ACTIVITY_IN_GLOBAL_SCOPE" value="false" /> <option name="SKIP_ACTIVITY_VALIDATION" value="false" /> <method v="2"> <option name="Android.Gradle.BeforeRunTask" enabled="true" /> </method> </configuration> </component> <component name="SpellCheckerSettings" RuntimeDictionaries="0" Folders="0" CustomDictionaries="0" DefaultDictionary="application-level" UseSingleDictionary="true" transferred="true" /> <component name="TaskManager"> <task active="true" id="Default" summary="Default task"> <changelist id="01420886-470c-47ac-81ec-ac261690f18c" name="Changes" comment="" /> <created>1746016877842</created> <option name="number" value="Default" /> <option name="presentableId" value="Default" /> <updated>1746016877842</updated> </task> <task id="LOCAL-00001" summary="updated codebase.md"> <option name="closed" value="true" /> <created>1747818895780</created> <option name="number" value="00001" /> <option name="presentableId" value="LOCAL-00001" /> <option name="project" value="LOCAL" /> <updated>1747818895780</updated> </task> <option name="localTasksCounter" value="2" /> <servers /> </component> <component name="Vcs.Log.Tabs.Properties"> <option name="TAB_STATES"> <map> <entry key="MAIN"> <value> <State> <option name="FILTERS"> <map> <entry key="branch"> <value> <list> <option value="HEAD" /> </list> </value> </entry> </map> </option> </State> </value> </entry> </map> </option> </component> <component name="VcsManagerConfiguration"> <MESSAGE value="updated codebase.md" /> <option name="LAST_COMMIT_MESSAGE" value="updated codebase.md" /> </component> <component name="play_dynamic_filters_status"> <option name="appIdToCheckInfo"> <map> <entry key="com.example.alayaapp"> <value> <CheckInfo lastCheckTimestamp="1750089316389" /> </value> </entry> <entry key="com.example.alayaapp.test"> <value> <CheckInfo lastCheckTimestamp="1750089316390" /> </value> </entry> </map> </option> </component> </project>
```

# AlayaApp.zip

This is a binary file of the type: Compressed Archive

# app\.gitignore

```
/build
```

# app\build.gradle.kts

```kts
// Import necessary for reading properties file import java.util.Properties import java.io.FileInputStream plugins { alias(libs.plugins.android.application) id("com.google.gms.google-services") } // --- Code to read from local.properties --- val localProperties = Properties() val localPropertiesFile = rootProject.file("local.properties") if (localPropertiesFile.exists()) { localProperties.load(FileInputStream(localPropertiesFile)) } // Get the API key, or an empty string if it's not found val mapsApiKey = localProperties.getProperty("MAPS_API_KEY") ?: "" android { namespace = "com.example.alayaapp" compileSdk = 35 defaultConfig { applicationId = "com.example.alayaapp" minSdk = 24 targetSdk = 34 versionCode = 1 versionName = "1.0" testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner" manifestPlaceholders["mapsApiKey"] = mapsApiKey } buildTypes { release { isMinifyEnabled = false proguardFiles( getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro" ) } } compileOptions { sourceCompatibility = JavaVersion.VERSION_17 targetCompatibility = JavaVersion.VERSION_17 } buildFeatures { viewBinding = true } buildToolsVersion = "35.0.1" ndkVersion = "26.3.11579264" } dependencies { // --- NEW DEPENDENCIES FOR VIEWMODEL AND LIVEDATA --- implementation("com.google.code.gson:gson:2.10.1") // For state serialization implementation("androidx.lifecycle:lifecycle-viewmodel:2.8.4") implementation("androidx.lifecycle:lifecycle-livedata:2.8.4") implementation(platform("com.google.firebase:firebase-bom:33.13.0")) implementation("com.google.firebase:firebase-analytics") implementation("com.google.firebase:firebase-auth") implementation(libs.appcompat) implementation(libs.material) implementation(libs.activity) implementation(libs.constraintlayout) implementation(libs.play.services.maps) // Removed duplicate play-services-maps implementation(libs.play.services.location) testImplementation(libs.junit) implementation(libs.maps.utils) androidTestImplementation(libs.ext.junit) androidTestImplementation(libs.espresso.core) implementation("com.google.firebase:firebase-auth-ktx") implementation("com.google.firebase:firebase-database") implementation("de.hdodenhof:circleimageview:3.1.0") implementation("com.google.firebase:firebase-firestore") implementation("com.google.firebase:firebase-storage") implementation("com.github.bumptech.glide:glide:4.16.0") // Removed duplicate circleimageview }
```

# app\google-services.json

```json
{ "project_info": { "project_number": "634657318925", "firebase_url": "https://alayadatabase-22359-default-rtdb.asia-southeast1.firebasedatabase.app", "project_id": "alayadatabase-22359", "storage_bucket": "alayadatabase-22359.firebasestorage.app" }, "client": [ { "client_info": { "mobilesdk_app_id": "1:634657318925:android:fceef01169359ac9160d44", "android_client_info": { "package_name": "com.example.alayaapp" } }, "oauth_client": [], "api_key": [ { "current_key": "AIzaSyAG34ABq5LJk7aSyT4mRbH_7Uqg0KHs2-k" } ], "services": { "appinvite_service": { "other_platform_oauth_client": [] } } } ], "configuration_version": "1" }
```

# app\proguard-rules.pro

```pro
# Add project specific ProGuard rules here. # You can control the set of applied configuration files using the # proguardFiles setting in build.gradle. # # For more details, see # http://developer.android.com/guide/developing/tools/proguard.html # If your project uses WebView with JS, uncomment the following # and specify the fully qualified class name to the JavaScript interface # class: #-keepclassmembers class fqcn.of.javascript.interface.for.webview { # public *; #} # Uncomment this to preserve the line number information for # debugging stack traces. #-keepattributes SourceFile,LineNumberTable # If you keep the line number information, uncomment this to # hide the original source file name. #-renamesourcefileattribute SourceFile
```

# app\src\androidTest\java\com\example\alayaapp\ExampleInstrumentedTest.java

```java
package com.example.alayaapp; import android.content.Context; import androidx.test.platform.app.InstrumentationRegistry; import androidx.test.ext.junit.runners.AndroidJUnit4; import org.junit.Test; import org.junit.runner.RunWith; import static org.junit.Assert.*; /** * Instrumented test, which will execute on an Android device. * * @see <a href="http://d.android.com/tools/testing">Testing documentation</a> */ @RunWith(AndroidJUnit4.class) public class ExampleInstrumentedTest { @Test public void useAppContext() { // Context of the app under test. Context appContext = InstrumentationRegistry.getInstrumentation().getTargetContext(); assertEquals("com.example.alayaapp", appContext.getPackageName()); } }
```

# app\src\main\AndroidManifest.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <manifest xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" package="com.example.alayaapp"> <uses-permission android:name="android.permission.INTERNET" /> <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /> <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" /> <application android:allowBackup="true" android:dataExtractionRules="@xml/data_extraction_rules" android:fullBackupContent="@xml/backup_rules" android:icon="@mipmap/ic_launcher" android:label="@string/app_name" android:roundIcon="@mipmap/ic_launcher_round" android:supportsRtl="true" android:theme="@style/Theme.AlayaApp" tools:targetApi="34"> <meta-data android:name="com.google.android.geo.API_KEY" android:value="${mapsApiKey}" /> <activity android:name=".MapsActivity" android:exported="false" /> <activity android:name=".ManualLocationPickerActivity" android:exported="false" android:label="Set Location" android:parentActivityName=".HomeActivity" > <meta-data android:name="android.support.PARENT_ACTIVITY" android:value=".HomeActivity" /> </activity> <activity android:name=".ItineraryLogDetailActivity" android:exported="false" /> <activity android:name=".TripHistoryActivity" android:exported="false" /> <activity android:name=".SplashActivity" android:exported="true" android:theme="@style/Theme.AlayaApp.SplashImitation"> <intent-filter> <action android:name="android.intent.action.MAIN" /> <category android:name="android.intent.category.LAUNCHER" /> </intent-filter> </activity> <activity android:name=".LoginActivity" android:exported="false" /> <activity android:name=".SignUpActivity" android:exported="false" /> <activity android:name=".HomeActivity" android:exported="false" android:windowSoftInputMode="adjustPan" /> <activity android:name=".ItinerariesActivity" android:exported="false" android:windowSoftInputMode="adjustPan" /> <activity android:name=".ResetPasswordActivity" /> <activity android:name=".PlaceDetailsActivity" android:exported="false" /> <meta-data android:name="preloaded_fonts" android:resource="@array/preloaded_fonts" /> <activity android:name=".ChangePasswordActivity" android:exported="false" /> <activity android:name=".TransportationModeActivity" android:exported="false" /> <activity android:name=".ProfileActivity" android:exported="false" /> <!-- The declaration for .MainActivity has been removed from here. --> </application> </manifest>
```

# app\src\main\java\com\example\alayaapp\ChangePasswordActivity.java

```java
package com.example.alayaapp; import androidx.annotation.NonNull; // Import NonNull import androidx.appcompat.app.AppCompatActivity; import android.os.Bundle; // import android.text.method.PasswordTransformationMethod; // Already there, keep if using custom toggle import android.util.Log; // For logging import android.view.View; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityChangePasswordBinding; import com.google.android.gms.tasks.OnCompleteListener; // For Firebase tasks import com.google.android.gms.tasks.Task; // For Firebase tasks import com.google.android.material.textfield.TextInputLayout; import com.google.firebase.auth.FirebaseAuth; // Firebase Auth import com.google.firebase.auth.FirebaseUser; // Firebase User public class ChangePasswordActivity extends AppCompatActivity { private ActivityChangePasswordBinding binding; private FirebaseAuth mAuth; // Firebase Auth instance private static final String TAG = "ChangePasswordActivity"; // For logging @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityChangePasswordBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); mAuth = FirebaseAuth.getInstance(); // Initialize Firebase Auth // Back arrow listener binding.ivBackArrowChangePassword.setOnClickListener(v -> { finish(); // Go back to the previous activity }); // Submit button listener binding.btnChangePasswordSubmit.setOnClickListener(v -> { handleChangePassword(); }); } private void handleChangePassword() { String newPassword = binding.etNewPassword.getText().toString().trim(); String confirmPassword = binding.etConfirmPassword.getText().toString().trim(); // Basic Validation if (newPassword.isEmpty()) { binding.tilNewPassword.setError("New password cannot be empty"); binding.etNewPassword.requestFocus(); return; } else { binding.tilNewPassword.setError(null); } // Firebase requires passwords to be at least 6 characters. if (newPassword.length() < 6) { binding.tilNewPassword.setError("Password must be at least 6 characters"); binding.etNewPassword.requestFocus(); return; } else { binding.tilNewPassword.setError(null); } if (confirmPassword.isEmpty()) { binding.tilConfirmPassword.setError("Please confirm your password"); binding.etConfirmPassword.requestFocus(); return; } else { binding.tilConfirmPassword.setError(null); } if (!newPassword.equals(confirmPassword)) { binding.tilConfirmPassword.setError("Passwords do not match"); binding.etConfirmPassword.requestFocus(); // Keep focus here binding.tilNewPassword.setError("Passwords do not match"); // Also show on new password return; } else { binding.tilConfirmPassword.setError(null); binding.tilNewPassword.setError(null); // Clear error on new password if they match } // --- Firebase Password Change Logic --- FirebaseUser user = mAuth.getCurrentUser(); if (user != null) { binding.btnChangePasswordSubmit.setEnabled(false); // Disable button during operation Toast.makeText(this, "Updating password...", Toast.LENGTH_SHORT).show(); user.updatePassword(newPassword) .addOnCompleteListener(new OnCompleteListener<Void>() { @Override public void onComplete(@NonNull Task<Void> task) { binding.btnChangePasswordSubmit.setEnabled(true); // Re-enable button if (task.isSuccessful()) { Log.d(TAG, "User password updated."); Toast.makeText(ChangePasswordActivity.this, "Password updated successfully!", Toast.LENGTH_LONG).show(); finish(); // Close this activity and return to profile } else { Log.e(TAG, "Error updating password", task.getException()); String errorMessage = "Failed to update password."; if (task.getException() != null) { // You might want to check for specific Firebase Auth exceptions // e.g., FirebaseAuthWeakPasswordException, FirebaseAuthRecentLoginRequiredException errorMessage += " " + task.getException().getMessage(); if (task.getException().getMessage().contains("CREDENTIAL_TOO_OLD_LOGIN_AGAIN")) { errorMessage = "For security, please sign out and sign back in before changing your password."; } } Toast.makeText(ChangePasswordActivity.this, errorMessage, Toast.LENGTH_LONG).show(); binding.tilNewPassword.setError(errorMessage); // Show error on a field } } }); } else { // This shouldn't happen if the user reached this screen while logged in Toast.makeText(this, "No user signed in. Please sign in again.", Toast.LENGTH_LONG).show(); Log.e(TAG, "Cannot change password: No user is currently signed in."); } } }
```

# app\src\main\java\com\example\alayaapp\CustomInfoWindowAdapter.java

```java
package com.example.alayaapp; import android.content.Context; import android.view.LayoutInflater; import android.view.View; import android.widget.ImageView; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import com.bumptech.glide.Glide; import com.google.android.gms.maps.GoogleMap; import com.google.android.gms.maps.model.Marker; import java.util.HashMap; import java.util.Locale; public class CustomInfoWindowAdapter implements GoogleMap.InfoWindowAdapter { private final View mWindow; private Context mContext; private HashMap<String, Place> markerPlaceMap; public CustomInfoWindowAdapter(Context context, HashMap<String, Place> markerPlaceMap) { mContext = context; this.markerPlaceMap = markerPlaceMap; mWindow = LayoutInflater.from(context).inflate(R.layout.custom_info_window, null); } private void renderWindowText(Marker marker, View view) { Place place = markerPlaceMap.get(marker.getId()); TextView tvTitle = view.findViewById(R.id.info_window_title); TextView tvCategory = view.findViewById(R.id.info_window_category); TextView tvRating = view.findViewById(R.id.info_window_rating); TextView tvOpen = view.findViewById(R.id.info_window_open); ImageView ivImage = view.findViewById(R.id.info_window_image); // Optional image if (place != null) { tvTitle.setText(place.getName() != null ? place.getName() : "N/A"); tvCategory.setText(place.getCategory() != null ? "Category: " + place.getCategory() : "Category: N/A"); if (place.getRating() > 0) { tvRating.setText(String.format(Locale.getDefault(), "Rating: %.1f ", place.getRating())); tvRating.setVisibility(View.VISIBLE); } else if (place.getName() != null && place.getName().equals(marker.getTitle()) && place.getCategory() == null){ // For stub manual home marker tvRating.setVisibility(View.GONE); } else { tvRating.setText("Rating: N/A"); tvRating.setVisibility(View.VISIBLE); } tvOpen.setText(place.getOpen() != null ? "Open: " + place.getOpen() : "Open: N/A"); // Load image with Glide if URL exists if (place.getImage_url() != null && !place.getImage_url().isEmpty()) { Glide.with(mContext.getApplicationContext()) // Use application context for Glide in adapter .load(place.getImage_url()) .placeholder(R.drawable.img_placeholder) .error(R.drawable.img_error) .into(ivImage); ivImage.setVisibility(View.VISIBLE); } else { ivImage.setVisibility(View.GONE); // Or set a default placeholder } } else { // Fallback if place data is somehow missing for this marker ID tvTitle.setText(marker.getTitle() != null ? marker.getTitle() : "Unknown Location"); tvCategory.setText("Details not available"); tvRating.setVisibility(View.GONE); tvOpen.setVisibility(View.GONE); ivImage.setVisibility(View.GONE); } } @Nullable @Override public View getInfoWindow(@NonNull Marker marker) { renderWindowText(marker, mWindow); return mWindow; } @Nullable @Override public View getInfoContents(@NonNull Marker marker) { renderWindowText(marker, mWindow); return mWindow; // Using getInfoWindow for full custom layout } }
```

# app\src\main\java\com\example\alayaapp\CustomizeItineraryBottomSheet.java

```java
package com.example.alayaapp; import android.content.Context; import android.os.Bundle; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.ArrayAdapter; import android.widget.AutoCompleteTextView; import android.widget.Button; import android.widget.LinearLayout; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import com.google.android.material.bottomsheet.BottomSheetDialogFragment; import com.google.android.material.slider.Slider; import com.google.android.material.textfield.TextInputLayout; import java.util.ArrayList; import java.util.Arrays; import java.util.List; import java.util.Locale; public class CustomizeItineraryBottomSheet extends BottomSheetDialogFragment { public static final String TAG = "CustomizeItineraryBottomSheet"; // Interface to send data back to the activity public interface CustomizeListener { void onCustomizeApplied(List<String> categoryPreferences); } private CustomizeListener listener; private Slider stopsSlider; private TextView stopCountTextView; private LinearLayout spinnersContainer; private Button applyButton; // Pre-defined categories for the dropdowns private final List<String> categories = new ArrayList<>(Arrays.asList( "Any", "Tourist Spot", "Food", "Shopping", "Park", "Museum", "Cafe" )); public static CustomizeItineraryBottomSheet newInstance() { return new CustomizeItineraryBottomSheet(); } @Override public void onAttach(@NonNull Context context) { super.onAttach(context); try { listener = (CustomizeListener) context; } catch (ClassCastException e) { throw new ClassCastException(context.toString() + " must implement CustomizeListener"); } } @Nullable @Override public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) { View view = inflater.inflate(R.layout.dialog_customize_itinerary, container, false); stopsSlider = view.findViewById(R.id.slider_stops); stopCountTextView = view.findViewById(R.id.tv_stop_count); spinnersContainer = view.findViewById(R.id.container_category_spinners); applyButton = view.findViewById(R.id.btn_apply_and_generate); setupSlider(); setupApplyButton(); // Initial setup updateStopCountText(Math.round(stopsSlider.getValue())); updateSpinners(Math.round(stopsSlider.getValue())); return view; } private void setupSlider() { stopsSlider.addOnChangeListener((slider, value, fromUser) -> { int numStops = Math.round(value); updateStopCountText(numStops); updateSpinners(numStops); }); } private void updateStopCountText(int count) { stopCountTextView.setText(String.format(Locale.getDefault(), "%d Stops", count)); } private void updateSpinners(int count) { spinnersContainer.removeAllViews(); // Clear existing spinners LayoutInflater inflater = LayoutInflater.from(getContext()); ArrayAdapter<String> adapter = new ArrayAdapter<>(getContext(), android.R.layout.simple_dropdown_item_1line, categories); for (int i = 1; i <= count; i++) { // Inflate the reusable row layout TextInputLayout textInputLayout = (TextInputLayout) inflater.inflate(R.layout.item_customize_spinner_row, spinnersContainer, false); AutoCompleteTextView autoCompleteTextView = textInputLayout.findViewById(R.id.actv_category_spinner); textInputLayout.setHint("Stop " + i); autoCompleteTextView.setAdapter(adapter); autoCompleteTextView.setText(categories.get(0), false); // Default to "Any" spinnersContainer.addView(textInputLayout); } } private void setupApplyButton() { applyButton.setOnClickListener(v -> { List<String> preferences = new ArrayList<>(); for (int i = 0; i < spinnersContainer.getChildCount(); i++) { View child = spinnersContainer.getChildAt(i); if (child instanceof TextInputLayout) { AutoCompleteTextView actv = ((TextInputLayout) child).findViewById(R.id.actv_category_spinner); preferences.add(actv.getText().toString()); } } listener.onCustomizeApplied(preferences); dismiss(); }); } }
```

# app\src\main\java\com\example\alayaapp\HomeActivity.java

```java
package com.example.alayaapp; import android.Manifest; import android.app.DatePickerDialog; import android.app.TimePickerDialog; import android.content.Intent; import android.content.SharedPreferences; import android.content.pm.PackageManager; import android.location.Address; import android.location.Geocoder; import android.location.Location; import android.os.Bundle; import android.os.Looper; import android.util.Log; import android.view.View; import android.widget.Toast; import androidx.activity.result.ActivityResultLauncher; import androidx.activity.result.contract.ActivityResultContracts; import androidx.annotation.NonNull; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import androidx.core.app.ActivityCompat; import androidx.core.content.ContextCompat; import androidx.recyclerview.widget.LinearLayoutManager; import com.example.alayaapp.databinding.ActivityHomeBinding; import com.google.android.gms.location.FusedLocationProviderClient; import com.google.android.gms.location.LocationCallback; import com.google.android.gms.location.LocationRequest; import com.google.android.gms.location.LocationResult; import com.google.android.gms.location.LocationServices; import com.google.android.gms.location.Priority; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.QueryDocumentSnapshot; import com.google.firebase.firestore.GeoPoint; import java.io.IOException; import java.text.SimpleDateFormat; import java.util.ArrayList; import java.util.Calendar; import java.util.Collections; import java.util.Comparator; import java.util.List; import java.util.Locale; public class HomeActivity extends AppCompatActivity { private ActivityHomeBinding binding; final int CURRENT_ITEM_ID = R.id.navigation_home; private static final int REQUEST_LOCATION_PERMISSION = 1; private static final String TAG = "HomeActivity"; public static final String EXTRA_SHOW_OUTSIDE_REGION_DIALOG = "SHOW_OUTSIDE_REGION_DIALOG"; private FusedLocationProviderClient fusedLocationClient; private LocationCallback locationCallback; private boolean requestingLocationUpdates = false; private SharedPreferences sharedPreferences; private static final String PREFS_NAME = "AlayaAppPrefs"; private static final String KEY_LOCATION_MODE = "location_mode"; private static final String KEY_MANUAL_LOCATION_NAME = "manual_location_name"; private static final String KEY_MANUAL_LATITUDE = "manual_latitude"; private static final String KEY_MANUAL_LONGITUDE = "manual_longitude"; private static final String KEY_TRIP_DATE_YEAR = "trip_date_year"; private static final String KEY_TRIP_DATE_MONTH = "trip_date_month"; private static final String KEY_TRIP_DATE_DAY = "trip_date_day"; private static final String KEY_TRIP_TIME_HOUR = "trip_time_hour"; private static final String KEY_TRIP_TIME_MINUTE = "trip_time_minute"; private static final String KEY_TRIP_END_TIME_HOUR = "trip_end_time_hour"; private static final String KEY_TRIP_END_TIME_MINUTE = "trip_end_time_minute"; private String currentLocationNameToDisplay = "Tap to get current location"; private GeoPoint currentUserGeoPoint = null; // Single source of truth for location private PlaceAdapter placeAdapter; private List<Place> placesList; private FirebaseFirestore db; private Calendar tripDateCalendar; private Calendar tripEndCalendar; private static final double BAGUIO_REGION_MIN_LAT = 16.35; private static final double BAGUIO_REGION_MAX_LAT = 16.50; private static final double BAGUIO_REGION_MIN_LON = 120.55; private static final double BAGUIO_REGION_MAX_LON = 120.65; private static final double NEARBY_RADIUS_KM = 10.0; // Filter radius private boolean wasRedirectedForDialog = false; // THE FIX: Add a member variable to hold the dialog instance private AlertDialog outsideRegionDialog; private final ActivityResultLauncher<Intent> manualLocationPickerLauncher = registerForActivityResult( new ActivityResultContracts.StartActivityForResult(), result -> { if (result.getResultCode() == RESULT_OK && result.getData() != null) { Intent data = result.getData(); String locationName = data.getStringExtra("selected_location_name"); double latitude = data.getDoubleExtra("selected_latitude", 0.0); double longitude = data.getDoubleExtra("selected_longitude", 0.0); // THE FIX: If the newly selected location is valid, dismiss any lingering dialog. if (isLocationInAllowedRegion(latitude, longitude)) { dismissOutsideRegionDialog(); } if (locationName != null && !locationName.isEmpty()) { currentLocationNameToDisplay = locationName; currentUserGeoPoint = new GeoPoint(latitude, longitude); binding.tvLocationCity2.setText(currentLocationNameToDisplay); if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Manually set: " + currentLocationNameToDisplay); } saveLocationPreference("manual", locationName, latitude, longitude); stopLocationUpdates(); fetchAndFilterPlaces(currentUserGeoPoint); } } }); @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityHomeBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); if (savedInstanceState == null && getIntent().getBooleanExtra(EXTRA_SHOW_OUTSIDE_REGION_DIALOG, false)) { wasRedirectedForDialog = true; } sharedPreferences = getSharedPreferences(PREFS_NAME, MODE_PRIVATE); fusedLocationClient = LocationServices.getFusedLocationProviderClient(this); setupLocationCallback(); db = FirebaseFirestore.getInstance(); placesList = new ArrayList<>(); binding.rvPlacesList.setLayoutManager(new LinearLayoutManager(this)); placeAdapter = new PlaceAdapter(this, placesList); binding.rvPlacesList.setAdapter(placeAdapter); tripDateCalendar = Calendar.getInstance(); tripEndCalendar = Calendar.getInstance(); setupDateTimePickers(); loadSavedTripDateTime(); binding.bottomNavigation.setSelectedItemId(CURRENT_ITEM_ID); binding.ibEditLocation.setOnClickListener(v -> showLocationChoiceDialog()); binding.bottomNavigation.setOnItemSelectedListener(item -> { int itemId = item.getItemId(); if (itemId == CURRENT_ITEM_ID) { return true; } if (itemId == R.id.navigation_itineraries || itemId == R.id.navigation_map) { if (currentUserGeoPoint != null && !isLocationInAllowedRegion(currentUserGeoPoint.getLatitude(), currentUserGeoPoint.getLongitude())) { // This now correctly shows the dialog if the user tries to navigate // while in an invalid state, without causing duplication. showOutsideRegionDialog(); return false; } } Intent intent = null; if (itemId == R.id.navigation_itineraries) { intent = new Intent(getApplicationContext(), ItinerariesActivity.class); } else if (itemId == R.id.navigation_map) { intent = new Intent(getApplicationContext(), MapsActivity.class); } else if (itemId == R.id.navigation_profile) { intent = new Intent(getApplicationContext(), ProfileActivity.class); } if (intent != null) { startActivity(intent); overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); finish(); return true; } return false; }); loadLocationPreferenceAndInitialize(); } @Override protected void onResume() { super.onResume(); if (binding.bottomNavigation != null) { binding.bottomNavigation.setSelectedItemId(CURRENT_ITEM_ID); } if (wasRedirectedForDialog) { showOutsideRegionDialog(); wasRedirectedForDialog = false; } String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("auto")) { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED) { startLocationUpdates(); } } else { stopLocationUpdates(); String name = sharedPreferences.getString(KEY_MANUAL_LOCATION_NAME, "Not Set"); binding.tvLocationCity2.setText(name); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Manually set: " + name); } loadSavedTripDateTime(); } // THE FIX: New method to safely dismiss the dialog private void dismissOutsideRegionDialog() { if (outsideRegionDialog != null && outsideRegionDialog.isShowing()) { outsideRegionDialog.dismiss(); outsideRegionDialog = null; } } // THE FIX: Modified method to create and show the dialog, preventing duplicates. private void showOutsideRegionDialog() { // If a dialog is already showing, don't create another one. if (outsideRegionDialog != null && outsideRegionDialog.isShowing()) { return; } AlertDialog.Builder builder = new AlertDialog.Builder(this) .setTitle("Outside Baguio Region") .setMessage("Your current location is outside the supported region. Please set a location within Baguio to get recommendations.") .setPositiveButton("Set Manually", (dialog, which) -> { Intent intent = new Intent(HomeActivity.this, ManualLocationPickerActivity.class); manualLocationPickerLauncher.launch(intent); }) .setNegativeButton("Cancel", (dialog, which) -> dialog.dismiss()) .setOnDismissListener(dialog -> outsideRegionDialog = null); // Clear reference on dismiss outsideRegionDialog = builder.create(); outsideRegionDialog.show(); } private void getAddressFromLocation(double latitude, double longitude) { currentUserGeoPoint = new GeoPoint(latitude, longitude); if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) return; if (!isLocationInAllowedRegion(latitude, longitude)) { stopLocationUpdates(); binding.tvLocationCity2.setText("Outside supported region"); binding.tvDirectionText.setText("Please set a location in Baguio."); showOutsideRegionDialog(); fetchAndFilterPlaces(null); return; } // THE FIX: If we reach here, the location is valid. Dismiss any dialog. dismissOutsideRegionDialog(); // Fetch places for the current valid GPS location fetchAndFilterPlaces(new GeoPoint(latitude, longitude)); Geocoder geocoder = new Geocoder(this, Locale.getDefault()); try { List<Address> addresses = geocoder.getFromLocation(latitude, longitude, 1); if (addresses != null && !addresses.isEmpty()) { Address address = addresses.get(0); String city = address.getLocality(); String subLocality = address.getSubLocality(); String thoroughfare = address.getThoroughfare(); String country = address.getCountryName(); StringBuilder addressTextBuilder = new StringBuilder(); if (city != null && !city.isEmpty()) addressTextBuilder.append(city); else if (subLocality != null && !subLocality.isEmpty()) addressTextBuilder.append(subLocality); else if (thoroughfare != null && !thoroughfare.isEmpty()) addressTextBuilder.append(thoroughfare); else addressTextBuilder.append("Unknown Area"); if (country != null && !country.isEmpty() && addressTextBuilder.length() > 0 && !addressTextBuilder.toString().equals("Unknown Area")) { if (!addressTextBuilder.toString().equalsIgnoreCase(country) && (city == null || !city.equalsIgnoreCase(country))) { addressTextBuilder.append(", ").append(country); } } else if (country != null && !country.isEmpty() && addressTextBuilder.toString().equals("Unknown Area")) { addressTextBuilder.replace(0, addressTextBuilder.length(), country); } currentLocationNameToDisplay = addressTextBuilder.length() == 0 ? "Location Name Not Found" : addressTextBuilder.toString(); binding.tvLocationCity2.setText(currentLocationNameToDisplay); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("GPS: " + currentLocationNameToDisplay); } else { binding.tvLocationCity2.setText("Location Name Not Found (Auto)"); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("GPS: Location Name Not Found"); } } catch (IOException e) { Log.e(TAG, "Geocoder service not available or IO error (Auto)", e); binding.tvLocationCity2.setText("Service to get address unavailable (Auto)"); } catch (IllegalArgumentException e) { Log.e(TAG, "Invalid latitude or longitude values (Auto).", e); binding.tvLocationCity2.setText("Invalid location data (Auto)"); } } // --- All other methods (setupDateTimePickers, calculateDistance, fetchAndFilterPlaces, etc.) remain unchanged --- // --- They are included here for completeness. --- private void setupDateTimePickers() { binding.rlTripDate.setOnClickListener(v -> { DatePickerDialog.OnDateSetListener dateSetListener = (view, year, monthOfYear, dayOfMonth) -> { tripDateCalendar.set(Calendar.YEAR, year); tripDateCalendar.set(Calendar.MONTH, monthOfYear); tripDateCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth); tripEndCalendar.set(Calendar.YEAR, year); tripEndCalendar.set(Calendar.MONTH, monthOfYear); tripEndCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth); saveTripDate(year, monthOfYear, dayOfMonth); updateDateTimeUI(); }; new DatePickerDialog(HomeActivity.this, dateSetListener, tripDateCalendar.get(Calendar.YEAR), tripDateCalendar.get(Calendar.MONTH), tripDateCalendar.get(Calendar.DAY_OF_MONTH)) .show(); }); binding.rlTripTime.setOnClickListener(v -> showStartTimePickerDialog()); } private void showStartTimePickerDialog() { TimePickerDialog.OnTimeSetListener timeSetListener = (view, hourOfDay, minute) -> { tripDateCalendar.set(Calendar.HOUR_OF_DAY, hourOfDay); tripDateCalendar.set(Calendar.MINUTE, minute); saveTripTime(hourOfDay, minute); updateDateTimeUI(); showEndTimePickerDialog(); }; TimePickerDialog timePickerDialog = new TimePickerDialog(this, timeSetListener, tripDateCalendar.get(Calendar.HOUR_OF_DAY), tripDateCalendar.get(Calendar.MINUTE), false); timePickerDialog.setTitle("Select Start Time"); timePickerDialog.show(); } private void showEndTimePickerDialog() { TimePickerDialog.OnTimeSetListener timeSetListener = (view, hourOfDay, minute) -> { Calendar tempEndCal = (Calendar) tripEndCalendar.clone(); tempEndCal.set(Calendar.HOUR_OF_DAY, hourOfDay); tempEndCal.set(Calendar.MINUTE, minute); if (tempEndCal.before(tripDateCalendar)) { Toast.makeText(this, "End time must be after start time.", Toast.LENGTH_LONG).show(); return; } tripEndCalendar.setTime(tempEndCal.getTime()); saveTripEndTime(hourOfDay, minute); updateDateTimeUI(); }; TimePickerDialog timePickerDialog = new TimePickerDialog(this, timeSetListener, tripEndCalendar.get(Calendar.HOUR_OF_DAY), tripEndCalendar.get(Calendar.MINUTE), false); timePickerDialog.setTitle("Select End Time"); timePickerDialog.show(); } private void loadSavedTripDateTime() { if (sharedPreferences.contains(KEY_TRIP_DATE_YEAR)) { int year = sharedPreferences.getInt(KEY_TRIP_DATE_YEAR, tripDateCalendar.get(Calendar.YEAR)); int month = sharedPreferences.getInt(KEY_TRIP_DATE_MONTH, tripDateCalendar.get(Calendar.MONTH)); int day = sharedPreferences.getInt(KEY_TRIP_DATE_DAY, tripDateCalendar.get(Calendar.DAY_OF_MONTH)); tripDateCalendar.set(year, month, day); tripEndCalendar.set(year, month, day); } if (sharedPreferences.contains(KEY_TRIP_TIME_HOUR)) { int hour = sharedPreferences.getInt(KEY_TRIP_TIME_HOUR, 9); int minute = sharedPreferences.getInt(KEY_TRIP_TIME_MINUTE, 0); tripDateCalendar.set(Calendar.HOUR_OF_DAY, hour); tripDateCalendar.set(Calendar.MINUTE, minute); } if (sharedPreferences.contains(KEY_TRIP_END_TIME_HOUR)) { int hour = sharedPreferences.getInt(KEY_TRIP_END_TIME_HOUR, 18); int minute = sharedPreferences.getInt(KEY_TRIP_END_TIME_MINUTE, 0); tripEndCalendar.set(Calendar.HOUR_OF_DAY, hour); tripEndCalendar.set(Calendar.MINUTE, minute); } updateDateTimeUI(); } private void updateDateTimeUI() { SimpleDateFormat dateFormat = new SimpleDateFormat("EEE, MMM dd, yyyy", Locale.getDefault()); SimpleDateFormat timeFormat = new SimpleDateFormat("h:mm a", Locale.getDefault()); if (sharedPreferences.contains(KEY_TRIP_DATE_YEAR)) { binding.tvTripDate.setText(dateFormat.format(tripDateCalendar.getTime())); } else { binding.tvTripDate.setText("Set Trip Date"); } boolean hasStartTime = sharedPreferences.contains(KEY_TRIP_TIME_HOUR); boolean hasEndTime = sharedPreferences.contains(KEY_TRIP_END_TIME_HOUR); if (hasStartTime && hasEndTime) { String timeRange = timeFormat.format(tripDateCalendar.getTime()) + " - " + timeFormat.format(tripEndCalendar.getTime()); binding.tvTripTime.setText(timeRange); } else { binding.tvTripTime.setText("Set Start & End Time"); } } private void saveTripDate(int year, int month, int day) { SharedPreferences.Editor editor = sharedPreferences.edit(); editor.putInt(KEY_TRIP_DATE_YEAR, year); editor.putInt(KEY_TRIP_DATE_MONTH, month); editor.putInt(KEY_TRIP_DATE_DAY, day); editor.apply(); } private void saveTripTime(int hour, int minute) { SharedPreferences.Editor editor = sharedPreferences.edit(); editor.putInt(KEY_TRIP_TIME_HOUR, hour); editor.putInt(KEY_TRIP_TIME_MINUTE, minute); editor.apply(); } private void saveTripEndTime(int hour, int minute) { SharedPreferences.Editor editor = sharedPreferences.edit(); editor.putInt(KEY_TRIP_END_TIME_HOUR, hour); editor.putInt(KEY_TRIP_END_TIME_MINUTE, minute); editor.apply(); } private boolean isLocationInAllowedRegion(double latitude, double longitude) { return latitude >= BAGUIO_REGION_MIN_LAT && latitude <= BAGUIO_REGION_MAX_LAT && longitude >= BAGUIO_REGION_MIN_LON && longitude <= BAGUIO_REGION_MAX_LON; } private double calculateDistance(GeoPoint start, GeoPoint end) { if (start == null || end == null) return Double.MAX_VALUE; final int R = 6371; // Radius of the earth in km double latDistance = Math.toRadians(end.getLatitude() - start.getLatitude()); double lonDistance = Math.toRadians(end.getLongitude() - start.getLongitude()); double a = Math.sin(latDistance / 2) * Math.sin(latDistance / 2) + Math.cos(Math.toRadians(start.getLatitude())) * Math.cos(Math.toRadians(end.getLatitude())) * Math.sin(lonDistance / 2) * Math.sin(lonDistance / 2); double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return R * c; } private void fetchAndFilterPlaces(GeoPoint userLocation) { if (userLocation == null) { placesList.clear(); placeAdapter.notifyDataSetChanged(); binding.rvPlacesList.setVisibility(View.GONE); binding.progressBarHome.setVisibility(View.GONE); binding.tvEmptyPlaces.setText("Set your location to find nearby spots."); binding.tvEmptyPlaces.setVisibility(View.VISIBLE); return; } Log.d(TAG, "Fetching and filtering places based on location: " + userLocation.toString()); binding.progressBarHome.setVisibility(View.VISIBLE); binding.rvPlacesList.setVisibility(View.GONE); binding.tvEmptyPlaces.setVisibility(View.GONE); db.collection("places") .get() .addOnCompleteListener(task -> { binding.progressBarHome.setVisibility(View.GONE); if (task.isSuccessful() && task.getResult() != null) { List<Place> nearbyPlaces = new ArrayList<>(); for (QueryDocumentSnapshot document : task.getResult()) { try { Place place = document.toObject(Place.class); if (place != null && place.getCoordinates() != null) { place.setDocumentId(document.getId()); double distance = calculateDistance(userLocation, place.getCoordinates()); if (distance <= NEARBY_RADIUS_KM) { place.setDistance(distance); place.setDistance_text(String.format(Locale.getDefault(), "%.1f km", distance)); nearbyPlaces.add(place); } } } catch (Exception e) { Log.e(TAG, "Error converting document: " + document.getId(), e); } } Collections.sort(nearbyPlaces, Comparator.comparingDouble(Place::getDistance)); placesList.clear(); placesList.addAll(nearbyPlaces); if (!placesList.isEmpty()) { placeAdapter.notifyDataSetChanged(); binding.rvPlacesList.setVisibility(View.VISIBLE); binding.tvEmptyPlaces.setVisibility(View.GONE); } else { binding.rvPlacesList.setVisibility(View.GONE); binding.tvEmptyPlaces.setText(String.format(Locale.getDefault(), "No spots found within %.0fkm.", NEARBY_RADIUS_KM)); binding.tvEmptyPlaces.setVisibility(View.VISIBLE); } } else { Log.w(TAG, "Error getting documents from Firestore.", task.getException()); binding.rvPlacesList.setVisibility(View.GONE); binding.tvEmptyPlaces.setText("Failed to load places. Please check connection."); binding.tvEmptyPlaces.setVisibility(View.VISIBLE); Toast.makeText(HomeActivity.this, "Failed to load places.", Toast.LENGTH_LONG).show(); } }); } private void setupLocationCallback() { locationCallback = new LocationCallback() { @Override public void onLocationResult(@NonNull LocationResult locationResult) { if (locationResult == null) return; if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) return; for (Location location : locationResult.getLocations()) { if (location != null) { getAddressFromLocation(location.getLatitude(), location.getLongitude()); stopLocationUpdates(); break; } } } }; } private void showLocationChoiceDialog() { final CharSequence[] options = {"Use My Current GPS Location", "Set Location Manually", "Cancel"}; AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle("Choose Location Method"); builder.setItems(options, (dialog, item) -> { if (options[item].equals("Use My Current GPS Location")) { saveLocationPreference("auto", null, 0, 0); currentUserGeoPoint = null; binding.tvLocationCity2.setText("Fetching GPS location..."); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Mode: GPS"); checkAndRequestLocationPermissions(); } else if (options[item].equals("Set Location Manually")) { Intent intent = new Intent(HomeActivity.this, ManualLocationPickerActivity.class); if (currentUserGeoPoint != null) { intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_LAT, currentUserGeoPoint.getLatitude()); intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_LON, currentUserGeoPoint.getLongitude()); intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_NAME, currentLocationNameToDisplay); } manualLocationPickerLauncher.launch(intent); } else if (options[item].equals("Cancel")) { dialog.dismiss(); } }); builder.show(); } private void loadLocationPreferenceAndInitialize() { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("manual")) { String name = sharedPreferences.getString(KEY_MANUAL_LOCATION_NAME, ""); double lat = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LATITUDE, Double.doubleToRawLongBits(0.0))); double lon = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LONGITUDE, Double.doubleToRawLongBits(0.0))); if (!name.isEmpty() && lat != 0.0 && lon != 0.0) { currentLocationNameToDisplay = name; currentUserGeoPoint = new GeoPoint(lat, lon); binding.tvLocationCity2.setText(currentLocationNameToDisplay); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Manually set: " + currentLocationNameToDisplay); stopLocationUpdates(); fetchAndFilterPlaces(currentUserGeoPoint); } else { saveLocationPreference("auto", null, 0, 0); checkAndRequestLocationPermissions(); } } else { binding.tvLocationCity2.setText("Tap to get current location"); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Mode: GPS. Waiting for location..."); checkAndRequestLocationPermissions(); } } private void saveLocationPreference(String mode, String name, double lat, double lon) { SharedPreferences.Editor editor = sharedPreferences.edit(); editor.putString(KEY_LOCATION_MODE, mode); if (mode.equals("manual") && name != null) { editor.putString(KEY_MANUAL_LOCATION_NAME, name); editor.putLong(KEY_MANUAL_LATITUDE, Double.doubleToRawLongBits(lat)); editor.putLong(KEY_MANUAL_LONGITUDE, Double.doubleToRawLongBits(lon)); } else { editor.remove(KEY_MANUAL_LOCATION_NAME); editor.remove(KEY_MANUAL_LATITUDE); editor.remove(KEY_MANUAL_LONGITUDE); } editor.apply(); } @Override protected void onPause() { super.onPause(); stopLocationUpdates(); dismissOutsideRegionDialog(); // Dismiss dialog when activity is paused } private void checkAndRequestLocationPermissions() { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) { if (ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.ACCESS_FINE_LOCATION)) { new AlertDialog.Builder(this) .setTitle("Location Permission Needed") .setMessage("This app needs the Location permission to show your current location. Please allow.") .setPositiveButton("OK", (dialogInterface, i) -> ActivityCompat.requestPermissions(HomeActivity.this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION}, REQUEST_LOCATION_PERMISSION)) .setNegativeButton("Cancel", (dialog, which) -> { binding.tvLocationCity2.setText("Permission needed"); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Location permission denied."); fetchAndFilterPlaces(null); }) .create() .show(); } else { ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION}, REQUEST_LOCATION_PERMISSION); } } else { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("auto")) { fetchLastLocation(); startLocationUpdates(); } else { stopLocationUpdates(); } } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); if (requestCode == REQUEST_LOCATION_PERMISSION) { if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("auto")) { fetchLastLocation(); startLocationUpdates(); } } else { binding.tvLocationCity2.setText("Location permission denied"); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Location permission denied."); Toast.makeText(this, "Location permission denied.", Toast.LENGTH_LONG).show(); fetchAndFilterPlaces(null); } } } private void fetchLastLocation() { if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) { return; } if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) return; if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Fetching last known location..."); fusedLocationClient.getLastLocation() .addOnSuccessListener(this, location -> { if (location != null) { getAddressFromLocation(location.getLatitude(), location.getLongitude()); } else { Log.d(TAG, "Last known location is null. Waiting for updates."); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Last location null, waiting for live updates..."); } }) .addOnFailureListener(this, e -> { Log.e(TAG, "Error trying to get last GPS location", e); binding.tvLocationCity2.setText("Failed to get location"); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Failed to get last location."); }); } private void startLocationUpdates() { if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) { return; } if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) { stopLocationUpdates(); return; } if (requestingLocationUpdates) return; LocationRequest locationRequest = new LocationRequest.Builder(Priority.PRIORITY_HIGH_ACCURACY, 10000) .setMinUpdateIntervalMillis(5000) .build(); requestingLocationUpdates = true; fusedLocationClient.requestLocationUpdates(locationRequest, locationCallback, Looper.getMainLooper()); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Updating location (GPS)..."); } private void stopLocationUpdates() { if (requestingLocationUpdates) { fusedLocationClient.removeLocationUpdates(locationCallback); requestingLocationUpdates = false; } } }
```

# app\src\main\java\com\example\alayaapp\ItinerariesActivity.java

```java
package com.example.alayaapp; import androidx.activity.result.ActivityResultLauncher; import androidx.activity.result.contract.ActivityResultContracts; import androidx.annotation.NonNull; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import androidx.core.app.ActivityCompat; import androidx.core.content.ContextCompat; import androidx.lifecycle.ViewModelProvider; import androidx.recyclerview.widget.LinearLayoutManager; import androidx.recyclerview.widget.RecyclerView; import android.Manifest; import android.content.Intent; import android.content.SharedPreferences; import android.content.pm.PackageManager; import android.location.Address; import android.location.Geocoder; import android.location.Location; import android.os.Bundle; import android.os.Looper; import android.util.Log; import android.view.View; import android.widget.Button; import android.widget.ProgressBar; import android.widget.Toast; import com.google.android.gms.location.FusedLocationProviderClient; import com.google.android.gms.location.LocationCallback; import com.google.android.gms.location.LocationRequest; import com.google.android.gms.location.LocationResult; import com.google.android.gms.location.LocationServices; import com.google.android.gms.location.Priority; import com.google.android.material.bottomnavigation.BottomNavigationView; import com.google.android.material.floatingactionbutton.FloatingActionButton; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.GeoPoint; import com.google.firebase.firestore.QueryDocumentSnapshot; import java.io.IOException; import java.util.ArrayList; import java.util.Calendar; import java.util.Collections; import java.util.List; import java.util.Locale; public class ItinerariesActivity extends AppCompatActivity implements ItineraryAdapter.ItineraryHeaderListener, CustomizeItineraryBottomSheet.CustomizeListener { BottomNavigationView bottomNavigationView; RecyclerView rvMain; ItineraryAdapter itineraryAdapter; FloatingActionButton fabSaveTrip; ProgressBar pbItineraries; final int CURRENT_ITEM_ID = R.id.navigation_itineraries; private static final String TAG_LOCATION = "ItinerariesActivity"; private static final int REQUEST_LOCATION_PERMISSION_ITINERARIES = 2; private FusedLocationProviderClient fusedLocationClient; private LocationCallback locationCallback; private boolean requestingLocationUpdates = false; private SharedPreferences sharedPreferences; private static final String PREFS_NAME = "AlayaAppPrefs"; private static final String KEY_LOCATION_MODE = "location_mode"; private static final String KEY_MANUAL_LOCATION_NAME = "manual_location_name"; private static final String KEY_MANUAL_LATITUDE = "manual_latitude"; private static final String KEY_MANUAL_LONGITUDE = "manual_longitude"; private GeoPoint currentGeoPoint = null; private FirebaseFirestore db; private List<Place> allPlacesList = new ArrayList<>(); private static final String KEY_TRIP_DATE_YEAR = "trip_date_year"; private static final String KEY_TRIP_DATE_MONTH = "trip_date_month"; private static final String KEY_TRIP_DATE_DAY = "trip_date_day"; private static final String KEY_TRIP_TIME_HOUR = "trip_time_hour"; private static final String KEY_TRIP_TIME_MINUTE = "trip_time_minute"; private static final String KEY_TRIP_END_TIME_HOUR = "trip_end_time_hour"; private static final String KEY_TRIP_END_TIME_MINUTE = "trip_end_time_minute"; private Calendar tripStartCalendar; private Calendar tripEndCalendar; private static final double BAGUIO_REGION_MIN_LAT = 16.35; private static final double BAGUIO_REGION_MAX_LAT = 16.50; private static final double BAGUIO_REGION_MIN_LON = 120.55; private static final double BAGUIO_REGION_MAX_LON = 120.65; private List<Object> displayItems = new ArrayList<>(); public ItineraryViewModel itineraryViewModel; private final ActivityResultLauncher<Intent> manualLocationPickerLauncher = registerForActivityResult( new ActivityResultContracts.StartActivityForResult(), result -> { if (result.getResultCode() == RESULT_OK && result.getData() != null) { Intent data = result.getData(); String locationName = data.getStringExtra("selected_location_name"); double latitude = data.getDoubleExtra("selected_latitude", 0.0); double longitude = data.getDoubleExtra("selected_longitude", 0.0); if (locationName != null && !locationName.isEmpty()) { currentGeoPoint = new GeoPoint(latitude, longitude); itineraryViewModel.updateLocationStatus(locationName, "Manually set: " + locationName); saveLocationPreference("manual", locationName, latitude, longitude); stopLocationUpdates(); itineraryViewModel.clearItinerary(); Toast.makeText(this, "Location set. Click 'New Plan' or 'Customize' to generate.", Toast.LENGTH_LONG).show(); } } }); @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_itineraries); rvMain = findViewById(R.id.rv_itineraries_main); bottomNavigationView = findViewById(R.id.bottom_navigation); fabSaveTrip = findViewById(R.id.fab_save_trip); pbItineraries = findViewById(R.id.pb_itineraries); itineraryViewModel = new ViewModelProvider(this).get(ItineraryViewModel.class); db = FirebaseFirestore.getInstance(); tripStartCalendar = Calendar.getInstance(); tripEndCalendar = Calendar.getInstance(); sharedPreferences = getSharedPreferences(PREFS_NAME, MODE_PRIVATE); fusedLocationClient = LocationServices.getFusedLocationProviderClient(this); setupRecyclerView(); setupViewModelObservers(); setupBottomNavListener(); setupActionListeners(); setupLocationCallback(); if (savedInstanceState == null) { itineraryViewModel.initializeState(); } loadAndDisplayLocationHeader(); } private void setupRecyclerView() { itineraryAdapter = new ItineraryAdapter(this, displayItems, this); rvMain.setLayoutManager(new LinearLayoutManager(this)); rvMain.setAdapter(itineraryAdapter); } private void setupViewModelObservers() { itineraryViewModel.itineraryState.observe(this, state -> { displayItems.clear(); String headerMessage; if (state == null) { headerMessage = "Your itinerary is empty. Use the buttons below to create a plan!"; } else { headerMessage = state.getHeaderMessage(); } displayItems.add(new ItineraryAdapter.LocationHeaderData(headerMessage)); boolean hasContent = false; if (state != null) { if (state.getItineraryItems() != null && !state.getItineraryItems().isEmpty()) { displayItems.add("Suggested Itinerary"); displayItems.addAll(state.getItineraryItems()); hasContent = true; } if (state.getTopRatedPlaces() != null && !state.getTopRatedPlaces().isEmpty()) { displayItems.add(new ItineraryAdapter.HorizontalListContainer("Top Rated", state.getTopRatedPlaces())); hasContent = true; } if (hasContent) { displayItems.add("Hours are based on standard schedules. We recommend checking ahead for holidays or special events."); } } itineraryAdapter.notifyDataSetChanged(); fabSaveTrip.setVisibility(hasContent ? View.VISIBLE : View.GONE); }); itineraryViewModel.isLoading.observe(this, isLoading -> { pbItineraries.setVisibility(isLoading ? View.VISIBLE : View.GONE); rvMain.setVisibility(isLoading ? View.GONE : View.VISIBLE); }); itineraryViewModel.isItinerarySaved.observe(this, isSaved -> { fabSaveTrip.setImageResource(isSaved ? R.drawable.ic_profile_placeholder : android.R.drawable.ic_menu_save); fabSaveTrip.setEnabled(!isSaved); }); } private void setupActionListeners() { bottomNavigationView.setSelectedItemId(CURRENT_ITEM_ID); fabSaveTrip.setOnClickListener(v -> { loadTripDateTime(); itineraryViewModel.saveCurrentTripToHistory(tripStartCalendar); }); } private void triggerGeneration(boolean forceRegenerate, List<String> categoryPreferences) { if (currentGeoPoint == null) { Toast.makeText(this, "Cannot generate itinerary without a start location.", Toast.LENGTH_LONG).show(); return; } if (!isLocationInAllowedRegion(currentGeoPoint.getLatitude(), currentGeoPoint.getLongitude())) { redirectToHomeWithDialog(); return; } loadTripDateTime(); db.collection("places").get().addOnCompleteListener(task -> { if (task.isSuccessful() && task.getResult() != null) { allPlacesList.clear(); for (QueryDocumentSnapshot document : task.getResult()) { try { Place place = document.toObject(Place.class); if (place != null && place.getCoordinates() != null && place.getOpeningHours() != null) { place.setDocumentId(document.getId()); allPlacesList.add(place); } } catch (Exception e) { Log.e(TAG_LOCATION, "Error converting document to Place object: " + document.getId(), e); } } String locationName = itineraryViewModel.currentLocationName.getValue() != null ? itineraryViewModel.currentLocationName.getValue() : "Selected Location"; itineraryViewModel.loadOrGenerateItinerary(currentGeoPoint, locationName, tripStartCalendar, tripEndCalendar, allPlacesList, forceRegenerate, categoryPreferences); } else { Log.w(TAG_LOCATION, "Error getting documents from Firestore.", task.getException()); Toast.makeText(ItinerariesActivity.this, "Failed to load places for itinerary.", Toast.LENGTH_LONG).show(); } }); } private void loadTripDateTime() { if (sharedPreferences.contains(KEY_TRIP_DATE_YEAR)) { int year = sharedPreferences.getInt(KEY_TRIP_DATE_YEAR, tripStartCalendar.get(Calendar.YEAR)); int month = sharedPreferences.getInt(KEY_TRIP_DATE_MONTH, tripStartCalendar.get(Calendar.MONTH)); int day = sharedPreferences.getInt(KEY_TRIP_DATE_DAY, tripStartCalendar.get(Calendar.DAY_OF_MONTH)); tripStartCalendar.set(year, month, day); tripEndCalendar.set(year, month, day); } int startHour = sharedPreferences.getInt(KEY_TRIP_TIME_HOUR, 9); int startMinute = sharedPreferences.getInt(KEY_TRIP_TIME_MINUTE, 0); tripStartCalendar.set(Calendar.HOUR_OF_DAY, startHour); tripStartCalendar.set(Calendar.MINUTE, startMinute); int endHour = sharedPreferences.getInt(KEY_TRIP_END_TIME_HOUR, 18); int endMinute = sharedPreferences.getInt(KEY_TRIP_END_TIME_MINUTE, 0); tripEndCalendar.set(Calendar.HOUR_OF_DAY, endHour); tripEndCalendar.set(Calendar.MINUTE, endMinute); } public void showLocationChoiceDialog() { final CharSequence[] options = {"Use My Current GPS Location", "Set Location Manually", "Cancel"}; AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle("Choose Start Location"); builder.setItems(options, (dialog, item) -> { if (options[item].equals("Use My Current GPS Location")) { saveLocationPreference("auto", null, 0, 0); currentGeoPoint = null; itineraryViewModel.updateLocationStatus("Fetching GPS location...", "Mode: GPS"); checkAndRequestLocationPermissions(); } else if (options[item].equals("Set Location Manually")) { Intent intent = new Intent(ItinerariesActivity.this, ManualLocationPickerActivity.class); if (currentGeoPoint != null) { intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_LAT, currentGeoPoint.getLatitude()); intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_LON, currentGeoPoint.getLongitude()); intent.putExtra(ManualLocationPickerActivity.EXTRA_INITIAL_NAME, itineraryViewModel.currentLocationName.getValue()); } manualLocationPickerLauncher.launch(intent); } else if (options[item].equals("Cancel")) { dialog.dismiss(); } }); builder.show(); } private void loadAndDisplayLocationHeader() { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("manual")) { String name = sharedPreferences.getString(KEY_MANUAL_LOCATION_NAME, ""); double lat = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LATITUDE, Double.doubleToRawLongBits(0.0))); double lon = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LONGITUDE, Double.doubleToRawLongBits(0.0))); if (!name.isEmpty() && lat != 0.0) { currentGeoPoint = new GeoPoint(lat, lon); itineraryViewModel.updateLocationStatus(name, "Manually set: " + name); stopLocationUpdates(); } else { saveLocationPreference("auto", null, 0,0); checkAndRequestLocationPermissions(); } } else { itineraryViewModel.updateLocationStatus("Tap to get current location", "Mode: GPS. Waiting for location..."); checkAndRequestLocationPermissions(); } } private void getAddressFromLocation(double latitude, double longitude) { if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) return; if (!isLocationInAllowedRegion(latitude, longitude)) { stopLocationUpdates(); redirectToHomeWithDialog(); return; } Geocoder geocoder = new Geocoder(this, Locale.getDefault()); try { List<Address> addresses = geocoder.getFromLocation(latitude, longitude, 1); if (addresses != null && !addresses.isEmpty()) { Address address = addresses.get(0); String city = address.getLocality(); String subLocality = address.getSubLocality(); String thoroughfare = address.getThoroughfare(); StringBuilder addressTextBuilder = new StringBuilder(); if (city != null && !city.isEmpty()) addressTextBuilder.append(city); else if (subLocality != null && !subLocality.isEmpty()) addressTextBuilder.append(subLocality); else if (thoroughfare != null && !thoroughfare.isEmpty()) addressTextBuilder.append(thoroughfare); else addressTextBuilder.append("Unknown Area"); currentGeoPoint = new GeoPoint(latitude, longitude); itineraryViewModel.updateLocationStatus(addressTextBuilder.toString(), "GPS: " + addressTextBuilder.toString()); itineraryViewModel.clearItinerary(); Toast.makeText(this, "Location updated. Click 'New Plan' or 'Customize' to generate.", Toast.LENGTH_LONG).show(); } else { itineraryViewModel.updateLocationStatus("Location Name Not Found (Auto)", "GPS: Location Name Not Found"); } } catch (IOException e) { itineraryViewModel.updateLocationStatus("Service to get address unavailable (Auto)", "Error getting address"); } } private void setupBottomNavListener() { bottomNavigationView.setOnItemSelectedListener(item -> { int destinationItemId = item.getItemId(); if (destinationItemId == CURRENT_ITEM_ID) return true; Class<?> destinationActivityClass = null; if (destinationItemId == R.id.navigation_home) destinationActivityClass = HomeActivity.class; else if (destinationItemId == R.id.navigation_map) destinationActivityClass = MapsActivity.class; else if (destinationItemId == R.id.navigation_profile) destinationActivityClass = ProfileActivity.class; if (destinationActivityClass != null) { Intent intent = new Intent(getApplicationContext(), destinationActivityClass); startActivity(intent); boolean slideRightToLeft = getItemIndex(destinationItemId) > getItemIndex(CURRENT_ITEM_ID); if (slideRightToLeft) overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); else overridePendingTransition(R.anim.slide_in_left, R.anim.slide_out_right); finish(); return true; } return false; }); } private int getItemIndex(int itemId) { if (itemId == R.id.navigation_home) return 0; if (itemId == R.id.navigation_itineraries) return 1; if (itemId == R.id.navigation_map) return 2; if (itemId == R.id.navigation_profile) return 3; return -1; } private void setupLocationCallback() { locationCallback = new LocationCallback() { @Override public void onLocationResult(@NonNull LocationResult locationResult) { if (locationResult == null || !sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) return; for (Location location : locationResult.getLocations()) { if (location != null) { getAddressFromLocation(location.getLatitude(), location.getLongitude()); stopLocationUpdates(); break; } } } }; } private void saveLocationPreference(String mode, String name, double lat, double lon) { SharedPreferences.Editor editor = sharedPreferences.edit(); editor.putString(KEY_LOCATION_MODE, mode); if (mode.equals("manual") && name != null) { editor.putString(KEY_MANUAL_LOCATION_NAME, name); editor.putLong(KEY_MANUAL_LATITUDE, Double.doubleToRawLongBits(lat)); editor.putLong(KEY_MANUAL_LONGITUDE, Double.doubleToRawLongBits(lon)); } else { editor.remove(KEY_MANUAL_LOCATION_NAME); editor.remove(KEY_MANUAL_LATITUDE); editor.remove(KEY_MANUAL_LONGITUDE); } editor.apply(); } private boolean isLocationInAllowedRegion(double latitude, double longitude) { return latitude >= BAGUIO_REGION_MIN_LAT && latitude <= BAGUIO_REGION_MAX_LAT && longitude >= BAGUIO_REGION_MIN_LON && longitude <= BAGUIO_REGION_MAX_LON; } private void redirectToHomeWithDialog() { Intent intent = new Intent(ItinerariesActivity.this, HomeActivity.class); intent.putExtra(HomeActivity.EXTRA_SHOW_OUTSIDE_REGION_DIALOG, true); intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); finish(); } @Override protected void onResume() { super.onResume(); bottomNavigationView.setSelectedItemId(CURRENT_ITEM_ID); loadAndDisplayLocationHeader(); } @Override protected void onPause() { super.onPause(); stopLocationUpdates(); } private void checkAndRequestLocationPermissions() { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) { if (ActivityCompat.shouldShowRequestPermissionRationale(this, Manifest.permission.ACCESS_FINE_LOCATION)) { new AlertDialog.Builder(this) .setTitle("Location Permission Needed") .setMessage("This app needs the Location permission to show your current location for itineraries. Please allow.") .setPositiveButton("OK", (dialogInterface, i) -> ActivityCompat.requestPermissions(ItinerariesActivity.this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION}, REQUEST_LOCATION_PERMISSION_ITINERARIES)) .setNegativeButton("Cancel", (dialog, which) -> itineraryViewModel.updateLocationStatus("Permission needed", "Location permission denied.") ) .create() .show(); } else { ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION}, REQUEST_LOCATION_PERMISSION_ITINERARIES); } } else { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("auto")) { fetchLastLocation(); startLocationUpdates(); } else { stopLocationUpdates(); } } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); if (requestCode == REQUEST_LOCATION_PERMISSION_ITINERARIES) { if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) { String mode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if (mode.equals("auto")) { fetchLastLocation(); startLocationUpdates(); } } else { itineraryViewModel.updateLocationStatus("Permission denied", "Location permission denied."); Toast.makeText(this, "Location permission denied.", Toast.LENGTH_LONG).show(); } } } private void fetchLastLocation() { if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) { return; } if (!"auto".equals(sharedPreferences.getString(KEY_LOCATION_MODE, "auto"))) return; itineraryViewModel.updateLocationStatus(itineraryViewModel.currentLocationName.getValue(), "Fetching last known location..."); fusedLocationClient.getLastLocation() .addOnSuccessListener(this, location -> { if (location != null) { getAddressFromLocation(location.getLatitude(), location.getLongitude()); } else { itineraryViewModel.updateLocationStatus(itineraryViewModel.currentLocationName.getValue(), "Last location null, waiting for live updates..."); } }) .addOnFailureListener(this, e -> { itineraryViewModel.updateLocationStatus("Failed to get location", "Failed to get last location."); }); } private void startLocationUpdates() { if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED && ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) { return; } if (!sharedPreferences.getString(KEY_LOCATION_MODE, "auto").equals("auto")) { stopLocationUpdates(); return; } if (requestingLocationUpdates) { return; } LocationRequest locationRequest = new LocationRequest.Builder(Priority.PRIORITY_HIGH_ACCURACY, 10000) .setMinUpdateIntervalMillis(5000) .build(); requestingLocationUpdates = true; fusedLocationClient.requestLocationUpdates(locationRequest, locationCallback, Looper.getMainLooper()); itineraryViewModel.updateLocationStatus(itineraryViewModel.currentLocationName.getValue(), "Updating location (GPS)..."); } private void stopLocationUpdates() { if (requestingLocationUpdates) { fusedLocationClient.removeLocationUpdates(locationCallback); requestingLocationUpdates = false; } } @Override public void onRegenerateClicked() { triggerGeneration(true, Collections.emptyList()); } @Override public void onClearClicked() { itineraryViewModel.clearItinerary(); } @Override public void onEditLocationClicked() { showLocationChoiceDialog(); } @Override public void onCustomizeClicked() { CustomizeItineraryBottomSheet bottomSheet = CustomizeItineraryBottomSheet.newInstance(); bottomSheet.show(getSupportFragmentManager(), CustomizeItineraryBottomSheet.TAG); } @Override public void onCustomizeApplied(List<String> categoryPreferences) { Toast.makeText(this, "Applying customization and generating new plan...", Toast.LENGTH_SHORT).show(); triggerGeneration(true, categoryPreferences); } }
```

# app\src\main\java\com\example\alayaapp\ItineraryAdapter.java

```java
package com.example.alayaapp; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.Button; import android.widget.ImageButton; import android.widget.ImageView; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.recyclerview.widget.LinearLayoutManager; import androidx.recyclerview.widget.RecyclerView; import com.bumptech.glide.Glide; import java.text.SimpleDateFormat; import java.util.List; import java.util.Locale; public class ItineraryAdapter extends RecyclerView.Adapter<RecyclerView.ViewHolder> { private static final int VIEW_TYPE_LOCATION_HEADER = 0; private static final int VIEW_TYPE_HEADER = 1; private static final int VIEW_TYPE_ITINERARY_CARD = 2; private static final int VIEW_TYPE_HORIZONTAL_LIST = 3; private static final int VIEW_TYPE_FOOTER_MESSAGE = 4; public interface ItineraryHeaderListener { void onRegenerateClicked(); void onClearClicked(); void onEditLocationClicked(); void onCustomizeClicked(); } private final List<Object> displayItems; private final ItinerariesActivity activity; private final ItineraryHeaderListener headerListener; public ItineraryAdapter(ItinerariesActivity activity, List<Object> displayItems, ItineraryHeaderListener listener) { this.activity = activity; this.displayItems = displayItems; this.headerListener = listener; setHasStableIds(true); } @Override public int getItemViewType(int position) { Object item = displayItems.get(position); if (item instanceof LocationHeaderData) { return VIEW_TYPE_LOCATION_HEADER; } else if (item instanceof ItineraryItem) { return VIEW_TYPE_ITINERARY_CARD; } else if (item instanceof HorizontalListContainer) { return VIEW_TYPE_HORIZONTAL_LIST; } else if (item instanceof String) { String text = (String) item; if (text.equals("Suggested Itinerary")) { return VIEW_TYPE_HEADER; } else { return VIEW_TYPE_FOOTER_MESSAGE; } } return super.getItemViewType(position); } @NonNull @Override public RecyclerView.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { LayoutInflater inflater = LayoutInflater.from(activity); switch (viewType) { case VIEW_TYPE_LOCATION_HEADER: View locationHeaderView = inflater.inflate(R.layout.item_itinerary_location_header, parent, false); return new LocationHeaderViewHolder(locationHeaderView); case VIEW_TYPE_HEADER: View headerView = inflater.inflate(R.layout.item_itinerary_header, parent, false); return new HeaderViewHolder(headerView); case VIEW_TYPE_ITINERARY_CARD: View cardView = inflater.inflate(R.layout.list_item_itinerary, parent, false); return new CardViewHolder(cardView); case VIEW_TYPE_HORIZONTAL_LIST: View horizontalView = inflater.inflate(R.layout.item_itinerary_horizontal_list, parent, false); return new HorizontalListViewHolder(horizontalView); case VIEW_TYPE_FOOTER_MESSAGE: View footerView = inflater.inflate(R.layout.item_itinerary_footer_message, parent, false); return new FooterMessageViewHolder(footerView); default: throw new IllegalArgumentException("Invalid view type: " + viewType); } } @Override public void onBindViewHolder(@NonNull RecyclerView.ViewHolder holder, int position) { switch (holder.getItemViewType()) { case VIEW_TYPE_LOCATION_HEADER: ((LocationHeaderViewHolder) holder).bind((LocationHeaderData) displayItems.get(position), headerListener); break; case VIEW_TYPE_HEADER: ((HeaderViewHolder) holder).bind((String) displayItems.get(position)); break; case VIEW_TYPE_ITINERARY_CARD: int sequenceNumber = 1; for (int i = 0; i < position; i++) { if (displayItems.get(i) instanceof ItineraryItem) { sequenceNumber++; } } ((CardViewHolder) holder).bind((ItineraryItem) displayItems.get(position), sequenceNumber); break; case VIEW_TYPE_HORIZONTAL_LIST: ((HorizontalListViewHolder) holder).bind((HorizontalListContainer) displayItems.get(position)); break; case VIEW_TYPE_FOOTER_MESSAGE: ((FooterMessageViewHolder) holder).bind((String) displayItems.get(position)); break; } } @Override public int getItemCount() { return displayItems.size(); } @Override public long getItemId(int position) { Object item = displayItems.get(position); if (item instanceof ItineraryItem) { return ((ItineraryItem) item).getId(); } return item.hashCode(); } class LocationHeaderViewHolder extends RecyclerView.ViewHolder { TextView tvLocationCity, tvLocationStatus, tvHeaderMessage, tvItinerariesTitle; ImageButton ibEditLocation; Button btnRegenerate, btnClear, btnCustomize; LocationHeaderViewHolder(@NonNull View itemView) { super(itemView); tvItinerariesTitle = itemView.findViewById(R.id.tv_itineraries_title); tvLocationCity = itemView.findViewById(R.id.tv_location_city_itineraries); tvLocationStatus = itemView.findViewById(R.id.tv_location_status_itineraries); ibEditLocation = itemView.findViewById(R.id.ib_edit_location_itineraries); tvHeaderMessage = itemView.findViewById(R.id.tv_header_message); btnRegenerate = itemView.findViewById(R.id.btn_regenerate_itinerary); btnClear = itemView.findViewById(R.id.btn_clear_itinerary); btnCustomize = itemView.findViewById(R.id.btn_customize_itinerary); } void bind(LocationHeaderData data, ItineraryHeaderListener listener) { activity.itineraryViewModel.currentLocationName.observe(activity, tvLocationCity::setText); activity.itineraryViewModel.currentLocationStatus.observe(activity, tvLocationStatus::setText); ibEditLocation.setOnClickListener(v -> listener.onEditLocationClicked()); btnRegenerate.setOnClickListener(v -> listener.onRegenerateClicked()); btnClear.setOnClickListener(v -> listener.onClearClicked()); btnCustomize.setOnClickListener(v -> listener.onCustomizeClicked()); boolean hasItems = displayItems.stream().anyMatch(item -> item instanceof ItineraryItem); tvItinerariesTitle.setVisibility(hasItems ? View.VISIBLE : View.GONE); String message = data.getHeaderMessage(); if (message != null && !message.isEmpty()) { tvHeaderMessage.setText(message); tvHeaderMessage.setVisibility(View.VISIBLE); } else { tvHeaderMessage.setVisibility(View.GONE); } } } static class HeaderViewHolder extends RecyclerView.ViewHolder { TextView tvHeader; HeaderViewHolder(@NonNull View itemView) { super(itemView); tvHeader = itemView.findViewById(R.id.tv_section_header); } void bind(String title) { tvHeader.setText(title); } } class CardViewHolder extends RecyclerView.ViewHolder { ImageView ivImage; TextView tvTime, tvActivity, tvRating, tvItemNumber; CardViewHolder(@NonNull View itemView) { super(itemView); tvTime = itemView.findViewById(R.id.tv_item_time); tvActivity = itemView.findViewById(R.id.tv_item_activity); tvRating = itemView.findViewById(R.id.tv_item_rating); ivImage = itemView.findViewById(R.id.iv_item_image); tvItemNumber = itemView.findViewById(R.id.tv_item_number); } void bind(ItineraryItem item, int sequenceNumber) { tvTime.setText(item.getFormattedTime()); // UPDATED to show time window tvActivity.setText(item.getActivity()); tvRating.setText(item.getRating()); tvItemNumber.setText(String.valueOf(sequenceNumber)); if (item.getImageUrl() != null && !item.getImageUrl().isEmpty()) { Glide.with(activity) .load(item.getImageUrl()) .placeholder(R.drawable.img_placeholder) .error(R.drawable.img_error) .into(ivImage); } else { ivImage.setImageResource(R.drawable.img_placeholder); } } } class HorizontalListViewHolder extends RecyclerView.ViewHolder { RecyclerView rvHorizontal; TextView tvTitle; HorizontalListViewHolder(@NonNull View itemView) { super(itemView); rvHorizontal = itemView.findViewById(R.id.rv_horizontal); tvTitle = itemView.findViewById(R.id.tv_horizontal_section_header); } void bind(HorizontalListContainer container) { tvTitle.setText(container.getTitle()); RecommendedItineraryAdapter adapter = new RecommendedItineraryAdapter(activity, container.getRecommendedPlaces()); rvHorizontal.setLayoutManager(new LinearLayoutManager(activity, LinearLayoutManager.HORIZONTAL, false)); rvHorizontal.setAdapter(adapter); } } static class FooterMessageViewHolder extends RecyclerView.ViewHolder { TextView tvFooterMessage; FooterMessageViewHolder(@NonNull View itemView) { super(itemView); tvFooterMessage = itemView.findViewById(R.id.tv_footer_message); } void bind(String message) { tvFooterMessage.setText(message); } } public static class LocationHeaderData { private final String headerMessage; public LocationHeaderData(String headerMessage) { this.headerMessage = headerMessage; } public String getHeaderMessage() { return headerMessage; } } public static class HorizontalListContainer { private final String title; private final List<Place> recommendedPlaces; public HorizontalListContainer(String title, List<Place> places) { this.title = title; this.recommendedPlaces = places; } public String getTitle() { return title; } public List<Place> getRecommendedPlaces() { return recommendedPlaces; } } }
```

# app\src\main\java\com\example\alayaapp\ItineraryGenerator.java

```java
package com.example.alayaapp; import android.util.Log; import com.google.firebase.firestore.GeoPoint; import java.text.ParseException; import java.text.SimpleDateFormat; import java.util.ArrayList; import java.util.Calendar; import java.util.List; import java.util.Locale; import java.util.Map; import java.util.Objects; import java.util.stream.Collectors; import java.util.Date; public class ItineraryGenerator { private static final String TAG = "ItineraryGenerator"; private static final double AVERAGE_SPEED_KMH = 15.0; private static final int DEFAULT_VISIT_DURATION_MINUTES = 90; private static final int MIN_VISIT_DURATION_MINUTES = 30; private static final double CATEGORY_REPETITION_PENALTY_KM = 50.0; /** * Generates an itinerary with dynamic time windows for each stop. * This is the new primary generation method. */ public List<ItineraryItem> generateWithTimeWindows(GeoPoint userStartLocation, List<Place> allPlaces, Calendar tripStartCalendar, Calendar tripEndCalendar, List<String> categoryPreferences) { Log.d(TAG, "Starting dynamic window itinerary generation."); List<ItineraryItem> generatedItinerary = new ArrayList<>(); List<Place> availablePlaces = new ArrayList<>(allPlaces); String dayOfWeek = tripStartCalendar.getDisplayName(Calendar.DAY_OF_WEEK, Calendar.LONG, Locale.US).toLowerCase(); // 1. Pre-filter places that are closed for the entire day. availablePlaces.removeIf(place -> !isPlaceOpenOnDay(place, dayOfWeek)); if (availablePlaces.isEmpty()) { Log.w(TAG, "No places are open on " + dayOfWeek); return generatedItinerary; } // 2. Select the sequence of places to visit based on preferences. List<Place> sequence = selectPlaceSequence(userStartLocation, availablePlaces, categoryPreferences); if (sequence.isEmpty()) { Log.w(TAG, "Could not determine a valid sequence of places."); return generatedItinerary; } Log.d(TAG, "Determined sequence: " + sequence.stream().map(Place::getName).collect(Collectors.joining(" -> "))); // 3. Calculate total minimum time required for the sequence long totalMinVisitMinutes = 0; for (Place p : sequence) { totalMinVisitMinutes += p.getAverageVisitDuration() > 0 ? p.getAverageVisitDuration() : DEFAULT_VISIT_DURATION_MINUTES; } long totalTravelMinutes = 0; GeoPoint lastLocation = userStartLocation; for (Place p : sequence) { totalTravelMinutes += calculateTravelTime(lastLocation, p.getCoordinates()); lastLocation = p.getCoordinates(); } long minTotalTimeMinutes = totalMinVisitMinutes + totalTravelMinutes; long userTripDurationMinutes = (tripEndCalendar.getTimeInMillis() - tripStartCalendar.getTimeInMillis()) / (60 * 1000); // 4. Calculate and distribute slack time long slackMinutes = userTripDurationMinutes - minTotalTimeMinutes; Log.d(TAG, "User Trip: " + userTripDurationMinutes + " mins. Min Required: " + minTotalTimeMinutes + " mins. Slack: " + slackMinutes + " mins."); if (slackMinutes < 0) { Log.w(TAG, "Not enough time for the planned itinerary. Required time exceeds user's trip window."); return generatedItinerary; // Return empty list to signal failure } double perStopSlackMinutes = sequence.isEmpty() ? 0 : (double) slackMinutes / sequence.size(); // 5. Generate the final itinerary with time windows (Forward Pass) Calendar currentTime = (Calendar) tripStartCalendar.clone(); GeoPoint currentGeoLocation = userStartLocation; long itineraryItemIdCounter = 1; for (Place place : sequence) { int travelTime = calculateTravelTime(currentGeoLocation, place.getCoordinates()); Calendar arrivalTime = (Calendar) currentTime.clone(); arrivalTime.add(Calendar.MINUTE, travelTime); Calendar placeOpenTime = getPlaceTime(place, dayOfWeek, "open", tripStartCalendar); Calendar placeCloseTime = getPlaceTime(place, dayOfWeek, "close", tripStartCalendar); // The start of the visit window is the LATEST of: arrival time or opening time. Calendar windowStart = (Calendar) arrivalTime.clone(); if (windowStart.before(placeOpenTime)) { windowStart.setTime(placeOpenTime.getTime()); } // Calculate the end of the visit window based on duration + slack. int baseVisitDuration = place.getAverageVisitDuration() > 0 ? place.getAverageVisitDuration() : DEFAULT_VISIT_DURATION_MINUTES; int flexibleVisitDuration = (int) (baseVisitDuration + perStopSlackMinutes); Calendar windowEnd = (Calendar) windowStart.clone(); windowEnd.add(Calendar.MINUTE, flexibleVisitDuration); // The end of the visit window is the EARLIEST of: calculated end, closing time, or trip end time. if (windowEnd.after(placeCloseTime)) { windowEnd.setTime(placeCloseTime.getTime()); } if (windowEnd.after(tripEndCalendar)) { windowEnd.setTime(tripEndCalendar.getTime()); } // Final check: if the calculated window is invalid or too short, skip the place. long finalVisitMinutes = (windowEnd.getTimeInMillis() - windowStart.getTimeInMillis()) / (60 * 1000); if (finalVisitMinutes < MIN_VISIT_DURATION_MINUTES || windowStart.after(windowEnd) || windowStart.after(tripEndCalendar)) { Log.w(TAG, "Skipping " + place.getName() + " because the available time window is invalid or too short."); continue; } String rating = String.format(Locale.getDefault(), "%.1f", place.getRating()); generatedItinerary.add(new ItineraryItem( itineraryItemIdCounter++, windowStart, windowEnd, place.getName(), rating, place.getImage_url(), place.getCoordinates(), place.getDocumentId() )); // The departure time for the next leg is the end of the current window. currentTime = (Calendar) windowEnd.clone(); currentGeoLocation = place.getCoordinates(); } return generatedItinerary; } /** * Selects the sequence of places to visit, routing to the correct algorithm. */ private List<Place> selectPlaceSequence(GeoPoint startLocation, List<Place> availablePlaces, List<String> categoryPreferences) { if (categoryPreferences == null || categoryPreferences.isEmpty()) { return selectGreedySequence(startLocation, availablePlaces); } else { return selectCustomSequence(startLocation, availablePlaces, categoryPreferences); } } /** * Selects a sequence of places using a greedy nearest-neighbor approach. */ private List<Place> selectGreedySequence(GeoPoint startLocation, List<Place> availablePlaces) { List<Place> sequence = new ArrayList<>(); List<Place> pool = new ArrayList<>(availablePlaces); GeoPoint currentLocation = startLocation; String lastCategory = null; int maxStops = 5; // Default number of stops for greedy mode while (sequence.size() < maxStops && !pool.isEmpty()) { Place bestNextPlace = null; double bestScore = Double.MAX_VALUE; for (Place candidate : pool) { double distance = calculateDistance(currentLocation, candidate.getCoordinates()); double score = distance; if (candidate.getCategory() != null && candidate.getCategory().equals(lastCategory)) { score += CATEGORY_REPETITION_PENALTY_KM; } if (score < bestScore) { bestScore = score; bestNextPlace = candidate; } } if (bestNextPlace != null) { sequence.add(bestNextPlace); pool.remove(bestNextPlace); currentLocation = bestNextPlace.getCoordinates(); lastCategory = bestNextPlace.getCategory(); } else { break; } } return sequence; } /** * Selects a sequence of places based on user-defined category preferences for each stop. */ private List<Place> selectCustomSequence(GeoPoint startLocation, List<Place> availablePlaces, List<String> categoryPreferences) { List<Place> sequence = new ArrayList<>(); List<Place> pool = new ArrayList<>(availablePlaces); GeoPoint currentLocation = startLocation; for (String preferredCategory : categoryPreferences) { if (pool.isEmpty()) break; List<Place> candidatesForStop = new ArrayList<>(); if ("Any".equalsIgnoreCase(preferredCategory)) { candidatesForStop.addAll(pool); } else { for (Place p : pool) { if (preferredCategory.equalsIgnoreCase(p.getCategory())) { candidatesForStop.add(p); } } } if (candidatesForStop.isEmpty()) { Log.w(TAG, "No available places in pool for category: " + preferredCategory); continue; } Place bestNextPlace = null; double bestScore = Double.MAX_VALUE; for (Place candidate : candidatesForStop) { double distance = calculateDistance(currentLocation, candidate.getCoordinates()); if (distance < bestScore) { bestScore = distance; bestNextPlace = candidate; } } if (bestNextPlace != null) { sequence.add(bestNextPlace); pool.remove(bestNextPlace); currentLocation = bestNextPlace.getCoordinates(); } } return sequence; } private boolean isPlaceOpenOnDay(Place place, String dayOfWeek) { if (place.getOpeningHours() == null) return false; return place.getOpeningHours().containsKey(dayOfWeek); } private int calculateTravelTime(GeoPoint start, GeoPoint end) { if (start == null || end == null) return 0; double distance = calculateDistance(start, end); return (int) ((distance / AVERAGE_SPEED_KMH) * 60); } private Calendar getPlaceTime(Place place, String dayOfWeek, String type, Calendar referenceDate) { Calendar timeCal = (Calendar) referenceDate.clone(); try { Map<String, String> hours = place.getOpeningHours().get(dayOfWeek); if (hours == null || hours.get(type) == null) { throw new ParseException("Hours not available for " + type, 0); } SimpleDateFormat sdf = new SimpleDateFormat("HH:mm", Locale.US); Date parsedTime = sdf.parse(hours.get(type)); Calendar parsedCal = Calendar.getInstance(); parsedCal.setTime(Objects.requireNonNull(parsedTime)); timeCal.set(Calendar.HOUR_OF_DAY, parsedCal.get(Calendar.HOUR_OF_DAY)); timeCal.set(Calendar.MINUTE, parsedCal.get(Calendar.MINUTE)); timeCal.set(Calendar.SECOND, 0); timeCal.set(Calendar.MILLISECOND, 0); } catch (Exception e) { Log.e(TAG, "Failed to parse '" + type + "' time for " + place.getName() + ". Using default.", e); if ("open".equals(type)) { timeCal.set(Calendar.HOUR_OF_DAY, 0); timeCal.set(Calendar.MINUTE, 0); } else { timeCal.set(Calendar.HOUR_OF_DAY, 23); timeCal.set(Calendar.MINUTE, 59); } } return timeCal; } private double calculateDistance(GeoPoint start, GeoPoint end) { if (start == null || end == null) return Double.MAX_VALUE; final int R = 6371; // Radius of the earth in km double latDistance = Math.toRadians(end.getLatitude() - start.getLatitude()); double lonDistance = Math.toRadians(end.getLongitude() - start.getLongitude()); double a = Math.sin(latDistance / 2) * Math.sin(latDistance / 2) + Math.cos(Math.toRadians(start.getLatitude())) * Math.cos(Math.toRadians(end.getLatitude())) * Math.sin(lonDistance / 2) * Math.sin(lonDistance / 2); double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)); return R * c; } }
```

# app\src\main\java\com\example\alayaapp\ItineraryItem.java

```java
package com.example.alayaapp; import com.google.firebase.firestore.GeoPoint; import java.text.SimpleDateFormat; import java.util.Calendar; import java.util.Locale; public class ItineraryItem { private long id; // NEW: Replaced single time with a start and end time window private transient Calendar startTime; private transient Calendar endTime; private long startTimeMillis; private long endTimeMillis; private String activity; private String rating; private String imageUrl; private transient GeoPoint coordinates; private double latitude; private double longitude; private String placeDocumentId; // Default constructor for deserialization public ItineraryItem() {} // NEW: Updated constructor for time windows public ItineraryItem(long id, Calendar startTime, Calendar endTime, String activity, String rating, String imageUrl, GeoPoint coordinates, String placeDocumentId) { this.id = id; this.startTime = startTime; this.endTime = endTime; this.activity = activity; this.rating = rating; this.imageUrl = imageUrl; this.coordinates = coordinates; this.placeDocumentId = placeDocumentId; // For serialization if (startTime != null) this.startTimeMillis = startTime.getTimeInMillis(); if (endTime != null) this.endTimeMillis = endTime.getTimeInMillis(); if (coordinates != null) { this.latitude = coordinates.getLatitude(); this.longitude = coordinates.getLongitude(); } } // --- Getters and Setters --- public long getId() { return id; } public Calendar getStartTime() { if (startTime == null && startTimeMillis > 0) { startTime = Calendar.getInstance(); startTime.setTimeInMillis(startTimeMillis); } return startTime; } public Calendar getEndTime() { if (endTime == null && endTimeMillis > 0) { endTime = Calendar.getInstance(); endTime.setTimeInMillis(endTimeMillis); } return endTime; } public String getActivity() { return activity; } public String getRating() { return rating; } public String getImageUrl() { return imageUrl; } public String getPlaceDocumentId() { return placeDocumentId; } public GeoPoint getCoordinates() { if (coordinates == null && (latitude != 0.0 || longitude != 0.0)) { coordinates = new GeoPoint(latitude, longitude); } return coordinates; } // For backward compatibility, returns the start time. public Calendar getTime() { return getStartTime(); } // NEW: Updated method to format the time window public String getFormattedTime() { if (getStartTime() == null || getEndTime() == null) { return "Time not set"; } SimpleDateFormat sdf = new SimpleDateFormat("h:mm a", Locale.getDefault()); String start = sdf.format(getStartTime().getTime()); String end = sdf.format(getEndTime().getTime()); // Avoids showing "9:00 AM - 9:00 AM" for very short/punctual events if (start.equals(end)) { return start; } return start + " - " + end; } }
```

# app\src\main\java\com\example\alayaapp\ItineraryLogAdapter.java

```java
package com.example.alayaapp; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.recyclerview.widget.RecyclerView; import java.util.List; import java.util.Map; public class ItineraryLogAdapter extends RecyclerView.Adapter<ItineraryLogAdapter.LogViewHolder> { private final List<Map<String, String>> itineraryItems; public ItineraryLogAdapter(List<Map<String, String>> itineraryItems) { this.itineraryItems = itineraryItems; } @NonNull @Override public LogViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_itinerary_log_entry_detail, parent, false); return new LogViewHolder(view); } @Override public void onBindViewHolder(@NonNull LogViewHolder holder, int position) { Map<String, String> item = itineraryItems.get(position); holder.tvTime.setText(item.get("time")); holder.tvActivity.setText(item.get("activity")); holder.tvRating.setText(item.get("rating")); } @Override public int getItemCount() { return itineraryItems.size(); } static class LogViewHolder extends RecyclerView.ViewHolder { TextView tvTime, tvActivity, tvRating; public LogViewHolder(@NonNull View itemView) { super(itemView); tvTime = itemView.findViewById(R.id.tv_itinerary_time); tvActivity = itemView.findViewById(R.id.tv_itinerary_activity); tvRating = itemView.findViewById(R.id.tv_itinerary_rating); } } }
```

# app\src\main\java\com\example\alayaapp\ItineraryLogDetailActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AppCompatActivity; import androidx.recyclerview.widget.LinearLayoutManager; import android.os.Bundle; import android.util.Log; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityItineraryLogDetailBinding; import com.google.firebase.auth.FirebaseAuth; import com.google.firebase.auth.FirebaseUser; import com.google.firebase.firestore.DocumentSnapshot; import com.google.firebase.firestore.FirebaseFirestore; import java.util.ArrayList; import java.util.Map; public class ItineraryLogDetailActivity extends AppCompatActivity { private ActivityItineraryLogDetailBinding binding; private FirebaseFirestore db; private FirebaseAuth mAuth; private ItineraryLogAdapter adapter; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityItineraryLogDetailBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); db = FirebaseFirestore.getInstance(); mAuth = FirebaseAuth.getInstance(); String tripId = getIntent().getStringExtra("TRIP_ID"); setupRecyclerView(); binding.ivBackArrowLogDetail.setOnClickListener(v -> finish()); // The line referencing the bottom navigation has been removed. // binding.bottomNavigationLogDetail.setSelectedItemId(R.id.navigation_profile); if (tripId != null && !tripId.isEmpty()) { loadTripDetails(tripId); } else { Toast.makeText(this, "Error: Could not find trip details.", Toast.LENGTH_SHORT).show(); finish(); } } private void setupRecyclerView() { binding.rvItineraryLog.setLayoutManager(new LinearLayoutManager(this)); // Adapter will be set after data is loaded } private void loadTripDetails(String tripId) { FirebaseUser currentUser = mAuth.getCurrentUser(); if (currentUser == null) { Toast.makeText(this, "Please sign in to view details.", Toast.LENGTH_SHORT).show(); finish(); return; } db.collection("users").document(currentUser.getUid()) .collection("tripHistory").document(tripId) .get() .addOnCompleteListener(task -> { if (task.isSuccessful()) { DocumentSnapshot document = task.getResult(); if (document != null && document.exists()) { Trip trip = document.toObject(Trip.class); if (trip != null) { populateUI(trip); } } else { Log.d("LogDetail", "No such document"); Toast.makeText(this, "Trip not found.", Toast.LENGTH_SHORT).show(); } } else { Log.d("LogDetail", "get failed with ", task.getException()); Toast.makeText(this, "Failed to load trip details.", Toast.LENGTH_SHORT).show(); } }); } private void populateUI(Trip trip) { binding.tvLocationHeaderLogDetail.setText(trip.getTripTitle()); binding.tvDateRangeLogDetail.setText(trip.getTripDate()); if (trip.getItinerary() != null && !trip.getItinerary().isEmpty()) { adapter = new ItineraryLogAdapter(trip.getItinerary()); binding.rvItineraryLog.setAdapter(adapter); } else { // Handle case where itinerary list is empty, though unlikely if saved correctly adapter = new ItineraryLogAdapter(new ArrayList<>()); binding.rvItineraryLog.setAdapter(adapter); } } }
```

# app\src\main\java\com\example\alayaapp\ItineraryState.java

```java
package com.example.alayaapp; import java.util.List; import java.util.Objects; /** * A data class representing the complete state of a generated itinerary. * This object is serialized to JSON and stored in SharedPreferences. */ public class ItineraryState { // --- Generation Parameters --- private final double startLat; private final double startLon; private final long startTimeMillis; private final long endTimeMillis; private final List<String> categoryPreferences; // NEW: Store the customization // --- Generated Data --- private final List<ItineraryItem> itineraryItems; private final List<Place> topRatedPlaces; private final String headerMessage; private final String locationName; public ItineraryState(double startLat, double startLon, long startTimeMillis, long endTimeMillis, List<String> categoryPreferences, List<ItineraryItem> itineraryItems, List<Place> topRatedPlaces, String headerMessage, String locationName) { this.startLat = startLat; this.startLon = startLon; this.startTimeMillis = startTimeMillis; this.endTimeMillis = endTimeMillis; this.categoryPreferences = categoryPreferences; // NEW this.itineraryItems = itineraryItems; this.topRatedPlaces = topRatedPlaces; this.headerMessage = headerMessage; this.locationName = locationName; } public List<ItineraryItem> getItineraryItems() { return itineraryItems; } public List<Place> getTopRatedPlaces() { return topRatedPlaces; } public String getHeaderMessage() { return headerMessage; } public String getLocationName() { return locationName; } /** * Checks if the parameters used to generate this itinerary state * are still valid compared to the current user preferences. * A small tolerance is used for location comparison. */ public boolean isStillValid(double currentLat, double currentLon, long currentStartMillis, long currentEndMillis, List<String> currentPreferences) { final double LAT_LON_TOLERANCE = 0.0001; // Approx 11 meters boolean isLocationSame = Math.abs(this.startLat - currentLat) < LAT_LON_TOLERANCE && Math.abs(this.startLon - currentLon) < LAT_LON_TOLERANCE; boolean areTimesSame = this.startTimeMillis == currentStartMillis && this.endTimeMillis == currentEndMillis; // NEW: Also check if the customization preferences are identical boolean arePrefsSame = Objects.equals(this.categoryPreferences, currentPreferences); return isLocationSame && areTimesSame && arePrefsSame; } @Override public boolean equals(Object o) { if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; ItineraryState that = (ItineraryState) o; return Double.compare(that.startLat, startLat) == 0 && Double.compare(that.startLon, startLon) == 0 && startTimeMillis == that.startTimeMillis && endTimeMillis == that.endTimeMillis && Objects.equals(categoryPreferences, that.categoryPreferences); // NEW } @Override public int hashCode() { return Objects.hash(startLat, startLon, startTimeMillis, endTimeMillis, categoryPreferences); // NEW } }
```

# app\src\main\java\com\example\alayaapp\ItineraryViewModel.java

```java
package com.example.alayaapp; import android.app.Application; import android.content.Context; import android.content.SharedPreferences; import android.util.Log; import android.widget.Toast; import androidx.annotation.NonNull; import androidx.lifecycle.AndroidViewModel; import androidx.lifecycle.LiveData; import androidx.lifecycle.MutableLiveData; import com.google.firebase.auth.FirebaseAuth; import com.google.firebase.auth.FirebaseUser; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.GeoPoint; import com.google.firebase.firestore.Query; import com.google.firebase.firestore.QueryDocumentSnapshot; import com.google.gson.Gson; import com.google.gson.GsonBuilder; import java.text.DateFormat; import java.text.SimpleDateFormat; import java.util.ArrayList; import java.util.Calendar; import java.util.Collections; import java.util.HashMap; import java.util.List; import java.util.Locale; import java.util.Map; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class ItineraryViewModel extends AndroidViewModel { private static final String TAG = "ItineraryViewModel"; private static final String PREFS_NAME = "AlayaAppPrefs"; private static final String KEY_ACTIVE_ITINERARY_STATE = "active_itinerary_state"; private final MutableLiveData<Boolean> _isLoading = new MutableLiveData<>(false); public final LiveData<Boolean> isLoading = _isLoading; private final MutableLiveData<Boolean> _isItinerarySaved = new MutableLiveData<>(false); public final LiveData<Boolean> isItinerarySaved = _isItinerarySaved; private final MutableLiveData<String> _currentLocationName = new MutableLiveData<>("Tap to get current location"); public final LiveData<String> currentLocationName = _currentLocationName; private final MutableLiveData<String> _currentLocationStatus = new MutableLiveData<>("Set your location to begin"); public final LiveData<String> currentLocationStatus = _currentLocationStatus; private final MutableLiveData<ItineraryState> _itineraryState = new MutableLiveData<>(); public final LiveData<ItineraryState> itineraryState = _itineraryState; private final SharedPreferences sharedPreferences; private final Gson gson; private final FirebaseFirestore db; private final ItineraryGenerator itineraryGenerator; private final ExecutorService executorService = Executors.newSingleThreadExecutor(); public ItineraryViewModel(@NonNull Application application) { super(application); sharedPreferences = application.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE); gson = new GsonBuilder().create(); db = FirebaseFirestore.getInstance(); itineraryGenerator = new ItineraryGenerator(); } public void initializeState() { executorService.execute(() -> { ItineraryState savedState = loadStateFromPrefs(); if (savedState != null) { Log.d(TAG, "ViewModel initialized with a saved state."); _itineraryState.postValue(savedState); _currentLocationName.postValue(savedState.getLocationName()); _currentLocationStatus.postValue("Loaded saved plan for: " + savedState.getLocationName()); // --- THE COMPLETE FIX IS HERE --- if (savedState.getItineraryItems() != null && !savedState.getItineraryItems().isEmpty()) { // Get the start time from the first item Calendar tripStart = savedState.getItineraryItems().get(0).getStartTime(); // **CRITICAL NULL CHECK** // Ensure the calendar object was successfully created before using it. if (tripStart != null) { checkIfTripIsAlreadySaved(savedState.getItineraryItems(), savedState.getLocationName(), tripStart); } else { // If the time is invalid, it can't be a saved trip. Log.w(TAG, "Loaded itinerary item has an invalid start time. Cannot check history."); _isItinerarySaved.postValue(false); } } else { // If there are no items, it can't be saved, so set to false. _isItinerarySaved.postValue(false); } // --- END OF FIX --- } else { Log.d(TAG, "ViewModel initialized with no saved state."); _itineraryState.postValue(null); } }); } public void loadOrGenerateItinerary(GeoPoint startLocation, String locationName, Calendar tripStart, Calendar tripEnd, List<Place> allPlaces, boolean forceRegenerate, List<String> categoryPreferences) { _isLoading.setValue(true); executorService.execute(() -> { ItineraryState savedState = loadStateFromPrefs(); if (savedState != null && !forceRegenerate && savedState.isStillValid(startLocation.getLatitude(), startLocation.getLongitude(), tripStart.getTimeInMillis(), tripEnd.getTimeInMillis(), categoryPreferences)) { Log.d(TAG, "Valid saved itinerary found. Loading from SharedPreferences."); _itineraryState.postValue(savedState); _currentLocationName.postValue(savedState.getLocationName()); _currentLocationStatus.postValue("Loaded saved plan for: " + savedState.getLocationName()); checkIfTripIsAlreadySaved(savedState.getItineraryItems(), savedState.getLocationName(), tripStart); _isLoading.postValue(false); } else { Log.d(TAG, forceRegenerate ? "Forcing regeneration." : "No valid saved itinerary. Generating new one."); List<ItineraryItem> generatedItems = itineraryGenerator.generateWithTimeWindows(startLocation, allPlaces, tripStart, tripEnd, categoryPreferences); String message = ""; if (generatedItems.isEmpty()) { message = "We couldn't find any open attractions for your selected time and categories, or the schedule was too tight. Try extending your trip time or changing preferences."; } else if (categoryPreferences != null && !categoryPreferences.isEmpty() && generatedItems.size() < categoryPreferences.size()) { message = "We couldn't find matches for all your preferences, but here's what we found!"; } else { message = "This is a suggested plan. Times are flexible and based on your trip window and location hours."; } fetchRecommendationsAndBuildState(generatedItems, message, startLocation, locationName, tripStart, tripEnd, categoryPreferences); } }); } public void clearItinerary() { sharedPreferences.edit().remove(KEY_ACTIVE_ITINERARY_STATE).apply(); _itineraryState.postValue(null); _isItinerarySaved.postValue(false); Toast.makeText(getApplication(), "Itinerary cleared.", Toast.LENGTH_SHORT).show(); } private void fetchRecommendationsAndBuildState(List<ItineraryItem> mainItinerary, String message, GeoPoint startLocation, String locationName, Calendar tripStart, Calendar tripEnd, List<String> categoryPreferences) { List<String> excludedIds = new ArrayList<>(); if (mainItinerary != null) { for (ItineraryItem item : mainItinerary) { if (item.getPlaceDocumentId() != null) excludedIds.add(item.getPlaceDocumentId()); } } Query topRatedQuery = db.collection("places").orderBy("rating", Query.Direction.DESCENDING).limit(10); if (!excludedIds.isEmpty() && excludedIds.size() < 10) { // Firestore 'not-in' limit is 10 topRatedQuery = topRatedQuery.whereNotIn(com.google.firebase.firestore.FieldPath.documentId(), excludedIds); } topRatedQuery.get().addOnCompleteListener(task -> { List<Place> topRatedPlaces = new ArrayList<>(); if (task.isSuccessful() && task.getResult() != null) { for (QueryDocumentSnapshot document : task.getResult()) { Place place = document.toObject(Place.class); place.setDocumentId(document.getId()); topRatedPlaces.add(place); } } else { Log.w(TAG, "Error getting recommended places.", task.getException()); } ItineraryState newState = new ItineraryState( startLocation.getLatitude(), startLocation.getLongitude(), tripStart.getTimeInMillis(), tripEnd.getTimeInMillis(), categoryPreferences, mainItinerary, topRatedPlaces, message, locationName ); saveStateToPrefs(newState); _itineraryState.postValue(newState); _currentLocationName.postValue(locationName); _currentLocationStatus.postValue("Generated new plan for: " + locationName); checkIfTripIsAlreadySaved(mainItinerary, locationName, tripStart); _isLoading.postValue(false); }); } private void saveStateToPrefs(ItineraryState state) { if (state == null) return; String json = gson.toJson(state); sharedPreferences.edit().putString(KEY_ACTIVE_ITINERARY_STATE, json).apply(); Log.d(TAG, "Itinerary state saved to SharedPreferences."); } private ItineraryState loadStateFromPrefs() { String json = sharedPreferences.getString(KEY_ACTIVE_ITINERARY_STATE, null); if (json == null) return null; try { return gson.fromJson(json, ItineraryState.class); } catch (Exception e) { Log.e(TAG, "Error deserializing ItineraryState from JSON", e); return null; } } public void saveCurrentTripToHistory(Calendar tripStartCalendar) { FirebaseUser currentUser = FirebaseAuth.getInstance().getCurrentUser(); if (currentUser == null) { Toast.makeText(getApplication(), "You must be signed in to save a trip.", Toast.LENGTH_SHORT).show(); return; } ItineraryState currentState = _itineraryState.getValue(); if (currentState == null || currentState.getItineraryItems() == null || currentState.getItineraryItems().isEmpty()) { Toast.makeText(getApplication(), "No itinerary to save.", Toast.LENGTH_SHORT).show(); return; } _isItinerarySaved.setValue(true); Toast.makeText(getApplication(), "Saving trip...", Toast.LENGTH_SHORT).show(); List<ItineraryItem> currentItinerary = currentState.getItineraryItems(); String tripTitle = "Trip to " + currentState.getLocationName(); String tripDate = DateFormat.getDateInstance(DateFormat.MEDIUM).format(tripStartCalendar.getTime()); String signature = generateTripSignature(currentItinerary, currentState.getLocationName(), tripStartCalendar); List<Map<String, String>> itineraryForDb = new ArrayList<>(); for (ItineraryItem item : currentItinerary) { Map<String, String> itemMap = new HashMap<>(); itemMap.put("activity", item.getActivity()); itemMap.put("time", item.getFormattedTime()); itemMap.put("rating", item.getRating()); itineraryForDb.add(itemMap); } Trip tripToSave = new Trip(tripTitle, tripDate, signature, itineraryForDb); db.collection("users").document(currentUser.getUid()) .collection("tripHistory") .add(tripToSave) .addOnSuccessListener(documentReference -> Toast.makeText(getApplication(), "Trip saved successfully!", Toast.LENGTH_SHORT).show()) .addOnFailureListener(e -> { Toast.makeText(getApplication(), "Error saving trip. It will be saved when you're online.", Toast.LENGTH_LONG).show(); Log.w(TAG, "Error adding document, will be retried by Firestore offline persistence.", e); }); } private void checkIfTripIsAlreadySaved(List<ItineraryItem> itinerary, String locationName, Calendar tripStartCalendar) { FirebaseUser currentUser = FirebaseAuth.getInstance().getCurrentUser(); if (currentUser == null || itinerary == null || itinerary.isEmpty()) { _isItinerarySaved.postValue(false); return; } String signature = generateTripSignature(itinerary, locationName, tripStartCalendar); db.collection("users").document(currentUser.getUid()) .collection("tripHistory") .whereEqualTo("tripSignature", signature) .limit(1) .get() .addOnCompleteListener(task -> { _isItinerarySaved.postValue(task.isSuccessful() && task.getResult() != null && !task.getResult().isEmpty()); }); } private String generateTripSignature(List<ItineraryItem> itinerary, String locationName, Calendar tripStartCalendar) { // Defensive null checks to prevent crashes if (itinerary == null || itinerary.isEmpty() || tripStartCalendar == null) { return ""; } String date = new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault()).format(tripStartCalendar.getTime()); String firstActivity = itinerary.get(0).getActivity(); return locationName + "_" + date + "_" + firstActivity; } public void updateLocationStatus(String name, String status) { _currentLocationName.postValue(name); _currentLocationStatus.postValue(status); } }
```

# app\src\main\java\com\example\alayaapp\LocationPickerViewModel.java

```java
package com.example.alayaapp; import android.location.Address; import android.location.Geocoder; import android.util.Log; import androidx.lifecycle.LiveData; import androidx.lifecycle.MutableLiveData; import androidx.lifecycle.ViewModel; import com.google.android.gms.maps.model.LatLng; import java.io.IOException; import java.util.ArrayList; import java.util.List; import java.util.Locale; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class LocationPickerViewModel extends ViewModel { private static final String TAG = "LocationPickerViewModel"; private final ExecutorService executorService = Executors.newSingleThreadExecutor(); private final MutableLiveData<List<Address>> geocodeResults = new MutableLiveData<>(); private final MutableLiveData<String> reverseGeocodeResult = new MutableLiveData<>(); // Bounding box for Geocoder search bias (Philippines) private static final double PH_LOWER_LEFT_LAT = 4.0; private static final double PH_LOWER_LEFT_LON = 116.0; private static final double PH_UPPER_RIGHT_LAT = 22.0; private static final double PH_UPPER_RIGHT_LON = 127.0; public LiveData<List<Address>> getGeocodeResults() { return geocodeResults; } public LiveData<String> getReverseGeocodeResult() { return reverseGeocodeResult; } public void searchLocationByName(String query, Geocoder geocoder) { executorService.execute(() -> { if (geocoder == null) { geocodeResults.postValue(null); return; } try { List<Address> addresses = geocoder.getFromLocationName(query, 10, PH_LOWER_LEFT_LAT, PH_LOWER_LEFT_LON, PH_UPPER_RIGHT_LAT, PH_UPPER_RIGHT_LON); geocodeResults.postValue(addresses); } catch (IOException e) { Log.e(TAG, "Geocoder error for query: " + query, e); geocodeResults.postValue(null); } catch (IllegalArgumentException e) { Log.e(TAG, "Geocoder illegal argument for bounds: " + query, e); try { List<Address> addresses = geocoder.getFromLocationName(query, 10); geocodeResults.postValue(addresses); } catch (IOException ioe) { Log.e(TAG, "Geocoder fallback error for query: " + query, ioe); geocodeResults.postValue(null); } } }); } public void reverseGeocode(LatLng point, Geocoder geocoder) { executorService.execute(() -> { if (geocoder == null) { reverseGeocodeResult.postValue("Selected Coordinates"); return; } try { List<Address> addresses = geocoder.getFromLocation(point.latitude, point.longitude, 1); if (addresses != null && !addresses.isEmpty()) { reverseGeocodeResult.postValue(ManualLocationPickerActivity.Helper.getAddressDisplayName(addresses.get(0))); } else { reverseGeocodeResult.postValue(String.format(Locale.US, "Lat:%.4f, Lon:%.4f", point.latitude, point.longitude)); } } catch (IOException e) { Log.e(TAG, "Reverse geocoding error", e); reverseGeocodeResult.postValue(String.format(Locale.US, "Lat:%.4f, Lon:%.4f", point.latitude, point.longitude)); } }); } }
```

# app\src\main\java\com\example\alayaapp\LocationSuggestionAdapter.java

```java
package com.example.alayaapp; import android.location.Address; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.TextView; import androidx.annotation.NonNull; import androidx.recyclerview.widget.RecyclerView; import java.util.ArrayList; import java.util.List; import java.util.Locale; public class LocationSuggestionAdapter extends RecyclerView.Adapter<LocationSuggestionAdapter.ViewHolder> { private List<Address> suggestions = new ArrayList<>(); private OnSuggestionClickListener listener; public interface OnSuggestionClickListener { void onSuggestionClick(Address address); } public LocationSuggestionAdapter(OnSuggestionClickListener listener) { this.listener = listener; } public void setSuggestions(List<Address> newSuggestions) { this.suggestions.clear(); if (newSuggestions != null) { this.suggestions.addAll(newSuggestions); } notifyDataSetChanged(); } @NonNull @Override public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { View view = LayoutInflater.from(parent.getContext()) .inflate(R.layout.list_item_location_suggestion, parent, false); return new ViewHolder(view); } @Override public void onBindViewHolder(@NonNull ViewHolder holder, int position) { Address address = suggestions.get(position); holder.bind(address, listener); } @Override public int getItemCount() { return suggestions.size(); } static class ViewHolder extends RecyclerView.ViewHolder { TextView tvMainText; TextView tvSecondaryText; ViewHolder(@NonNull View itemView) { super(itemView); tvMainText = itemView.findViewById(R.id.tv_suggestion_main_text); tvSecondaryText = itemView.findViewById(R.id.tv_suggestion_secondary_text); } void bind(final Address address, final OnSuggestionClickListener listener) { String mainText = ManualLocationPickerActivity.Helper.getAddressDisplayName(address); tvMainText.setText(mainText); // Construct secondary text (e.g., AdminArea, Country) StringBuilder secondaryBuilder = new StringBuilder(); if (address.getAdminArea() != null && !mainText.toLowerCase(Locale.ROOT).contains(address.getAdminArea().toLowerCase(Locale.ROOT))) { secondaryBuilder.append(address.getAdminArea()); } if (address.getCountryName() != null && !mainText.toLowerCase(Locale.ROOT).contains(address.getCountryName().toLowerCase(Locale.ROOT))) { if (secondaryBuilder.length() > 0) secondaryBuilder.append(", "); secondaryBuilder.append(address.getCountryName()); } if (secondaryBuilder.length() > 0) { tvSecondaryText.setText(secondaryBuilder.toString()); tvSecondaryText.setVisibility(View.VISIBLE); } else { tvSecondaryText.setVisibility(View.GONE); } itemView.setOnClickListener(v -> listener.onSuggestionClick(address)); } } }
```

# app\src\main\java\com\example\alayaapp\LoginActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AppCompatActivity; import android.content.Intent; import android.os.Bundle; import android.util.Log; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityLoginBinding; import com.google.firebase.auth.FirebaseAuth; // Firebase Import import com.google.firebase.auth.FirebaseUser; // Firebase Import public class LoginActivity extends AppCompatActivity { private ActivityLoginBinding binding; private FirebaseAuth mAuth; // Firebase Auth instance private static final String TAG = "LoginActivity"; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityLoginBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); // Initialize Firebase Auth mAuth = FirebaseAuth.getInstance(); binding.loginButton.setOnClickListener(v -> { String email = binding.emailEditText.getText().toString().trim(); String password = binding.passwordEditText.getText().toString().trim(); boolean valid = true; if (email.isEmpty()) { binding.emailLayout.setError("Email required"); valid = false; } else { binding.emailLayout.setError(null); } if (password.isEmpty()) { binding.passwordLayout.setError("Password required"); valid = false; } else { binding.passwordLayout.setError(null); } if (!valid) { return; } binding.loginButton.setEnabled(false); Toast.makeText(LoginActivity.this, "Logging in...", Toast.LENGTH_SHORT).show(); mAuth.signInWithEmailAndPassword(email, password) .addOnCompleteListener(this, task -> { binding.loginButton.setEnabled(true); if (task.isSuccessful()) { Log.d(TAG, "signInWithEmail:success"); // FirebaseUser user = mAuth.getCurrentUser(); // You can get user if needed Toast.makeText(LoginActivity.this, "Login Successful!", Toast.LENGTH_SHORT).show(); // Navigate directly to HomeActivity Intent intent = new Intent(LoginActivity.this, HomeActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK); // Clear back stack startActivity(intent); finish(); // Close LoginActivity } else { Log.w(TAG, "signInWithEmail:failure", task.getException()); Toast.makeText(LoginActivity.this, "Authentication failed: " + (task.getException() != null ? task.getException().getMessage() : "Unknown error"), Toast.LENGTH_LONG).show(); binding.passwordLayout.setError("Incorrect email or password"); } }); }); binding.switchToSignupLayout.setOnClickListener(v -> { Intent intent = new Intent(LoginActivity.this, SignUpActivity.class); startActivity(intent); }); binding.tvForgotPassword.setOnClickListener(v -> { Intent intent = new Intent(LoginActivity.this, ResetPasswordActivity.class); startActivity(intent); }); } }
```

# app\src\main\java\com\example\alayaapp\ManualLocationPickerActivity.java

```java
package com.example.alayaapp; import android.Manifest; import android.content.Context; import android.content.Intent; import android.content.pm.PackageManager; import android.location.Address; import android.location.Geocoder; import android.location.Location; import android.os.Bundle; import android.os.Handler; import android.os.Looper; import android.text.Editable; import android.text.TextUtils; import android.text.TextWatcher; import android.util.Log; import android.view.View; import android.view.inputmethod.EditorInfo; import android.view.inputmethod.InputMethodManager; import android.widget.Toast; import androidx.annotation.NonNull; import androidx.appcompat.app.AppCompatActivity; import androidx.appcompat.widget.Toolbar; import androidx.core.app.ActivityCompat; import androidx.core.content.ContextCompat; import androidx.lifecycle.ViewModelProvider; // New import import androidx.recyclerview.widget.LinearLayoutManager; import com.example.alayaapp.databinding.ActivityManualLocationPickerBinding; import com.google.android.gms.location.FusedLocationProviderClient; import com.google.android.gms.location.LocationServices; import com.google.android.gms.maps.CameraUpdateFactory; import com.google.android.gms.maps.GoogleMap; import com.google.android.gms.maps.OnMapReadyCallback; import com.google.android.gms.maps.SupportMapFragment; import com.google.android.gms.maps.model.LatLng; import com.google.android.gms.maps.model.Marker; import com.google.android.gms.maps.model.MarkerOptions; import java.util.ArrayList; import java.util.List; import java.util.Locale; public class ManualLocationPickerActivity extends AppCompatActivity implements OnMapReadyCallback, LocationSuggestionAdapter.OnSuggestionClickListener, GoogleMap.OnMapClickListener { private static final String TAG = "ManualLocationPicker"; // NEW: Constants for intent extras public static final String EXTRA_INITIAL_LAT = "initial_latitude"; public static final String EXTRA_INITIAL_LON = "initial_longitude"; public static final String EXTRA_INITIAL_NAME = "initial_location_name"; private ActivityManualLocationPickerBinding binding; private GoogleMap mMap; private Marker selectedLocationMarker; private LatLng currentSelectedPoint; private String currentSelectedName = ""; private FusedLocationProviderClient fusedLocationClientPicker; private static final int REQUEST_LOCATION_PERMISSION_PICKER = 3; private LocationSuggestionAdapter suggestionAdapter; private Handler searchDebounceHandler = new Handler(Looper.getMainLooper()); private Runnable searchDebounceRunnable; private static final long SEARCH_DEBOUNCE_DELAY_MS = 700; private boolean isUserInteractingWithSearch = false; private Geocoder geocoder; // Geocoder instance // --- NEW: ViewModel instance --- private LocationPickerViewModel viewModel; // --- NEW: Variables to hold initial data from intent --- private LatLng initialPoint = null; private String initialName = ""; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // --- NEW: Initialize ViewModel --- viewModel = new ViewModelProvider(this).get(LocationPickerViewModel.class); binding = ActivityManualLocationPickerBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); Toolbar toolbar = binding.toolbarManualLocation; setSupportActionBar(toolbar); if (getSupportActionBar() != null) { getSupportActionBar().setDisplayHomeAsUpEnabled(true); getSupportActionBar().setTitle("Set Location Manually"); } toolbar.setNavigationOnClickListener(v -> finish()); // --- NEW: Read initial location data from intent --- if (getIntent().hasExtra(EXTRA_INITIAL_LAT)) { double lat = getIntent().getDoubleExtra(EXTRA_INITIAL_LAT, 0.0); double lon = getIntent().getDoubleExtra(EXTRA_INITIAL_LON, 0.0); initialName = getIntent().getStringExtra(EXTRA_INITIAL_NAME); if (lat != 0.0 && lon != 0.0) { initialPoint = new LatLng(lat, lon); } } SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager() .findFragmentById(R.id.map_fragment_picker_container); if (mapFragment != null) { mapFragment.getMapAsync(this); } setupSuggestionRecyclerView(); fusedLocationClientPicker = LocationServices.getFusedLocationProviderClient(this); if (Geocoder.isPresent()) { geocoder = new Geocoder(this, Locale.getDefault()); } else { Toast.makeText(this, "Geocoder service not available.", Toast.LENGTH_LONG).show(); } setupSearchFunctionality(); binding.btnConfirmLocation.setOnClickListener(v -> { if (currentSelectedPoint != null && !TextUtils.isEmpty(currentSelectedName)) { Intent resultIntent = new Intent(); resultIntent.putExtra("selected_location_name", currentSelectedName); resultIntent.putExtra("selected_latitude", currentSelectedPoint.latitude); resultIntent.putExtra("selected_longitude", currentSelectedPoint.longitude); setResult(RESULT_OK, resultIntent); finish(); } else { Toast.makeText(this, "Please select a location by tapping the map or searching.", Toast.LENGTH_LONG).show(); } }); binding.fabPickerMyLocation.setOnClickListener(v -> goToMyCurrentLocation()); // --- NEW: Set up observers --- setupObservers(); } private void setupObservers() { // Observer for geocoding (search) results viewModel.getGeocodeResults().observe(this, addresses -> { String currentSearchText = binding.etSearchLocation.getText().toString().trim(); if (addresses == null || addresses.isEmpty()) { suggestionAdapter.setSuggestions(null); binding.rvLocationSuggestions.setVisibility(View.GONE); } else { List<Address> validAddresses = new ArrayList<>(); for (Address adr : addresses) { if (adr.hasLatitude() && adr.hasLongitude()) { validAddresses.add(adr); } } suggestionAdapter.setSuggestions(validAddresses); if (!validAddresses.isEmpty() && binding.etSearchLocation.hasFocus()) { binding.rvLocationSuggestions.setVisibility(View.VISIBLE); } else { binding.rvLocationSuggestions.setVisibility(View.GONE); } } }); // Observer for reverse geocoding results viewModel.getReverseGeocodeResult().observe(this, addressName -> { if (addressName != null) { currentSelectedName = addressName; setSearchText(addressName); if (selectedLocationMarker != null) { selectedLocationMarker.setTitle(addressName); } } }); } private void performSearch(String query) { if (query.isEmpty()) { suggestionAdapter.setSuggestions(null); binding.rvLocationSuggestions.setVisibility(View.GONE); return; } if (geocoder != null) { // --- REFACTORED: Call ViewModel --- viewModel.searchLocationByName(query, geocoder); } } private void updateSelectedLocation(LatLng point, String name, boolean performReverseGeocode) { currentSelectedPoint = point; if (selectedLocationMarker != null) { selectedLocationMarker.remove(); } MarkerOptions markerOptions = new MarkerOptions().position(point); if (name != null && !name.isEmpty()) { markerOptions.title(name); currentSelectedName = name; setSearchText(name); } selectedLocationMarker = mMap.addMarker(markerOptions); mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(point, 15f)); if (performReverseGeocode && name == null) { setSearchText("Fetching address..."); // --- REFACTORED: Call ViewModel --- if (geocoder != null) { viewModel.reverseGeocode(point, geocoder); } } binding.btnConfirmLocation.setEnabled(true); } private void setupSearchFunctionality() { binding.etSearchLocation.setOnEditorActionListener((v, actionId, event) -> { if (actionId == EditorInfo.IME_ACTION_SEARCH) { searchDebounceHandler.removeCallbacks(searchDebounceRunnable); performSearch(binding.etSearchLocation.getText().toString()); hideKeyboard(); return true; } return false; }); binding.etSearchLocation.addTextChangedListener(new TextWatcher() { @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) {} @Override public void onTextChanged(CharSequence s, int start, int before, int count) { if (!isUserInteractingWithSearch) return; searchDebounceHandler.removeCallbacks(searchDebounceRunnable); String query = s.toString().trim(); if (query.length() > 2) { binding.btnClearSearch.setVisibility(View.VISIBLE); searchDebounceRunnable = () -> performSearch(query); searchDebounceHandler.postDelayed(searchDebounceRunnable, SEARCH_DEBOUNCE_DELAY_MS); } else { binding.btnClearSearch.setVisibility(View.GONE); suggestionAdapter.setSuggestions(null); binding.rvLocationSuggestions.setVisibility(View.GONE); } } @Override public void afterTextChanged(Editable s) {} }); binding.etSearchLocation.setOnFocusChangeListener((v, hasFocus) -> { isUserInteractingWithSearch = hasFocus; if (!hasFocus) { new Handler(Looper.getMainLooper()).postDelayed(() -> { if (binding.rvLocationSuggestions.getVisibility() == View.VISIBLE && !isFinishing()) { // binding.rvLocationSuggestions.setVisibility(View.GONE); } }, 200); } else { isUserInteractingWithSearch = true; } }); binding.btnClearSearch.setOnClickListener(v -> { isUserInteractingWithSearch = true; binding.etSearchLocation.setText(""); isUserInteractingWithSearch = false; suggestionAdapter.setSuggestions(null); binding.rvLocationSuggestions.setVisibility(View.GONE); binding.btnClearSearch.setVisibility(View.GONE); }); } private void setupSuggestionRecyclerView() { suggestionAdapter = new LocationSuggestionAdapter(this); binding.rvLocationSuggestions.setLayoutManager(new LinearLayoutManager(this)); binding.rvLocationSuggestions.setAdapter(suggestionAdapter); } @Override public void onMapReady(@NonNull GoogleMap googleMap) { mMap = googleMap; mMap.setOnMapClickListener(this); mMap.getUiSettings().setZoomControlsEnabled(true); // --- MODIFIED LOGIC --- if (initialPoint != null) { // A previous manual location was passed in, so we use it. updateSelectedLocation(initialPoint, initialName, false); // false = don't reverse geocode mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(initialPoint, 15f)); checkAndRequestPickerPermissions(false); // Enable location layer but don't center on it } else { // No previous location, so use the default behavior LatLng philippinesCenter = new LatLng(12.8797, 121.7740); mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(philippinesCenter, 5.5f)); checkAndRequestPickerPermissions(true); // Center on GPS if permission is granted } } @Override public void onMapClick(@NonNull LatLng latLng) { hideKeyboard(); binding.rvLocationSuggestions.setVisibility(View.GONE); updateSelectedLocation(latLng, null, true); } private void setSearchText(String text) { isUserInteractingWithSearch = false; binding.etSearchLocation.setText(text); if (!TextUtils.isEmpty(text)) { binding.etSearchLocation.setSelection(text.length()); binding.btnClearSearch.setVisibility(View.VISIBLE); } else { binding.btnClearSearch.setVisibility(View.GONE); } if (binding.etSearchLocation.hasFocus()) { new Handler(Looper.getMainLooper()).postDelayed(() -> isUserInteractingWithSearch = true, 50); } } @Override public void onSuggestionClick(Address address) { hideKeyboard(); binding.rvLocationSuggestions.setVisibility(View.GONE); isUserInteractingWithSearch = false; if (address.hasLatitude() && address.hasLongitude()) { LatLng resultPoint = new LatLng(address.getLatitude(), address.getLongitude()); String displayName = ManualLocationPickerActivity.Helper.getAddressDisplayName(address); updateSelectedLocation(resultPoint, displayName, false); } else { Toast.makeText(this, "Selected location does not have coordinates.", Toast.LENGTH_SHORT).show(); } if (binding.etSearchLocation.hasFocus()) { new Handler(Looper.getMainLooper()).postDelayed(() -> isUserInteractingWithSearch = true, 50); } } private void hideKeyboard() { InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE); View view = getCurrentFocus(); if (view == null) { view = new View(this); } imm.hideSoftInputFromWindow(view.getWindowToken(), 0); if (binding.etSearchLocation != null) { binding.etSearchLocation.clearFocus(); } } private void checkAndRequestPickerPermissions(boolean centerOnMapIfGranted) { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) { ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.ACCESS_COARSE_LOCATION}, REQUEST_LOCATION_PERMISSION_PICKER); } else { if (mMap != null) { try { mMap.setMyLocationEnabled(true); mMap.getUiSettings().setMyLocationButtonEnabled(false); } catch (SecurityException e) { Log.e(TAG, "SecurityException on setMyLocationEnabled: " + e.getMessage()); } if (centerOnMapIfGranted) { goToMyCurrentLocation(); } } } } private void goToMyCurrentLocation() { if (mMap == null) return; if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED) { try { mMap.setMyLocationEnabled(true); mMap.getUiSettings().setMyLocationButtonEnabled(false); } catch (SecurityException e) { Log.e(TAG, "SecurityException: " + e.getMessage()); return; } fusedLocationClientPicker.getLastLocation() .addOnSuccessListener(this, location -> { if (location != null) { LatLng myLatLng = new LatLng(location.getLatitude(), location.getLongitude()); mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(myLatLng, 15f)); Toast.makeText(this, "Map centered on your location. Tap to select.", Toast.LENGTH_LONG).show(); } else { Toast.makeText(this, "Could not get current location.", Toast.LENGTH_SHORT).show(); } }) .addOnFailureListener(this, e -> Toast.makeText(this, "Failed to get current location.", Toast.LENGTH_SHORT).show()); } else { checkAndRequestPickerPermissions(true); } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); if (requestCode == REQUEST_LOCATION_PERMISSION_PICKER) { if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) { if (mMap != null) { try { mMap.setMyLocationEnabled(true); mMap.getUiSettings().setMyLocationButtonEnabled(false); } catch (SecurityException e) { Log.e(TAG, "Security Exception after permission grant: " + e.getMessage()); } } // Only go to current location if an initial point wasn't already set if (initialPoint == null) { goToMyCurrentLocation(); } } else { Toast.makeText(this, "Location permission denied.", Toast.LENGTH_LONG).show(); } } } public static class Helper { public static String getAddressDisplayName(Address address) { if (address == null) return "Unknown Location"; StringBuilder displayNameBuilder = new StringBuilder(); String addressLine0 = address.getAddressLine(0); if (addressLine0 != null && !addressLine0.isEmpty() && !addressLine0.matches("^-?[0-9]+\\.[0-9]+, -?[0-9]+\\.[0-9]+$")) { return addressLine0; } String featureName = address.getFeatureName(); if (featureName != null && !featureName.isEmpty() && !featureName.matches("\\d+.*")) { displayNameBuilder.append(featureName); } String thoroughfare = address.getThoroughfare(); if (thoroughfare != null && !thoroughfare.isEmpty()) { if (displayNameBuilder.length() > 0 && !displayNameBuilder.toString().contains(thoroughfare)) displayNameBuilder.append(", "); if (!displayNameBuilder.toString().contains(thoroughfare)) displayNameBuilder.append(thoroughfare); String subThoroughfare = address.getSubThoroughfare(); if (subThoroughfare != null && !subThoroughfare.isEmpty()) displayNameBuilder.append(" ").append(subThoroughfare); } String subLocality = address.getSubLocality(); if (subLocality != null && !subLocality.isEmpty()) { if (displayNameBuilder.length() > 0 && !displayNameBuilder.toString().contains(subLocality)) displayNameBuilder.append(", "); if (!displayNameBuilder.toString().contains(subLocality)) displayNameBuilder.append(subLocality); } String locality = address.getLocality(); if (locality != null && !locality.isEmpty()) { if (displayNameBuilder.length() > 0 && !displayNameBuilder.toString().contains(locality)) displayNameBuilder.append(", "); if (!displayNameBuilder.toString().contains(locality)) displayNameBuilder.append(locality); } String adminArea = address.getAdminArea(); if (adminArea != null && !adminArea.isEmpty()) { if (displayNameBuilder.length() > 0 && !displayNameBuilder.toString().contains(adminArea)) displayNameBuilder.append(", "); if (!displayNameBuilder.toString().contains(adminArea) && (locality == null || !locality.equalsIgnoreCase(adminArea))) { displayNameBuilder.append(adminArea); } } String countryName = address.getCountryName(); if (countryName != null && !countryName.isEmpty()) { if (displayNameBuilder.length() > 0 && !displayNameBuilder.toString().contains(countryName)) displayNameBuilder.append(", "); if (!displayNameBuilder.toString().contains(countryName)) displayNameBuilder.append(countryName); } if (displayNameBuilder.length() == 0) { if (address.hasLatitude() && address.hasLongitude()) { return "Location (Lat: " + String.format(Locale.US, "%.4f", address.getLatitude()) + ", Lon: " + String.format(Locale.US, "%.4f", address.getLongitude()) + ")"; } else { return "Unknown Location"; } } return displayNameBuilder.toString(); } } @Override protected void onDestroy() { super.onDestroy(); searchDebounceHandler.removeCallbacksAndMessages(null); } }
```

# app\src\main\java\com\example\alayaapp\MapsActivity.java

```java
package com.example.alayaapp; import android.Manifest; import android.content.Intent; import android.content.SharedPreferences; import android.content.pm.ApplicationInfo; import android.content.pm.PackageManager; import android.graphics.Color; import android.location.Location; import android.os.Bundle; import android.util.Log; import android.view.View; import android.view.ViewGroup; import android.widget.Button; import android.widget.ImageButton; import android.widget.ImageView; import android.widget.LinearLayout; import android.widget.TextView; import android.widget.Toast; import androidx.activity.EdgeToEdge; import androidx.annotation.NonNull; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import androidx.cardview.widget.CardView; import androidx.core.app.ActivityCompat; import androidx.core.content.ContextCompat; import androidx.core.graphics.Insets; import androidx.core.view.ViewCompat; import androidx.core.view.WindowInsetsCompat; import androidx.lifecycle.ViewModelProvider; import com.example.alayaapp.databinding.ActivityMapsBinding; import com.google.android.gms.location.FusedLocationProviderClient; import com.google.android.gms.location.LocationServices; import com.google.android.gms.maps.CameraUpdate; import com.google.android.gms.maps.CameraUpdateFactory; import com.google.android.gms.maps.GoogleMap; import com.google.android.gms.maps.OnMapReadyCallback; import com.google.android.gms.maps.SupportMapFragment; import com.google.android.gms.maps.model.BitmapDescriptorFactory; import com.google.android.gms.maps.model.Dash; import com.google.android.gms.maps.model.Gap; import com.google.android.gms.maps.model.LatLng; import com.google.android.gms.maps.model.LatLngBounds; import com.google.android.gms.maps.model.Marker; import com.google.android.gms.maps.model.MarkerOptions; import com.google.android.gms.maps.model.Polyline; import com.google.android.gms.maps.model.PolylineOptions; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.GeoPoint; import com.google.firebase.firestore.QueryDocumentSnapshot; import com.google.gson.Gson; import com.google.gson.GsonBuilder; import java.text.ParseException; import java.text.SimpleDateFormat; import java.util.ArrayList; import java.util.Arrays; import java.util.Calendar; import java.util.HashMap; import java.util.List; import java.util.Locale; import java.util.Map; public class MapsActivity extends AppCompatActivity implements OnMapReadyCallback, GoogleMap.OnInfoWindowClickListener { private static final String TAG = "MapsActivity"; private ActivityMapsBinding binding; private GoogleMap mMap; private FirebaseFirestore db; private FusedLocationProviderClient fusedLocationClient; final int CURRENT_ITEM_ID = R.id.navigation_map; private static final int LOCATION_PERMISSION_REQUEST_CODE = 101; public static final String EXTRA_TARGET_LATITUDE = "com.example.alayaapp.TARGET_LATITUDE"; public static final String EXTRA_TARGET_LONGITUDE = "com.example.alayaapp.TARGET_LONGITUDE"; public static final String EXTRA_TARGET_NAME = "com.example.alayaapp.TARGET_NAME"; public static final String EXTRA_DRAW_ROUTE = "com.example.alayaapp.DRAW_ROUTE"; private static final String PREFS_NAME = "AlayaAppPrefs"; private static final String KEY_ACTIVE_ITINERARY_STATE = "active_itinerary_state"; private static final String KEY_LOCATION_MODE = "location_mode"; private static final String KEY_MANUAL_LATITUDE = "manual_latitude"; private static final String KEY_MANUAL_LONGITUDE = "manual_longitude"; private static final String KEY_MANUAL_LOCATION_NAME = "manual_location_name"; private static final double BAGUIO_REGION_MIN_LAT = 16.35; private static final double BAGUIO_REGION_MAX_LAT = 16.50; private static final double BAGUIO_REGION_MIN_LON = 120.55; private static final double BAGUIO_REGION_MAX_LON = 120.65; private String currentLocationMode = "auto"; private LatLng manualHomeLocation = null; private String manualHomeLocationName = "Manually Set Location"; private HashMap<String, Place> markerPlaceMap; private CustomInfoWindowAdapter customInfoWindowAdapter; private Marker manualHomeMarker = null; private Marker routeOriginMarker; private Marker routeDestinationMarker; private Polyline currentRoutePolyline; private LatLng pendingRouteDestLatLng; private String pendingRouteDestName; private String pendingRouteDestDocId; private boolean awaitingPermissionsForRoute = false; private String directionsApiKey; private String apiTravelMode = "walking"; private String selectedUIMode = "walk"; private LatLng currentRouteOriginLatLng; private String currentRouteOriginName; private LinearLayout transportModeContainer; private LinearLayout btnModeWalkCard, btnModeTaxiCard, btnModeTwoWheelsCard; private ImageView ivModeWalk, ivModeTaxi, ivModeTwoWheels; private TextView tvModeWalk, tvModeTaxi, tvModeTwoWheels; private ImageButton btnShowItineraryRoute; private boolean isShowingSegmentedRoute = false; private List<ItineraryItem> fullItinerary = new ArrayList<>(); private int currentItinerarySegmentIndex = -1; private LatLng userStartLocationForItinerary; private String userStartLocationNameForItinerary; private SharedPreferences sharedPreferences; private Gson gson; private CardView routeInfoPane; private TextView tvRouteEta, tvRouteDistance, tvRouteItineraryNumber, tvRouteDestinationName; private Button btnRouteNext, btnRoutePrevious; private MapsViewModel mapsViewModel; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); EdgeToEdge.enable(this); mapsViewModel = new ViewModelProvider(this).get(MapsViewModel.class); try { binding = ActivityMapsBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); } catch (Exception e) { Log.e(TAG, "Error inflating layout: " + e.getMessage(), e); Toast.makeText(this, "Error loading page.", Toast.LENGTH_LONG).show(); finish(); return; } ViewCompat.setOnApplyWindowInsetsListener(binding.mainMapsCoordinatorLayout, (v, insets) -> { Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars()); v.setPadding(systemBars.left, systemBars.top, systemBars.right, 0); if (binding.bottomNavigationMapsPage != null) { ViewGroup.MarginLayoutParams params = (ViewGroup.MarginLayoutParams) binding.bottomNavigationMapsPage.getLayoutParams(); params.bottomMargin = systemBars.bottom; binding.bottomNavigationMapsPage.setLayoutParams(params); } return insets; }); markerPlaceMap = new HashMap<>(); db = FirebaseFirestore.getInstance(); fusedLocationClient = LocationServices.getFusedLocationProviderClient(this); sharedPreferences = getSharedPreferences(PREFS_NAME, MODE_PRIVATE); gson = new GsonBuilder().create(); try { ApplicationInfo ai = getPackageManager().getApplicationInfo(getPackageName(), PackageManager.GET_META_DATA); Bundle bundle = ai.metaData; directionsApiKey = bundle.getString("com.google.android.geo.API_KEY"); if (directionsApiKey == null || directionsApiKey.isEmpty()) { Log.e(TAG, "Directions API Key not found in AndroidManifest.xml"); Toast.makeText(this, "API Key for directions is missing.", Toast.LENGTH_LONG).show(); } } catch (PackageManager.NameNotFoundException e) { Log.e(TAG, "Failed to load meta-data, NameNotFound: " + e.getMessage()); } catch (NullPointerException e) { Log.e(TAG, "Failed to load meta-data, NullPointer: " + e.getMessage()); } transportModeContainer = binding.transportModeSelectorContainer; btnModeWalkCard = binding.btnModeWalkCard; ivModeWalk = binding.ivModeWalk; tvModeWalk = binding.tvModeWalk; btnModeTaxiCard = binding.btnModeTaxiCard; ivModeTaxi = binding.ivModeTaxi; tvModeTaxi = binding.tvModeTaxi; btnModeTwoWheelsCard = binding.btnModeTwoWheelsCard; ivModeTwoWheels = binding.ivModeTwoWheels; tvModeTwoWheels = binding.tvModeTwoWheels; routeInfoPane = binding.routeInfoPane; tvRouteEta = binding.tvRouteEta; tvRouteDistance = binding.tvRouteDistance; tvRouteItineraryNumber = binding.tvRouteItineraryNumber; tvRouteDestinationName = binding.tvRouteDestinationName; btnRouteNext = binding.btnRouteNext; btnRoutePrevious = binding.btnRoutePrevious; btnShowItineraryRoute = binding.btnShowItineraryRoute; btnRouteNext.setOnClickListener(v -> displayNextItinerarySegment()); btnRoutePrevious.setOnClickListener(v -> displayPreviousItinerarySegment()); btnShowItineraryRoute.setOnClickListener(v -> { if (isShowingSegmentedRoute) { hideSegmentedRouteView(); } else { startSegmentedRouteView(); } }); setupTransportModeButtons(); setupBottomNavigation(); SupportMapFragment mapFragment = (SupportMapFragment) getSupportFragmentManager() .findFragmentById(R.id.map_fragment_container); if (mapFragment != null) { mapFragment.getMapAsync(this); } else { Log.e(TAG, "SupportMapFragment not found!"); Toast.makeText(this, "Error: Map Fragment not found.", Toast.LENGTH_LONG).show(); } binding.fabMyLocation.setOnClickListener(v -> { if (mMap != null) { if ("auto".equals(currentLocationMode)) { centerOnActualGPSLocation(true); } else if (manualHomeLocation != null) { mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(manualHomeLocation, 15f)); Toast.makeText(this, "Centering on your manually set home location.", Toast.LENGTH_SHORT).show(); } else { centerOnActualGPSLocation(true); Toast.makeText(this, "Home location not set. Attempting to use current GPS.", Toast.LENGTH_SHORT).show(); } } }); mapsViewModel.getDirectionsResult().observe(this, result -> { if (result != null && result.polylinePoints != null && !result.polylinePoints.isEmpty()) { drawActualRoute(result); } else { String failedMode = selectedUIMode.equals("two_wheels") ? "2-Wheels" : selectedUIMode.substring(0, 1).toUpperCase() + selectedUIMode.substring(1); Toast.makeText(this, "Could not calculate directions for " + failedMode + ".", Toast.LENGTH_LONG).show(); if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Failed to get directions for " + failedMode + ". Showing straight line."); } if (routeOriginMarker != null && routeDestinationMarker != null) { drawStraightLineFallback( routeOriginMarker.getPosition(), routeOriginMarker.getTitle(), routeDestinationMarker.getPosition(), routeDestinationMarker.getTitle(), pendingRouteDestDocId ); } } }); } private void initiateRouteDrawing(LatLng originLatLng, String originName, LatLng destLatLng, String destName, String destDocId) { if (mMap == null || originLatLng == null || destLatLng == null) { Log.e(TAG, "Cannot draw route: Map or LatLngs are null."); Toast.makeText(this, "Error preparing route.", Toast.LENGTH_SHORT).show(); transportModeContainer.setVisibility(View.GONE); return; } if (directionsApiKey == null || directionsApiKey.isEmpty()) { Toast.makeText(this, "API Key for directions is missing. Cannot draw road route.", Toast.LENGTH_LONG).show(); Log.e(TAG, "Directions API key is null or empty. Drawing straight line fallback."); drawStraightLineFallback(originLatLng, originName, destLatLng, destName, destDocId); transportModeContainer.setVisibility(View.VISIBLE); return; } clearRouteElements(false); this.currentRouteOriginLatLng = originLatLng; this.currentRouteOriginName = originName; transportModeContainer.setVisibility(View.VISIBLE); updateTransportModeUI(); routeOriginMarker = mMap.addMarker(new MarkerOptions() .position(originLatLng).title(originName) .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_GREEN))); routeDestinationMarker = mMap.addMarker(new MarkerOptions() .position(destLatLng).title(destName) .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_RED))); String modeDisplayName = selectedUIMode.equals("two_wheels") ? "2-Wheels" : selectedUIMode.substring(0, 1).toUpperCase() + selectedUIMode.substring(1); if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Calculating " + modeDisplayName + " route from " + originName + " to " + destName + "..."); } mapsViewModel.fetchDirections(originLatLng, destLatLng, directionsApiKey, this.apiTravelMode); } public void drawActualRoute(MapsViewModel.DirectionsResult directionsResult) { if (mMap == null || directionsResult == null || directionsResult.polylinePoints == null || directionsResult.polylinePoints.isEmpty()) { String failedModeDisplay = selectedUIMode.equals("two_wheels") ? "2-Wheels" : selectedUIMode.substring(0, 1).toUpperCase() + selectedUIMode.substring(1); Toast.makeText(this, "Could not draw " + failedModeDisplay + " route.", Toast.LENGTH_SHORT).show(); if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Failed to calculate " + failedModeDisplay + " route path."); } if (routeOriginMarker != null && routeDestinationMarker != null) { LatLngBounds.Builder builder = new LatLngBounds.Builder(); builder.include(routeOriginMarker.getPosition()); builder.include(routeDestinationMarker.getPosition()); int padding = (int) (getResources().getDisplayMetrics().widthPixels * 0.20); try { mMap.animateCamera(CameraUpdateFactory.newLatLngBounds(builder.build(), padding)); } catch (Exception e) { Log.e(TAG, "Error animating camera to fallback bounds: " + e.getMessage()); } } return; } if (currentRoutePolyline != null) { currentRoutePolyline.remove(); } PolylineOptions polylineOptions = new PolylineOptions() .addAll(directionsResult.polylinePoints) .color(Color.parseColor("#3F51B5")) .width(15); currentRoutePolyline = mMap.addPolyline(polylineOptions); if (isShowingSegmentedRoute) { tvRouteEta.setText(directionsResult.durationText); tvRouteDistance.setText("(" + directionsResult.distanceText + ")"); } if (directionsResult.routeBounds != null) { int padding = (int) (getResources().getDisplayMetrics().widthPixels * 0.15); try { mMap.animateCamera(CameraUpdateFactory.newLatLngBounds(directionsResult.routeBounds, padding)); } catch (IllegalStateException e) { Log.e(TAG, "Cannot animate camera to route bounds yet: " + e.getMessage()); if (routeDestinationMarker != null) { mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(routeDestinationMarker.getPosition(), 12f)); } } } else if (routeOriginMarker != null && routeDestinationMarker != null) { LatLngBounds.Builder builder = new LatLngBounds.Builder(); builder.include(routeOriginMarker.getPosition()); builder.include(routeDestinationMarker.getPosition()); int padding = (int) (getResources().getDisplayMetrics().widthPixels * 0.20); try { mMap.animateCamera(CameraUpdateFactory.newLatLngBounds(builder.build(), padding)); } catch (Exception e) { Log.e(TAG, "Error animating camera to origin/dest bounds: " + e.getMessage()); } } String modeDisplayName = selectedUIMode.equals("two_wheels") ? "2-Wheels" : selectedUIMode.substring(0, 1).toUpperCase() + selectedUIMode.substring(1); if (binding.tvDirectionText != null && routeOriginMarker != null && routeDestinationMarker != null) { binding.tvDirectionText.setText(modeDisplayName + " Route: " + routeOriginMarker.getTitle() + " to " + routeDestinationMarker.getTitle()); } else if (binding.tvDirectionText != null) { binding.tvDirectionText.setText(modeDisplayName + " route calculated."); } } private void displayItinerarySegment(int index) { if (!isShowingSegmentedRoute || fullItinerary.isEmpty() || index < 0 || index >= fullItinerary.size()) { Log.e(TAG, "Cannot display segment, invalid state or index: " + index); hideSegmentedRouteView(); return; } clearRouteElements(false); LatLng origin, destination; String originName, destinationName; ItineraryItem currentStop = fullItinerary.get(index); destination = new LatLng(currentStop.getCoordinates().getLatitude(), currentStop.getCoordinates().getLongitude()); destinationName = currentStop.getActivity(); if (index == 0) { origin = userStartLocationForItinerary; originName = userStartLocationNameForItinerary; } else { ItineraryItem previousStop = fullItinerary.get(index - 1); origin = new LatLng(previousStop.getCoordinates().getLatitude(), previousStop.getCoordinates().getLongitude()); originName = previousStop.getActivity(); } tvRouteDestinationName.setText(destinationName); tvRouteItineraryNumber.setText(getOrdinal(index + 1) + " location"); tvRouteEta.setText("..."); tvRouteDistance.setText("..."); routeOriginMarker = mMap.addMarker(new MarkerOptions().position(origin).title(originName).icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_GREEN))); routeDestinationMarker = mMap.addMarker(new MarkerOptions().position(destination).title(destinationName).icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_RED))); mapsViewModel.fetchDirections(origin, destination, directionsApiKey, apiTravelMode); btnRouteNext.setEnabled(index < fullItinerary.size() - 1); btnRoutePrevious.setEnabled(index > 0); } private void setupTransportModeButtons() { btnModeWalkCard.setOnClickListener(v -> selectTravelMode("walk")); btnModeTaxiCard.setOnClickListener(v -> selectTravelMode("taxi")); btnModeTwoWheelsCard.setOnClickListener(v -> selectTravelMode("two_wheels")); updateTransportModeUI(); } private void selectTravelMode(String uiMode) { String newApiMode; switch (uiMode) { case "taxi": case "two_wheels": newApiMode = "driving"; break; case "walk": default: newApiMode = "walking"; break; } if (this.selectedUIMode.equals(uiMode) && (currentRoutePolyline != null || isShowingSegmentedRoute)) { Log.d(TAG, "UI Mode " + uiMode + " already selected and route shown."); return; } this.selectedUIMode = uiMode; this.apiTravelMode = newApiMode; updateTransportModeUI(); if (isShowingSegmentedRoute) { displayItinerarySegment(currentItinerarySegmentIndex); } else if (currentRouteOriginLatLng != null && pendingRouteDestLatLng != null) { Log.d(TAG, "Redrawing route for UI mode: " + this.selectedUIMode + ", API mode: " + this.apiTravelMode); if (currentRoutePolyline != null) { currentRoutePolyline.remove(); currentRoutePolyline = null; } initiateRouteDrawing(currentRouteOriginLatLng, currentRouteOriginName, pendingRouteDestLatLng, pendingRouteDestName, pendingRouteDestDocId); } else { Log.d(TAG, "No active route to redraw for mode: " + this.selectedUIMode); } } /** * CORRECTED: This method now correctly loads the itinerary and its true start point from SharedPreferences. */ private void startSegmentedRouteView() { String stateJson = sharedPreferences.getString(KEY_ACTIVE_ITINERARY_STATE, null); if (stateJson == null) { Toast.makeText(this, "No itinerary plan found. Please create one in the Itineraries tab first.", Toast.LENGTH_LONG).show(); return; } ItineraryState savedState; try { savedState = gson.fromJson(stateJson, ItineraryState.class); } catch (Exception e) { Log.e(TAG, "Error parsing saved itinerary state", e); Toast.makeText(this, "Could not read the saved itinerary plan.", Toast.LENGTH_LONG).show(); return; } if (savedState == null || savedState.getItineraryItems() == null || savedState.getItineraryItems().isEmpty()) { Toast.makeText(this, "Your current itinerary is empty. Please create a new plan.", Toast.LENGTH_LONG).show(); return; } // Success! We have a valid, saved itinerary. fullItinerary = savedState.getItineraryItems(); // THIS IS THE CORRECTION: Get the start location and name from the state object itself. ItineraryItem firstItem = savedState.getItineraryItems().get(0); userStartLocationForItinerary = new LatLng(firstItem.getCoordinates().getLatitude(), firstItem.getCoordinates().getLongitude()); userStartLocationNameForItinerary = savedState.getLocationName(); isShowingSegmentedRoute = true; currentItinerarySegmentIndex = 0; displayItinerarySegment(currentItinerarySegmentIndex); transportModeContainer.setVisibility(View.VISIBLE); routeInfoPane.setVisibility(View.VISIBLE); Toast.makeText(this, "Showing route for your current itinerary!", Toast.LENGTH_SHORT).show(); } private void displayNextItinerarySegment() { if (currentItinerarySegmentIndex < fullItinerary.size() - 1) { currentItinerarySegmentIndex++; displayItinerarySegment(currentItinerarySegmentIndex); } } private void displayPreviousItinerarySegment() { if (currentItinerarySegmentIndex > 0) { currentItinerarySegmentIndex--; displayItinerarySegment(currentItinerarySegmentIndex); } } private void hideSegmentedRouteView() { isShowingSegmentedRoute = false; currentItinerarySegmentIndex = -1; fullItinerary.clear(); routeInfoPane.setVisibility(View.GONE); transportModeContainer.setVisibility(View.GONE); clearRouteElements(true); } private String getOrdinal(int number) { if (number >= 11 && number <= 13) { return number + "th"; } switch (number % 10) { case 1: return number + "st"; case 2: return number + "nd"; case 3: return number + "rd"; default: return number + "th"; } } private void updateTransportModeUI() { ImageView[] icons = {ivModeWalk, ivModeTaxi, ivModeTwoWheels}; TextView[] texts = {tvModeWalk, tvModeTaxi, tvModeTwoWheels}; String[] modes = {"walk", "taxi", "two_wheels"}; for (int i = 0; i < modes.length; i++) { boolean isSelected = modes[i].equals(selectedUIMode); icons[i].setColorFilter(ContextCompat.getColor(this, isSelected ? R.color.colorPrimary : R.color.textSecondary), android.graphics.PorterDuff.Mode.SRC_IN); texts[i].setTextColor(ContextCompat.getColor(this, isSelected ? R.color.colorPrimary : R.color.textSecondary)); } } private void loadHomeLocationPreference() { SharedPreferences sharedPreferences = getSharedPreferences(PREFS_NAME, MODE_PRIVATE); currentLocationMode = sharedPreferences.getString(KEY_LOCATION_MODE, "auto"); if ("manual".equals(currentLocationMode)) { double lat = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LATITUDE, Double.doubleToRawLongBits(0.0))); double lon = Double.longBitsToDouble(sharedPreferences.getLong(KEY_MANUAL_LONGITUDE, Double.doubleToRawLongBits(0.0))); manualHomeLocationName = sharedPreferences.getString(KEY_MANUAL_LOCATION_NAME, "Manually Set Location"); if (lat != 0.0 && lon != 0.0) { manualHomeLocation = new LatLng(lat, lon); } else { manualHomeLocation = null; } } else { manualHomeLocation = null; } } @Override public void onMapReady(@NonNull GoogleMap googleMap) { mMap = googleMap; loadHomeLocationPreference(); customInfoWindowAdapter = new CustomInfoWindowAdapter(MapsActivity.this, markerPlaceMap); mMap.setInfoWindowAdapter(customInfoWindowAdapter); mMap.setOnInfoWindowClickListener(this); clearRouteElements(true); Intent intent = getIntent(); boolean drawRouteFlag = intent.getBooleanExtra(EXTRA_DRAW_ROUTE, false); if (intent.hasExtra(EXTRA_TARGET_LATITUDE) && intent.hasExtra(EXTRA_TARGET_LONGITUDE)) { pendingRouteDestLatLng = new LatLng( intent.getDoubleExtra(EXTRA_TARGET_LATITUDE, 0), intent.getDoubleExtra(EXTRA_TARGET_LONGITUDE, 0) ); pendingRouteDestName = intent.getStringExtra(EXTRA_TARGET_NAME); pendingRouteDestDocId = intent.getStringExtra(PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID); } if (drawRouteFlag && pendingRouteDestLatLng != null) { transportModeContainer.setVisibility(View.VISIBLE); selectTravelMode("walk"); binding.tvDirectionText.setText("Preparing route to " + (pendingRouteDestName != null ? pendingRouteDestName : "destination") + "..."); if ("auto".equals(currentLocationMode)) { fetchCurrentLocationForRoute(pendingRouteDestLatLng, pendingRouteDestName, pendingRouteDestDocId); } else if (manualHomeLocation != null) { if (!isLocationInAllowedRegion(manualHomeLocation.latitude, manualHomeLocation.longitude)) { redirectToHomeWithDialog(); return; } currentRouteOriginLatLng = manualHomeLocation; currentRouteOriginName = manualHomeLocationName; initiateRouteDrawing(manualHomeLocation, manualHomeLocationName, pendingRouteDestLatLng, pendingRouteDestName, pendingRouteDestDocId); } else { Toast.makeText(this, "Your home location isn't set. Cannot draw route.", Toast.LENGTH_LONG).show(); centerMapOnLocation(pendingRouteDestLatLng, pendingRouteDestName, 15f); transportModeContainer.setVisibility(View.GONE); } } else if (pendingRouteDestLatLng != null) { transportModeContainer.setVisibility(View.GONE); centerMapOnLocation(pendingRouteDestLatLng, pendingRouteDestName, 15f); } else { transportModeContainer.setVisibility(View.GONE); if ("auto".equals(currentLocationMode)) { centerOnActualGPSLocation(false); } else if (manualHomeLocation != null) { if (!isLocationInAllowedRegion(manualHomeLocation.latitude, manualHomeLocation.longitude)) { redirectToHomeWithDialog(); return; } addManualHomeMarkerToMap(); mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(manualHomeLocation, 15f)); if (binding.tvDirectionText != null) binding.tvDirectionText.setText(manualHomeLocationName); } else { LatLng philippines = new LatLng(12.8797, 121.7740); mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(philippines, 6f)); if (binding.tvDirectionText != null) binding.tvDirectionText.setText("Explore the map."); } } } private void addManualHomeMarkerToMap() { if (mMap == null || manualHomeLocation == null) return; if (manualHomeMarker != null && manualHomeMarker.getId() != null) { markerPlaceMap.remove(manualHomeMarker.getId()); manualHomeMarker.remove(); } manualHomeMarker = mMap.addMarker(new MarkerOptions() .position(manualHomeLocation) .title(manualHomeLocationName) .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE))); Place manualPlaceStub = new Place(); manualPlaceStub.setName(manualHomeLocationName); manualPlaceStub.setCategory("Your Set Location"); if (manualHomeMarker != null) { markerPlaceMap.put(manualHomeMarker.getId(), manualPlaceStub); } } private void centerMapOnLocation(LatLng location, String name, float zoom) { if (mMap == null || location == null) return; mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(location, zoom)); if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Showing: " + (name != null ? name : "Selected Location")); } } private void fetchCurrentLocationForRoute(final LatLng destLatLng, final String destName, final String destDocId) { if (mMap == null) return; if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED) { try { mMap.setMyLocationEnabled(true); mMap.getUiSettings().setMyLocationButtonEnabled(false); } catch (SecurityException e) { Log.e(TAG, "Security Exception enabling my location layer: " + e.getMessage()); } binding.tvDirectionText.setText("Fetching current location for route..."); fusedLocationClient.getLastLocation() .addOnSuccessListener(this, location -> { if (location != null) { if (!isLocationInAllowedRegion(location.getLatitude(), location.getLongitude())) { redirectToHomeWithDialog(); return; } currentRouteOriginLatLng = new LatLng(location.getLatitude(), location.getLongitude()); currentRouteOriginName = "Your Current Location"; initiateRouteDrawing(currentRouteOriginLatLng, currentRouteOriginName, destLatLng, destName, destDocId); } else { Toast.makeText(MapsActivity.this, "Could not get current location. Please ensure GPS is enabled.", Toast.LENGTH_LONG).show(); centerMapOnLocation(destLatLng, destName, 15f); transportModeContainer.setVisibility(View.GONE); } }) .addOnFailureListener(this, e -> { Log.e(TAG, "Failed to get current location for route.", e); Toast.makeText(MapsActivity.this, "Failed to get current location. Showing destination only.", Toast.LENGTH_LONG).show(); centerMapOnLocation(destLatLng, destName, 15f); transportModeContainer.setVisibility(View.GONE); }); } else { pendingRouteDestLatLng = destLatLng; pendingRouteDestName = destName; pendingRouteDestDocId = destDocId; awaitingPermissionsForRoute = true; ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, LOCATION_PERMISSION_REQUEST_CODE); } } protected void clearRouteElements(boolean restorePois) { if (currentRoutePolyline != null) { currentRoutePolyline.remove(); currentRoutePolyline = null; } if (routeOriginMarker != null) { routeOriginMarker.remove(); routeOriginMarker = null; } if (routeDestinationMarker != null) { routeDestinationMarker.remove(); routeDestinationMarker = null; } if (restorePois) { mMap.clear(); markerPlaceMap.clear(); addManualHomeMarkerToMap(); fetchAndDisplayAllPois(); binding.tvDirectionText.setText("Explore the map."); } } private void drawStraightLineFallback(LatLng originLatLng, String originName, LatLng destLatLng, String destName, String destDocId) { Log.w(TAG, "Drawing straight line as fallback for route from " + originName + " to " + destName); if (mMap == null || originLatLng == null || destLatLng == null) return; if (currentRoutePolyline != null) { currentRoutePolyline.remove(); } PolylineOptions polylineOptions = new PolylineOptions() .add(originLatLng, destLatLng) .color(Color.parseColor("#FFA500")) .width(10) .pattern(Arrays.asList(new Dash(20), new Gap(10))); currentRoutePolyline = mMap.addPolyline(polylineOptions); LatLngBounds.Builder builder = new LatLngBounds.Builder(); builder.include(originLatLng); builder.include(destLatLng); LatLngBounds bounds = builder.build(); int padding = (int) (getResources().getDisplayMetrics().widthPixels * 0.20); try { CameraUpdate cu = CameraUpdateFactory.newLatLngBounds(bounds, padding); mMap.animateCamera(cu); } catch (IllegalStateException e) { Log.e(TAG, "IllegalStateException for newLatLngBounds (Fallback). Map not ready.", e); mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(destLatLng, 12f)); } if (binding.tvDirectionText != null) { binding.tvDirectionText.setText("Showing straight line to " + destName + " (Directions API unavailable)"); } } private void fetchAndDisplayAllPois() { db.collection("places") .get() .addOnCompleteListener(task -> { if (task.isSuccessful() && task.getResult() != null) { if (mMap == null) return; for (QueryDocumentSnapshot document : task.getResult()) { Place place = document.toObject(Place.class); if (place != null && place.getLatitude() != null && place.getLongitude() != null) { place.setDocumentId(document.getId()); LatLng placeLocation = new LatLng(place.getLatitude(), place.getLongitude()); MarkerOptions markerOptions = new MarkerOptions() .position(placeLocation) .title(place.getName()); Marker marker = mMap.addMarker(markerOptions); if (marker != null && marker.getId() != null) { markerPlaceMap.put(marker.getId(), place); } } } if (binding.tvDirectionText != null) { String currentText = binding.tvDirectionText.getText().toString(); if (currentText.contains("Loading map...") || currentText.equals("Explore the map.") || (!currentText.toLowerCase().contains("route") && !currentText.toLowerCase().contains("showing:"))) { binding.tvDirectionText.setText("Places loaded. Tap markers for details."); } } } else { Log.w(TAG, "Error getting POI documents.", task.getException()); if (binding.tvDirectionText != null && !binding.tvDirectionText.getText().toString().toLowerCase().contains("route")) { binding.tvDirectionText.setText("Could not load points of interest."); } Toast.makeText(MapsActivity.this, "Failed to load points of interest.", Toast.LENGTH_SHORT).show(); } }); } @Override public void onInfoWindowClick(@NonNull Marker marker) { Place place = markerPlaceMap.get(marker.getId()); if (place != null && place.getDocumentId() != null && !place.getDocumentId().isEmpty()) { Intent intent = new Intent(MapsActivity.this, PlaceDetailsActivity.class); intent.putExtra(PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID, place.getDocumentId()); startActivity(intent); } else if (place != null) { Toast.makeText(this, "Details for: " + place.getName(), Toast.LENGTH_SHORT).show(); } else { Toast.makeText(this, "No further details available.", Toast.LENGTH_SHORT).show(); Log.d(TAG, "Info window clicked, but no Place data for marker: " + marker.getTitle() + " ID: " + marker.getId()); } } private void centerOnActualGPSLocation(boolean animate) { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED) { if (mMap != null) { try { mMap.setMyLocationEnabled(true); mMap.getUiSettings().setMyLocationButtonEnabled(false); } catch (SecurityException e) { Log.e(TAG, "SecurityException on setMyLocationEnabled: " + e.getMessage()); } fusedLocationClient.getLastLocation() .addOnSuccessListener(this, location -> { if (location != null) { if (!isLocationInAllowedRegion(location.getLatitude(), location.getLongitude())) { redirectToHomeWithDialog(); return; } LatLng myLocation = new LatLng(location.getLatitude(), location.getLongitude()); if (animate) { mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(myLocation, 15f)); } else { mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(myLocation, 15f)); } if (binding.tvDirectionText != null && "auto".equals(currentLocationMode)) { boolean drawingRoute = getIntent().getBooleanExtra(EXTRA_DRAW_ROUTE, false); boolean hasTarget = getIntent().hasExtra(EXTRA_TARGET_LATITUDE); if (!drawingRoute && !hasTarget) { binding.tvDirectionText.setText("Centered on your current GPS location."); } } } else { Toast.makeText(this, "Current GPS location not available.", Toast.LENGTH_SHORT).show(); } }) .addOnFailureListener(this, e -> { Toast.makeText(this, "Failed to get current GPS location.", Toast.LENGTH_SHORT).show(); }); } } else { awaitingPermissionsForRoute = false; ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, LOCATION_PERMISSION_REQUEST_CODE); } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); if (requestCode == LOCATION_PERMISSION_REQUEST_CODE) { if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) { try { if (mMap != null) mMap.setMyLocationEnabled(true); } catch (SecurityException se) { Log.e(TAG, "Security Exception after permission grant"); } if (awaitingPermissionsForRoute && pendingRouteDestLatLng != null) { awaitingPermissionsForRoute = false; fetchCurrentLocationForRoute(pendingRouteDestLatLng, pendingRouteDestName, pendingRouteDestDocId); } else if ("auto".equals(currentLocationMode)) { centerOnActualGPSLocation(true); } } else { awaitingPermissionsForRoute = false; Toast.makeText(this, "Location permission denied.", Toast.LENGTH_LONG).show(); try { if (mMap != null) mMap.setMyLocationEnabled(false); } catch (SecurityException se) { Log.e(TAG, "SecurityException on setMyLocationEnabled(false)"); } if (pendingRouteDestLatLng != null) { centerMapOnLocation(pendingRouteDestLatLng, pendingRouteDestName, 15f); transportModeContainer.setVisibility(View.GONE); } } } } private void setupBottomNavigation() { if (binding.bottomNavigationMapsPage == null) { Log.e(TAG, "BottomNavigationView not found!"); return; } binding.bottomNavigationMapsPage.setSelectedItemId(CURRENT_ITEM_ID); binding.bottomNavigationMapsPage.setOnItemSelectedListener(item -> { int destinationItemId = item.getItemId(); if (destinationItemId == CURRENT_ITEM_ID) return true; Class<?> destinationActivityClass = null; if (destinationItemId == R.id.navigation_home) destinationActivityClass = HomeActivity.class; else if (destinationItemId == R.id.navigation_itineraries) destinationActivityClass = ItinerariesActivity.class; else if (destinationItemId == R.id.navigation_profile) destinationActivityClass = ProfileActivity.class; if (destinationActivityClass != null) { Intent intent = new Intent(MapsActivity.this, destinationActivityClass); intent.addFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT); startActivity(intent); boolean slideRightToLeft = getItemIndex(destinationItemId) > getItemIndex(CURRENT_ITEM_ID); if (slideRightToLeft) { overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); } else { overridePendingTransition(R.anim.slide_in_left, R.anim.slide_out_right); } finish(); return true; } return false; }); } private int getItemIndex(int itemId) { if (itemId == R.id.navigation_home) return 0; if (itemId == R.id.navigation_itineraries) return 1; if (itemId == R.id.navigation_map) return 2; if (itemId == R.id.navigation_profile) return 3; return -1; } @Override protected void onNewIntent(Intent intent) { super.onNewIntent(intent); setIntent(intent); if (mMap != null && mMap.getUiSettings() != null) { clearRouteElements(true); onMapReady(mMap); } } private boolean isLocationInAllowedRegion(double latitude, double longitude) { return latitude >= BAGUIO_REGION_MIN_LAT && latitude <= BAGUIO_REGION_MAX_LAT && longitude >= BAGUIO_REGION_MIN_LON && longitude <= BAGUIO_REGION_MAX_LON; } private void redirectToHomeWithDialog() { Intent intent = new Intent(MapsActivity.this, HomeActivity.class); intent.putExtra(HomeActivity.EXTRA_SHOW_OUTSIDE_REGION_DIALOG, true); intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); finish(); } }
```

# app\src\main\java\com\example\alayaapp\MapsViewModel.java

```java
package com.example.alayaapp; import android.util.Log; import androidx.lifecycle.LiveData; import androidx.lifecycle.MutableLiveData; import androidx.lifecycle.ViewModel; import com.google.android.gms.maps.model.LatLng; import com.google.android.gms.maps.model.LatLngBounds; import com.google.maps.android.PolyUtil; import org.json.JSONArray; import org.json.JSONObject; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStream; import java.io.InputStreamReader; import java.net.HttpURLConnection; import java.net.URL; import java.util.ArrayList; import java.util.List; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class MapsViewModel extends ViewModel { private static final String TAG = "MapsViewModel"; private final MutableLiveData<DirectionsResult> directionsResult = new MutableLiveData<>(); private final ExecutorService executorService = Executors.newSingleThreadExecutor(); public LiveData<DirectionsResult> getDirectionsResult() { return directionsResult; } public void fetchDirections(LatLng origin, LatLng dest, String apiKey, String travelMode) { executorService.execute(() -> { String urlString = getDirectionsUrl(origin, dest, null, apiKey, travelMode); Log.d(TAG, "Request URL: " + urlString); String jsonData = ""; try { jsonData = downloadUrl(urlString); } catch (IOException e) { Log.e(TAG, "Error downloading URL: " + e.getMessage()); directionsResult.postValue(null); // Post null on error return; } if (jsonData.isEmpty()) { Log.e(TAG, "Downloaded JSON data is empty."); directionsResult.postValue(null); return; } DirectionsResult result = parseDirections(jsonData); directionsResult.postValue(result); }); } private String getDirectionsUrl(LatLng origin, LatLng dest, List<LatLng> waypoints, String key, String modeParam) { String strOrigin = "origin=" + origin.latitude + "," + origin.longitude; String strDest = "destination=" + dest.latitude + "," + dest.longitude; String modeQueryParam = "mode=" + modeParam; String strWaypoints = ""; if (waypoints != null && !waypoints.isEmpty()) { StringBuilder sb = new StringBuilder(); sb.append("waypoints=optimize:true|"); for (int i = 0; i < waypoints.size(); i++) { LatLng point = waypoints.get(i); sb.append(point.latitude).append(",").append(point.longitude); if (i < waypoints.size() - 1) { sb.append("|"); } } strWaypoints = "&" + sb.toString(); } String parameters = strOrigin + "&" + strDest + strWaypoints + "&" + modeQueryParam; parameters += "&key=" + key; String output = "json"; return "https://maps.googleapis.com/maps/api/directions/" + output + "?" + parameters; } private String downloadUrl(String strUrl) throws IOException { String data = ""; InputStream iStream = null; HttpURLConnection urlConnection = null; try { URL url = new URL(strUrl); urlConnection = (HttpURLConnection) url.openConnection(); urlConnection.connect(); iStream = urlConnection.getInputStream(); BufferedReader br = new BufferedReader(new InputStreamReader(iStream)); StringBuilder sb = new StringBuilder(); String line; while ((line = br.readLine()) != null) { sb.append(line); } data = sb.toString(); br.close(); } catch (Exception e) { Log.e(TAG, "Exception downloading URL: " + e.toString()); throw new IOException("Error downloading URL", e); } finally { if (iStream != null) { try { iStream.close(); } catch (IOException e) { /* ignore */ } } if (urlConnection != null) { urlConnection.disconnect(); } } return data; } private DirectionsResult parseDirections(String jsonData) { List<LatLng> polylinePoints = new ArrayList<>(); LatLngBounds routeBounds = null; String duration = ""; String distance = ""; try { JSONObject jsonObject = new JSONObject(jsonData); String status = jsonObject.optString("status"); if (!"OK".equals(status)) { Log.e(TAG, "Directions API non-OK status: " + status + " - " + jsonObject.optString("error_message")); return null; } JSONArray routesArray = jsonObject.getJSONArray("routes"); if (routesArray.length() > 0) { JSONObject route = routesArray.getJSONObject(0); JSONObject overviewPolyline = route.getJSONObject("overview_polyline"); String encodedPolyline = overviewPolyline.getString("points"); polylinePoints = PolyUtil.decode(encodedPolyline); JSONObject boundsJson = route.getJSONObject("bounds"); JSONObject northeastJson = boundsJson.getJSONObject("northeast"); JSONObject southwestJson = boundsJson.getJSONObject("southwest"); LatLng northeast = new LatLng(northeastJson.getDouble("lat"), northeastJson.getDouble("lng")); LatLng southwest = new LatLng(southwestJson.getDouble("lat"), southwestJson.getDouble("lng")); routeBounds = new LatLngBounds(southwest, northeast); if (route.has("legs")) { JSONArray legs = route.getJSONArray("legs"); if (legs.length() > 0) { duration = legs.getJSONObject(0).getJSONObject("duration").getString("text"); distance = legs.getJSONObject(0).getJSONObject("distance").getString("text"); } } } } catch (Exception e) { Log.e(TAG, "Error parsing directions JSON: " + e.getMessage()); return null; } if (polylinePoints.isEmpty() && jsonData.contains("\"status\" : \"OK\"") && jsonData.contains("\"routes\" : [ ]")) { Log.w(TAG, "Polyline points are empty even though status was OK. This implies no route for the mode (ZERO_RESULTS)."); return null; } return new DirectionsResult(polylinePoints, routeBounds, duration, distance); } // Public inner class to hold the result public static class DirectionsResult { public final List<LatLng> polylinePoints; public final LatLngBounds routeBounds; public final String durationText; public final String distanceText; DirectionsResult(List<LatLng> polylinePoints, LatLngBounds routeBounds, String duration, String distance) { this.polylinePoints = polylinePoints; this.routeBounds = routeBounds; this.durationText = duration; this.distanceText = distance; } } }
```

# app\src\main\java\com\example\alayaapp\Place.java

```java
package com.example.alayaapp; import com.google.firebase.firestore.Exclude; import com.google.firebase.firestore.GeoPoint; import com.google.firebase.firestore.IgnoreExtraProperties; import java.util.Map; @IgnoreExtraProperties public class Place { // --- Existing Fields --- private String about; private String best_time; private String category; // This field already existed, which is correct. private String city; private transient GeoPoint coordinates; // Marked as transient private Double latitude; // New field for serialization private Double longitude; // New field for serialization private long id; private String image_url; private String name; private String open; private long price_range; private double rating; private String review_count_text; private String distance_text; // --- New Fields from Task --- private int averageVisitDuration; // Use int for minutes private Map<String, Map<String, String>> openingHours; // Map of day to {open, close} @Exclude private String documentId; // --- NEW: Field for sorting by distance --- @Exclude private double distance; // Public no-arg constructor required for Firestore public Place() {} // --- Existing Getters and Setters --- public String getAbout() { return about; } public void setAbout(String about) { this.about = about; } public String getBest_time() { return best_time; } public void setBest_time(String best_time) { this.best_time = best_time; } public String getCategory() { return category; } public void setCategory(String category) { this.category = category; } public String getCity() { return city; } public void setCity(String city) { this.city = city; } public GeoPoint getCoordinates() { return coordinates; } public void setCoordinates(GeoPoint coordinates) { this.coordinates = coordinates; if (coordinates != null) { this.latitude = coordinates.getLatitude(); this.longitude = coordinates.getLongitude(); } } public long getId() { return id; } public void setId(long id) { this.id = id; } public String getImage_url() { return image_url; } public void setImage_url(String image_url) { this.image_url = image_url; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getOpen() { return open; } public void setOpen(String open) { this.open = open; } public long getPrice_range() { return price_range; } public void setPrice_range(long price_range) { this.price_range = price_range; } public double getRating() { return rating; } public void setRating(double rating) { this.rating = rating; } public String getReview_count_text() { return review_count_text; } public void setReview_count_text(String review_count_text) { this.review_count_text = review_count_text; } public String getDistance_text() { return distance_text; } public void setDistance_text(String distance_text) { this.distance_text = distance_text; } @Exclude public String getDocumentId() { return documentId; } public void setDocumentId(String documentId) { this.documentId = documentId; } // --- Getters and Setters for New Fields --- public int getAverageVisitDuration() { return averageVisitDuration; } public void setAverageVisitDuration(int averageVisitDuration) { this.averageVisitDuration = averageVisitDuration; } public Map<String, Map<String, String>> getOpeningHours() { return openingHours; } public void setOpeningHours(Map<String, Map<String, String>> openingHours) { this.openingHours = openingHours; } // --- NEW: Getter and Setter for distance --- @Exclude public double getDistance() { return distance; } @Exclude public void setDistance(double distance) { this.distance = distance; } // --- Excluded Helper Methods --- @Exclude public Double getLatitude() { // Now returns the primitive field if (latitude != null) { return latitude; } else if (coordinates != null) { return coordinates.getLatitude(); } return null; } @Exclude public Double getLongitude() { // Now returns the primitive field if (longitude != null) { return longitude; } else if (coordinates != null) { return coordinates.getLongitude(); } return null; } }
```

# app\src\main\java\com\example\alayaapp\PlaceAdapter.java

```java
package com.example.alayaapp; import android.content.Context; import android.content.Intent; import android.util.Log; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.ImageView; import android.widget.TextView; import android.widget.Toast; import androidx.annotation.NonNull; import androidx.recyclerview.widget.RecyclerView; import com.bumptech.glide.Glide; import java.util.List; import java.util.Locale; public class PlaceAdapter extends RecyclerView.Adapter<PlaceAdapter.PlaceViewHolder> { private static final String TAG = "PlaceAdapter"; private Context context; private List<Place> placeList; // This list is the SAME instance as in HomeActivity public PlaceAdapter(Context context, List<Place> placeList) { this.context = context; this.placeList = placeList; // Stores the reference to the list from HomeActivity } @NonNull @Override public PlaceViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { View view = LayoutInflater.from(context).inflate(R.layout.item_place_card, parent, false); return new PlaceViewHolder(view); } @Override public void onBindViewHolder(@NonNull PlaceViewHolder holder, int position) { if (placeList == null || placeList.isEmpty() || position < 0 || position >= placeList.size()) { Log.w(TAG, "Invalid position or empty list in onBindViewHolder: " + position); return; } Place place = placeList.get(position); if (place == null) { Log.e(TAG, "Place object at position " + position + " is null."); return; } holder.tvPlaceName.setText(place.getName() != null ? place.getName() : "N/A"); holder.tvPlaceRating.setText(String.format(Locale.getDefault(), "%.1f", place.getRating())); holder.tvPlaceReviews.setText(place.getReview_count_text() != null ? place.getReview_count_text() : ""); holder.tvPlaceDistance.setText(place.getDistance_text() != null ? place.getDistance_text() : ""); if (place.getImage_url() != null && !place.getImage_url().isEmpty()) { Glide.with(context) .load(place.getImage_url()) .placeholder(R.drawable.img_placeholder) // Use a generic placeholder .error(R.drawable.img_error) // Use a generic error image .into(holder.ivPlaceImage); } else { Log.w(TAG, "Image URL is null or empty for place: " + (place.getName() != null ? place.getName() : "Unknown")); holder.ivPlaceImage.setImageResource(R.drawable.img_placeholder); } // Inside PlaceAdapter.java onBindViewHolder() holder.itemView.setOnClickListener(v -> { if (place.getDocumentId() != null && !place.getDocumentId().isEmpty()) { Intent intent = new Intent(context, PlaceDetailsActivity.class); // Assuming 'PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID' is the correct constant intent.putExtra(PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID, place.getDocumentId()); context.startActivity(intent); } else { Log.e(TAG, "Document ID is null or empty for clicked place: " + (place.getName() != null ? place.getName() : "Unknown")); Toast.makeText(context, "Cannot open details for this item.", Toast.LENGTH_SHORT).show(); // Added Toast for this case } }); } @Override public int getItemCount() { return placeList != null ? placeList.size() : 0; } static class PlaceViewHolder extends RecyclerView.ViewHolder { ImageView ivPlaceImage, ivStar; TextView tvPlaceName, tvPlaceRating, tvPlaceReviews, tvPlaceDistance; public PlaceViewHolder(@NonNull View itemView) { super(itemView); ivPlaceImage = itemView.findViewById(R.id.iv_item_place_image); ivStar = itemView.findViewById(R.id.iv_item_star); tvPlaceName = itemView.findViewById(R.id.tv_item_place_name); tvPlaceRating = itemView.findViewById(R.id.tv_item_place_rating); tvPlaceReviews = itemView.findViewById(R.id.tv_item_place_reviews); tvPlaceDistance = itemView.findViewById(R.id.tv_item_place_distance); } } }
```

# app\src\main\java\com\example\alayaapp\PlaceDetailsActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AppCompatActivity; import android.content.Intent; import android.os.Bundle; import android.util.Log; import android.widget.Toast; import com.bumptech.glide.Glide; import com.example.alayaapp.databinding.ActivityPlaceDetailsBinding; import com.google.firebase.firestore.DocumentReference; import com.google.firebase.firestore.DocumentSnapshot; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.FirebaseFirestoreException; import java.util.Locale; public class PlaceDetailsActivity extends AppCompatActivity { private static final String TAG = "PlaceDetailsActivity"; public static final String EXTRA_PLACE_DOCUMENT_ID = "PLACE_DOCUMENT_ID"; private ActivityPlaceDetailsBinding binding; private FirebaseFirestore db; private Place currentPlace; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityPlaceDetailsBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); db = FirebaseFirestore.getInstance(); String placeDocumentId = getIntent().getStringExtra(EXTRA_PLACE_DOCUMENT_ID); if (placeDocumentId != null && !placeDocumentId.isEmpty()) { loadPlaceDetails(placeDocumentId); } else { Log.e(TAG, "No Place Document ID provided!"); Toast.makeText(this, "Error: Place details not found.", Toast.LENGTH_LONG).show(); finish(); return; } binding.ivBackArrow.setOnClickListener(v -> finish()); binding.tvViewTransportation.setOnClickListener(v -> { if (currentPlace != null && currentPlace.getLatitude() != null && currentPlace.getLongitude() != null) { Intent mapIntent = new Intent(PlaceDetailsActivity.this, MapsActivity.class); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_LATITUDE, currentPlace.getLatitude()); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_LONGITUDE, currentPlace.getLongitude()); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_NAME, currentPlace.getName()); mapIntent.putExtra(MapsActivity.EXTRA_DRAW_ROUTE, true); // Signal to draw a route // Pass the document ID if it's a known POI for better info window in MapsActivity if (currentPlace.getDocumentId() != null && !currentPlace.getDocumentId().isEmpty()) { mapIntent.putExtra(PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID, currentPlace.getDocumentId()); } startActivity(mapIntent); } else { Toast.makeText(this, "Location data not available to plan a route.", Toast.LENGTH_SHORT).show(); Log.w(TAG, "Attempted to view transportation/route, but currentPlace or its coordinates are null. CurrentPlace: " + currentPlace); if(currentPlace != null) { Log.w(TAG, "CurrentPlace Lat: " + currentPlace.getLatitude() + ", Lng: " + currentPlace.getLongitude()); } } }); binding.tvView.setOnClickListener(v -> { if (currentPlace != null && currentPlace.getLatitude() != null && currentPlace.getLongitude() != null) { Intent mapIntent = new Intent(PlaceDetailsActivity.this, MapsActivity.class); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_LATITUDE, currentPlace.getLatitude()); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_LONGITUDE, currentPlace.getLongitude()); mapIntent.putExtra(MapsActivity.EXTRA_TARGET_NAME, currentPlace.getName()); // NO EXTRA_DRAW_ROUTE = true, so it will just center startActivity(mapIntent); } else { Toast.makeText(this, "Location data not available to view on map.", Toast.LENGTH_SHORT).show(); Log.w(TAG, "Attempted to view in map, but currentPlace or its coordinates are null. CurrentPlace: " + currentPlace); if(currentPlace != null) { Log.w(TAG, "CurrentPlace Lat: " + currentPlace.getLatitude() + ", Lng: " + currentPlace.getLongitude()); } } }); } private void loadPlaceDetails(String documentId) { DocumentReference placeRef = db.collection("places").document(documentId); placeRef.get().addOnCompleteListener(task -> { if (task.isSuccessful()) { DocumentSnapshot document = task.getResult(); if (document != null && document.exists()) { Log.d(TAG, "DocumentSnapshot data: " + document.getData()); currentPlace = document.toObject(Place.class); if (currentPlace != null) { currentPlace.setDocumentId(document.getId()); populateUI(currentPlace); } else { Log.e(TAG, "Failed to convert document to Place object."); Toast.makeText(this, "Error: Could not parse place data.", Toast.LENGTH_LONG).show(); } } else { Log.d(TAG, "No such document with ID: " + documentId); Toast.makeText(this, "Error: Place details not found in database.", Toast.LENGTH_LONG).show(); } } else { Log.e(TAG, "Firestore get failed with ", task.getException()); String errorMessage = "Error: Could not load place details."; if (task.getException() instanceof FirebaseFirestoreException) { FirebaseFirestoreException e = (FirebaseFirestoreException) task.getException(); errorMessage += " Code: " + e.getCode().name(); } Toast.makeText(this, errorMessage, Toast.LENGTH_LONG).show(); } }); } private void populateUI(Place place) { if (place == null) { Log.e(TAG, "populateUI called with null place object."); Toast.makeText(this, "Error displaying place details.", Toast.LENGTH_SHORT).show(); return; } binding.tvParkTitle.setText(place.getName() != null ? place.getName() : "N/A"); binding.tvRatingValue.setText(String.format(Locale.getDefault(), "%.1f", place.getRating())); if (binding.tvReviewCount != null) { binding.tvReviewCount.setText(place.getReview_count_text() != null ? place.getReview_count_text() : "(N/A)"); } binding.tvAboutDescription.setText(place.getAbout() != null ? place.getAbout() : "No description available."); binding.tvOpenDescription.setText(place.getOpen() != null ? place.getOpen() : "Hours not specified."); if (binding.tvBestTimeDescription != null) { binding.tvBestTimeDescription.setText(place.getBest_time() != null ? place.getBest_time() : "Not specified."); } if (binding.tvEntranceFeeDescription != null) { if (place.getPrice_range() == 0 && (place.getAbout() == null || !place.getAbout().toLowerCase().contains("fee"))) { // Basic check if "Free" or not binding.tvEntranceFeeDescription.setText("Free / Varies"); // Default to Varies if unsure } else if (place.getPrice_range() == 0) { binding.tvEntranceFeeDescription.setText("Free"); } else { binding.tvEntranceFeeDescription.setText(String.format(Locale.getDefault(), "PHP %d", place.getPrice_range())); } } if (place.getImage_url() != null && !place.getImage_url().isEmpty()) { Glide.with(this) .load(place.getImage_url()) .placeholder(R.drawable.img_placeholder) .error(R.drawable.img_error) .into(binding.ivParkImage); } else { binding.ivParkImage.setImageResource(R.drawable.img_placeholder); } } }
```

# app\src\main\java\com\example\alayaapp\ProfileActivity.java

```java
package com.example.alayaapp; import androidx.annotation.NonNull; import androidx.appcompat.app.AlertDialog; // Import AlertDialog import androidx.appcompat.app.AppCompatActivity; import android.app.DatePickerDialog; // For birthday picker import android.content.DialogInterface; // For AlertDialog buttons import android.content.Intent; import android.os.Bundle; import android.text.InputType; // For setting EditText input type import android.text.TextUtils; // For checking empty strings import android.util.Log; import android.view.View; import android.widget.DatePicker; // For DatePickerDialog listener import android.widget.EditText; // For input dialogs import android.widget.Toast; import com.example.alayaapp.databinding.ActivityProfileBinding; import com.google.firebase.auth.FirebaseAuth; import com.google.firebase.auth.FirebaseUser; import com.google.firebase.database.DataSnapshot; import com.google.firebase.database.DatabaseError; import com.google.firebase.database.DatabaseReference; import com.google.firebase.database.FirebaseDatabase; import com.google.firebase.database.ValueEventListener; import java.util.Calendar; // For DatePickerDialog import java.text.SimpleDateFormat; // For formatting date import java.util.Locale; // For date formatting public class ProfileActivity extends AppCompatActivity { private ActivityProfileBinding binding; final int CURRENT_ITEM_ID = R.id.navigation_profile; private static final String TAG = "ProfileActivity"; private FirebaseAuth mAuth; private DatabaseReference userDatabaseReference; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityProfileBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); mAuth = FirebaseAuth.getInstance(); FirebaseUser currentUser = mAuth.getCurrentUser(); if (currentUser != null) { userDatabaseReference = FirebaseDatabase.getInstance().getReference("users").child(currentUser.getUid()); } binding.bottomNavigationProfilePage.setSelectedItemId(CURRENT_ITEM_ID); setupBottomNavListener(); setupActionListeners(); loadProfileData(); } private void setupBottomNavListener() { binding.bottomNavigationProfilePage.setOnItemSelectedListener(item -> { int destinationItemId = item.getItemId(); if (destinationItemId == CURRENT_ITEM_ID) return true; Class<?> destinationActivityClass = null; if (destinationItemId == R.id.navigation_home) destinationActivityClass = HomeActivity.class; else if (destinationItemId == R.id.navigation_itineraries) destinationActivityClass = ItinerariesActivity.class; else if (destinationItemId == R.id.navigation_map) destinationActivityClass = MapsActivity.class; if (destinationActivityClass != null) { navigateTo(destinationActivityClass, destinationItemId, true); return true; } return false; }); } private void setupActionListeners() { binding.ivLogout.setOnClickListener(v -> { mAuth.signOut(); Toast.makeText(ProfileActivity.this, "Logged out successfully", Toast.LENGTH_SHORT).show(); Intent intent = new Intent(ProfileActivity.this, LoginActivity.class); intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK); startActivity(intent); finish(); }); binding.tvProfileNameDetail.setOnClickListener(v -> showEditTextDialog("name", "Edit Name", binding.tvProfileNameDetail.getText().toString())); binding.tvProfileBirthday.setOnClickListener(v -> showBirthdayPickerDialog()); binding.tvProfilePhone.setOnClickListener(v -> showEditTextDialog("contactNumber", "Edit Contact Number", binding.tvProfilePhone.getText().toString())); binding.layoutChangePassword.setOnClickListener(v -> { Intent intent = new Intent(ProfileActivity.this, ChangePasswordActivity.class); startActivity(intent); overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); }); binding.layoutHistory.setOnClickListener(v -> { Intent intent = new Intent(ProfileActivity.this, TripHistoryActivity.class); startActivity(intent); }); } private void showEditTextDialog(final String fieldKey, String title, String currentValue) { AlertDialog.Builder builder = new AlertDialog.Builder(this); builder.setTitle(title); final EditText input = new EditText(this); if (fieldKey.equals("contactNumber")) { input.setInputType(InputType.TYPE_CLASS_PHONE); } else { input.setInputType(InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_FLAG_CAP_WORDS); } if (!currentValue.startsWith("Set ") && !currentValue.equals("N/A") && !currentValue.equals("Not Set")) { input.setText(currentValue); input.setSelection(currentValue.length()); // Move cursor to end } else { input.setHint("Enter " + fieldKey.toLowerCase().replace("number", " no.")); } builder.setView(input); builder.setPositiveButton("Save", (dialog, which) -> { String newValue = input.getText().toString().trim(); if (!TextUtils.isEmpty(newValue)) { updateFirebaseField(fieldKey, newValue); } else { updateFirebaseField(fieldKey, ""); // Or show a Toast "Field cannot be empty" } }); builder.setNegativeButton("Cancel", (dialog, which) -> dialog.cancel()); builder.show(); } private void showBirthdayPickerDialog() { Calendar calendar = Calendar.getInstance(); // Try to parse current birthday text if it exists and is valid String currentBirthdayText = binding.tvProfileBirthday.getText().toString(); if (!currentBirthdayText.startsWith("Set ") && !currentBirthdayText.equals("N/A") && !currentBirthdayText.equals("Not Set")) { try { SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault()); // Or your display format calendar.setTime(sdf.parse(currentBirthdayText)); } catch (Exception e) { // Could not parse, use current date as default for picker Log.w(TAG, "Could not parse existing birthday: " + currentBirthdayText, e); } } int year = calendar.get(Calendar.YEAR); int month = calendar.get(Calendar.MONTH); int day = calendar.get(Calendar.DAY_OF_MONTH); DatePickerDialog datePickerDialog = new DatePickerDialog(this, (view, yearSelected, monthOfYear, dayOfMonth) -> { Calendar selectedDate = Calendar.getInstance(); selectedDate.set(yearSelected, monthOfYear, dayOfMonth); SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault()); // Store in a standard format String formattedDate = sdf.format(selectedDate.getTime()); updateFirebaseField("birthday", formattedDate); }, year, month, day); datePickerDialog.show(); } private void updateFirebaseField(final String fieldKey, final String value) { if (userDatabaseReference != null) { userDatabaseReference.child(fieldKey).setValue(value) .addOnSuccessListener(aVoid -> { Toast.makeText(ProfileActivity.this, fieldKey + " updated successfully", Toast.LENGTH_SHORT).show(); // Update UI locally if (fieldKey.equals("name")) { binding.tvProfileNameHeader.setText(!value.isEmpty() ? value : "Set your name"); binding.tvProfileNameDetail.setText(!value.isEmpty() ? value : "Set your name"); } else if (fieldKey.equals("contactNumber")) { binding.tvProfilePhone.setText(!value.isEmpty() ? value : "Set contact no."); } else if (fieldKey.equals("birthday")) { binding.tvProfileBirthday.setText(!value.isEmpty() ? value : "Set birthday"); } }) .addOnFailureListener(e -> { Toast.makeText(ProfileActivity.this, "Failed to update " + fieldKey, Toast.LENGTH_SHORT).show(); Log.e(TAG, "Failed to update " + fieldKey, e); }); } else { Toast.makeText(this, "Error: Not connected to database.", Toast.LENGTH_SHORT).show(); } } private void loadProfileData() { FirebaseUser currentUser = mAuth.getCurrentUser(); if (currentUser != null && userDatabaseReference != null) { binding.tvProfileEmail.setText(currentUser.getEmail() != null ? currentUser.getEmail() : "N/A"); userDatabaseReference.addValueEventListener(new ValueEventListener() { // Changed to addValueEventListener for real-time updates @Override public void onDataChange(@NonNull DataSnapshot dataSnapshot) { if (dataSnapshot.exists()) { String name = dataSnapshot.child("name").getValue(String.class); String contactNumber = dataSnapshot.child("contactNumber").getValue(String.class); String birthday = dataSnapshot.child("birthday").getValue(String.class); // Update UI text fields binding.tvProfileNameHeader.setText(name != null && !name.isEmpty() ? name : "Set your name"); binding.tvProfileNameDetail.setText(name != null && !name.isEmpty() ? name : "Set your name"); binding.tvProfilePhone.setText(contactNumber != null && !contactNumber.isEmpty() ? contactNumber : "Set contact no."); binding.tvProfileBirthday.setText(birthday != null && !birthday.isEmpty() ? birthday : "Set birthday"); // NEW: Logic to show/hide the completion prompt boolean isProfileIncomplete = TextUtils.isEmpty(name) || TextUtils.isEmpty(contactNumber) || TextUtils.isEmpty(birthday); binding.cardCompleteProfilePrompt.setVisibility(isProfileIncomplete ? View.VISIBLE : View.GONE); } else { Log.w(TAG, "User data not found in database for UID: " + currentUser.getUid()); binding.tvProfileNameHeader.setText("Set your name"); binding.tvProfileNameDetail.setText("Set your name"); binding.tvProfilePhone.setText("Set contact no."); binding.tvProfileBirthday.setText("Set birthday"); binding.cardCompleteProfilePrompt.setVisibility(View.VISIBLE); // Show prompt if no data exists } } @Override public void onCancelled(@NonNull DatabaseError databaseError) { Log.e(TAG, "Failed to load profile data.", databaseError.toException()); Toast.makeText(ProfileActivity.this, "Failed to load profile details.", Toast.LENGTH_SHORT).show(); binding.tvProfileNameHeader.setText("User"); binding.tvProfileNameDetail.setText("User"); binding.tvProfileEmail.setText(currentUser.getEmail() != null ? currentUser.getEmail() : "user@example.com"); binding.tvProfilePhone.setText("Error loading"); binding.tvProfileBirthday.setText("Error loading"); binding.cardCompleteProfilePrompt.setVisibility(View.GONE); } }); } else { // Handle case where user is not logged in or DB ref is null binding.tvProfileNameHeader.setText("User"); binding.tvProfileNameDetail.setText("User"); binding.tvProfileEmail.setText("user@example.com"); binding.tvProfilePhone.setText("N/A"); binding.tvProfileBirthday.setText("N/A"); binding.cardCompleteProfilePrompt.setVisibility(View.GONE); // Hide prompt if not logged in if (currentUser == null) Log.e(TAG, "Cannot load profile data: current user is null."); else Log.e(TAG, "Cannot load profile data: userDatabaseReference is null."); } if (binding.tvProfilePassword != null) { binding.tvProfilePassword.setText("************"); } } private void navigateTo(Class<?> destinationActivityClass, int destinationItemId, boolean finishCurrent) { Intent intent = new Intent(getApplicationContext(), destinationActivityClass); intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP); startActivity(intent); boolean slideRightToLeft = getItemIndex(destinationItemId) > getItemIndex(CURRENT_ITEM_ID); if (slideRightToLeft) overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); else overridePendingTransition(R.anim.slide_in_left, R.anim.slide_out_right); if (finishCurrent) finish(); } private int getItemIndex(int itemId) { if (itemId == R.id.navigation_home) return 0; if (itemId == R.id.navigation_itineraries) return 1; if (itemId == R.id.navigation_map) return 2; if (itemId == R.id.navigation_profile) return 3; return -1; } }
```

# app\src\main\java\com\example\alayaapp\RecommendedItineraryAdapter.java

```java
package com.example.alayaapp; import android.content.Context; import android.content.Intent; import android.text.TextUtils; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.LinearLayout; import android.widget.TextView; import android.widget.Toast; import androidx.annotation.NonNull; import androidx.recyclerview.widget.RecyclerView; import java.util.List; import java.util.Locale; public class RecommendedItineraryAdapter extends RecyclerView.Adapter<RecommendedItineraryAdapter.RecommendedViewHolder> { private final List<Place> recommendedPlaces; private final Context context; public RecommendedItineraryAdapter(Context context, List<Place> recommendedPlaces) { this.context = context; this.recommendedPlaces = recommendedPlaces; } @NonNull @Override public RecommendedViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { View view = LayoutInflater.from(context).inflate(R.layout.item_itinerary_recommended, parent, false); return new RecommendedViewHolder(view); } @Override public void onBindViewHolder(@NonNull RecommendedViewHolder holder, int position) { Place place = recommendedPlaces.get(position); holder.tvPlaceName.setText(place.getName()); // This logic handles cases where data might be missing in Firestore. // It works together with the layout fix to create a robust UI. if (place.getRating() > 0) { holder.llRatingContainer.setVisibility(View.VISIBLE); holder.tvRating.setText(String.format(Locale.getDefault(), "%.1f", place.getRating())); if (place.getReview_count_text() != null && !TextUtils.isEmpty(place.getReview_count_text())) { holder.tvReviews.setText(place.getReview_count_text()); holder.tvReviews.setVisibility(View.VISIBLE); } else { holder.tvReviews.setVisibility(View.GONE); } } else { holder.llRatingContainer.setVisibility(View.GONE); } holder.itemView.setOnClickListener(v -> { if (place.getDocumentId() != null && !place.getDocumentId().isEmpty()) { Intent intent = new Intent(context, PlaceDetailsActivity.class); intent.putExtra(PlaceDetailsActivity.EXTRA_PLACE_DOCUMENT_ID, place.getDocumentId()); context.startActivity(intent); } else { Toast.makeText(context, "Details not available for " + place.getName(), Toast.LENGTH_SHORT).show(); } }); } @Override public int getItemCount() { return recommendedPlaces.size(); } static class RecommendedViewHolder extends RecyclerView.ViewHolder { TextView tvPlaceName, tvRating, tvReviews; LinearLayout llRatingContainer; public RecommendedViewHolder(@NonNull View itemView) { super(itemView); tvPlaceName = itemView.findViewById(R.id.tv_recommended_place_name); tvRating = itemView.findViewById(R.id.tv_recommended_place_rating); tvReviews = itemView.findViewById(R.id.tv_recommended_place_reviews); llRatingContainer = itemView.findViewById(R.id.ll_rating_container); } } }
```

# app\src\main\java\com\example\alayaapp\ResetPasswordActivity.java

```java
package com.example.alayaapp; import androidx.annotation.NonNull; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import android.content.Intent; import android.os.Bundle; import android.util.Log; import android.view.LayoutInflater; import android.view.View; import android.widget.Button; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityResetPasswordBinding; import com.google.android.gms.tasks.OnCompleteListener; import com.google.android.gms.tasks.Task; import com.google.firebase.auth.FirebaseAuth; public class ResetPasswordActivity extends AppCompatActivity { private ActivityResetPasswordBinding binding; private AlertDialog successDialog; private FirebaseAuth mAuth; // Firebase Auth instance private static final String TAG = "ResetPasswordActivity"; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityResetPasswordBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); // Initialize Firebase Auth mAuth = FirebaseAuth.getInstance(); binding.ivBackArrow.setOnClickListener(v -> { finish(); }); binding.resetButton.setOnClickListener(v -> { handlePasswordReset(); }); } private void handlePasswordReset() { String email = binding.emailEditText.getText().toString().trim(); if (email.isEmpty()) { binding.emailLayout.setError("Email required"); return; } else { binding.emailLayout.setError(null); } // Disable button and show progress binding.resetButton.setEnabled(false); Toast.makeText(this, "Sending reset email...", Toast.LENGTH_SHORT).show(); mAuth.sendPasswordResetEmail(email) .addOnCompleteListener(new OnCompleteListener<Void>() { @Override public void onComplete(@NonNull Task<Void> task) { // Re-enable the button regardless of outcome binding.resetButton.setEnabled(true); if (task.isSuccessful()) { Log.d(TAG, "Password reset email sent successfully."); showPasswordResetSuccessDialog(); } else { Log.w(TAG, "sendPasswordResetEmail:failure", task.getException()); Toast.makeText(ResetPasswordActivity.this, "Failed to send reset email. Please check the address and try again.", Toast.LENGTH_LONG).show(); } } }); } private void showPasswordResetSuccessDialog() { AlertDialog.Builder builder = new AlertDialog.Builder(this); LayoutInflater inflater = this.getLayoutInflater(); View dialogView = inflater.inflate(R.layout.dialog_success_password_change, null); builder.setView(dialogView); Button btnContinue = dialogView.findViewById(R.id.btn_dialog_continue); successDialog = builder.create(); if (successDialog.getWindow() != null) { successDialog.getWindow().setBackgroundDrawableResource(android.R.color.transparent); } btnContinue.setOnClickListener(v_dialog_button -> { successDialog.dismiss(); // Navigate back to the Login screen Intent intent = new Intent(ResetPasswordActivity.this, LoginActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK); startActivity(intent); finish(); }); successDialog.show(); } }
```

# app\src\main\java\com\example\alayaapp\SignUpActivity.java

```java
package com.example.alayaapp; import androidx.annotation.NonNull; import androidx.annotation.Nullable; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import androidx.core.app.ActivityCompat; import androidx.core.content.ContextCompat; import android.Manifest; import android.app.DatePickerDialog; import android.content.Intent; import android.content.IntentSender; import android.content.pm.PackageManager; import android.os.Bundle; import android.text.TextUtils; // For checking empty name import android.util.Log; import android.view.LayoutInflater; import android.view.View; import android.widget.Button; // For location dialog import android.widget.EditText; // For name dialog import android.widget.Toast; import com.example.alayaapp.databinding.ActivitySignUpBinding; import com.example.alayaapp.databinding.ActivityWelcomePageBinding; import com.google.android.gms.common.api.ResolvableApiException; import com.google.android.gms.location.LocationRequest; import com.google.android.gms.location.LocationServices; import com.google.android.gms.location.LocationSettingsRequest; import com.google.android.gms.location.LocationSettingsResponse; import com.google.android.gms.location.SettingsClient; import com.google.android.gms.tasks.Task; import com.google.firebase.auth.FirebaseAuth; import com.google.firebase.auth.FirebaseUser; import com.google.firebase.database.DatabaseReference; import com.google.firebase.database.FirebaseDatabase; import java.text.SimpleDateFormat; import java.util.Calendar; import java.util.HashMap; import java.util.Locale; public class SignUpActivity extends AppCompatActivity { private ActivitySignUpBinding signUpFormBinding; private ActivityWelcomePageBinding welcomeScreenBinding; private AlertDialog locationDialog; private AlertDialog nameEntryDialog; // Dialog for entering name private AlertDialog birthdayPromptDialog; private AlertDialog phoneEntryDialog; private FirebaseAuth mAuth; private DatabaseReference databaseReference; // Points to "users" node private static final String TAG = "SignUpActivity"; // Request codes for permission and settings private static final int LOCATION_PERMISSION_REQUEST_CODE = 1001; private static final int REQUEST_CHECK_SETTINGS = 1002; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); mAuth = FirebaseAuth.getInstance(); databaseReference = FirebaseDatabase.getInstance().getReference("users"); showSignUpForm(); } // --- (showSignUpForm, showWelcomeScreen, showEnterNameDialog, showEnterBirthdayDialog, showEnterPhoneDialog remain the same) --- private void showSignUpForm() { signUpFormBinding = ActivitySignUpBinding.inflate(getLayoutInflater()); setContentView(signUpFormBinding.getRoot()); signUpFormBinding.signupButton.setOnClickListener(v -> { String email = signUpFormBinding.emailEditText.getText().toString().trim(); String password = signUpFormBinding.passwordEditText.getText().toString().trim(); String confirmPassword = signUpFormBinding.confirmPasswordEditText.getText().toString().trim(); // --- Your existing validation logic --- boolean valid = true; if (email.isEmpty()) { signUpFormBinding.emailLayout.setError("Email required"); valid = false; } else { signUpFormBinding.emailLayout.setError(null); } if (password.isEmpty()) { signUpFormBinding.passwordLayout.setError("Password required"); valid = false; } else { signUpFormBinding.passwordLayout.setError(null); } if (confirmPassword.isEmpty()) { signUpFormBinding.confirmPasswordLayout.setError("Confirmation required"); valid = false; } else { signUpFormBinding.confirmPasswordLayout.setError(null); } if (!valid) return; if (!password.equals(confirmPassword)) { signUpFormBinding.confirmPasswordLayout.setError("Passwords do not match"); return; } else { signUpFormBinding.confirmPasswordLayout.setError(null); } // --- End of validation logic --- signUpFormBinding.signupButton.setEnabled(false); Toast.makeText(SignUpActivity.this, "Creating account...", Toast.LENGTH_SHORT).show(); mAuth.createUserWithEmailAndPassword(email, password) .addOnCompleteListener(this, task -> { signUpFormBinding.signupButton.setEnabled(true); if (task.isSuccessful()) { Log.d(TAG, "createUserWithEmail:success"); FirebaseUser firebaseUser = mAuth.getCurrentUser(); if (firebaseUser != null) { String userId = firebaseUser.getUid(); HashMap<String, Object> userInfo = new HashMap<>(); userInfo.put("email", email); userInfo.put("name", ""); // Name initially blank userInfo.put("contactNumber", ""); userInfo.put("birthday", ""); databaseReference.child(userId).setValue(userInfo) .addOnSuccessListener(aVoid -> Log.d(TAG, "User info (empty name) successfully written for UID: " + userId)) .addOnFailureListener(e -> Log.w(TAG, "Error writing user info to DB for UID: " + userId, e)); Toast.makeText(SignUpActivity.this, "Sign Up Successful!", Toast.LENGTH_SHORT).show(); showWelcomeScreen(firebaseUser); // Pass user to next step } else { // Should not happen if task is successful, but handle defensively Toast.makeText(SignUpActivity.this, "User creation error. Please try again.", Toast.LENGTH_LONG).show(); } } else { Log.w(TAG, "createUserWithEmail:failure", task.getException()); Toast.makeText(SignUpActivity.this, "Authentication failed: " + (task.getException() != null ? task.getException().getMessage() : "Unknown error"), Toast.LENGTH_LONG).show(); } }); }); signUpFormBinding.switchToLoginLayout.setOnClickListener(v -> { finish(); }); } private void showWelcomeScreen(FirebaseUser firebaseUser) { welcomeScreenBinding = ActivityWelcomePageBinding.inflate(getLayoutInflater()); setContentView(welcomeScreenBinding.getRoot()); welcomeScreenBinding.getStartedButton.setOnClickListener(v_welcome -> { showEnterNameDialog(firebaseUser); // Show name dialog first }); } private void showEnterNameDialog(FirebaseUser firebaseUser) { if (nameEntryDialog != null && nameEntryDialog.isShowing()) { return; // Prevent multiple dialogs } AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.TransparentDialog); LayoutInflater inflater = this.getLayoutInflater(); View dialogView = inflater.inflate(R.layout.dialog_enter_name, null); builder.setView(dialogView); final EditText nameEditText = dialogView.findViewById(R.id.dialog_name_edit_text); Button nextButton = dialogView.findViewById(R.id.dialog_next_button); nameEntryDialog = builder.create(); nameEntryDialog.setCancelable(false); nextButton.setOnClickListener(v_name_dialog -> { String name = nameEditText.getText().toString().trim(); if (TextUtils.isEmpty(name)) { nameEditText.setError("Name cannot be empty"); return; } // Save the name to Firebase databaseReference.child(firebaseUser.getUid()).child("name").setValue(name) .addOnSuccessListener(aVoid -> { Toast.makeText(SignUpActivity.this, "Name saved!", Toast.LENGTH_SHORT).show(); if (nameEntryDialog != null) nameEntryDialog.dismiss(); showEnterBirthdayDialog(firebaseUser); // Proceed to next step }) .addOnFailureListener(e -> { Toast.makeText(SignUpActivity.this, "Failed to save name: " + e.getMessage(), Toast.LENGTH_SHORT).show(); Log.e(TAG, "Failed to save name to Firebase", e); }); }); nameEntryDialog.show(); } private void showEnterBirthdayDialog(final FirebaseUser firebaseUser) { if (birthdayPromptDialog != null && birthdayPromptDialog.isShowing()) { return; } AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.TransparentDialog); LayoutInflater inflater = this.getLayoutInflater(); View dialogView = inflater.inflate(R.layout.dialog_prompt_birthday, null); builder.setView(dialogView); birthdayPromptDialog = builder.create(); birthdayPromptDialog.setCancelable(false); Button btnSelectDate = dialogView.findViewById(R.id.btn_select_date); Button btnSkip = dialogView.findViewById(R.id.btn_skip_birthday); btnSkip.setOnClickListener(v -> { birthdayPromptDialog.dismiss(); showEnterPhoneDialog(firebaseUser); }); btnSelectDate.setOnClickListener(v -> { Calendar calendar = Calendar.getInstance(); int year = calendar.get(Calendar.YEAR) - 25; // Default to a reasonable age int month = calendar.get(Calendar.MONTH); int day = calendar.get(Calendar.DAY_OF_MONTH); DatePickerDialog datePickerDialog = new DatePickerDialog(this, (view, yearSelected, monthOfYear, dayOfMonth) -> { Calendar selectedDate = Calendar.getInstance(); selectedDate.set(yearSelected, monthOfYear, dayOfMonth); SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd", Locale.getDefault()); String formattedDate = sdf.format(selectedDate.getTime()); databaseReference.child(firebaseUser.getUid()).child("birthday").setValue(formattedDate) .addOnSuccessListener(aVoid -> Toast.makeText(this, "Birthday saved!", Toast.LENGTH_SHORT).show()) .addOnFailureListener(e -> Log.e(TAG, "Failed to save birthday", e)); birthdayPromptDialog.dismiss(); showEnterPhoneDialog(firebaseUser); // Proceed to next step regardless of save success }, year, month, day); datePickerDialog.setTitle("Select Your Birthday"); datePickerDialog.show(); }); birthdayPromptDialog.show(); } private void showEnterPhoneDialog(final FirebaseUser firebaseUser) { if (phoneEntryDialog != null && phoneEntryDialog.isShowing()) { return; } AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.TransparentDialog); LayoutInflater inflater = this.getLayoutInflater(); View dialogView = inflater.inflate(R.layout.dialog_enter_phone, null); builder.setView(dialogView); phoneEntryDialog = builder.create(); phoneEntryDialog.setCancelable(false); final EditText phoneEditText = dialogView.findViewById(R.id.dialog_phone_edit_text); Button btnSave = dialogView.findViewById(R.id.btn_save_phone); Button btnSkip = dialogView.findViewById(R.id.btn_skip_phone); btnSkip.setOnClickListener(v -> { phoneEntryDialog.dismiss(); showLocationPermissionDialog(); }); btnSave.setOnClickListener(v -> { String phoneNumber = phoneEditText.getText().toString().trim(); if (!TextUtils.isEmpty(phoneNumber)) { databaseReference.child(firebaseUser.getUid()).child("contactNumber").setValue(phoneNumber) .addOnSuccessListener(aVoid -> Toast.makeText(this, "Phone number saved!", Toast.LENGTH_SHORT).show()); } phoneEntryDialog.dismiss(); showLocationPermissionDialog(); // Proceed to next step }); phoneEntryDialog.show(); } private void showLocationPermissionDialog() { if (locationDialog != null && locationDialog.isShowing()) { return; // Prevent multiple dialogs } AlertDialog.Builder builder = new AlertDialog.Builder(this, R.style.TransparentDialog); LayoutInflater inflater = this.getLayoutInflater(); View dialogView = inflater.inflate(R.layout.dialog_location_notification, null); builder.setView(dialogView); Button btnTurnOn = dialogView.findViewById(R.id.btn_turn_on); Button btnSkip = dialogView.findViewById(R.id.btn_skip_location); // Get the new skip button locationDialog = builder.create(); if (locationDialog.getWindow() != null) { locationDialog.getWindow().setBackgroundDrawableResource(android.R.color.transparent); } locationDialog.setCancelable(false); btnTurnOn.setOnClickListener(v_dialog_button -> { checkAndRequestLocationPermissions(); }); btnSkip.setOnClickListener(v -> navigateToHome()); locationDialog.show(); } private void checkAndRequestLocationPermissions() { if (ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) { // Permission is not granted, request it. ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, LOCATION_PERMISSION_REQUEST_CODE); } else { // Permission has already been granted, check if location is enabled. checkDeviceLocationSettings(); } } @Override public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) { super.onRequestPermissionsResult(requestCode, permissions, grantResults); if (requestCode == LOCATION_PERMISSION_REQUEST_CODE) { if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) { // Permission was granted, now check if location services are on. checkDeviceLocationSettings(); } else { // Permission was denied. Navigate to home anyway. Toast.makeText(this, "Location permission denied. Features will be limited.", Toast.LENGTH_LONG).show(); navigateToHome(); } } } private void checkDeviceLocationSettings() { LocationRequest locationRequest = LocationRequest.create(); locationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY); LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder() .addLocationRequest(locationRequest); SettingsClient client = LocationServices.getSettingsClient(this); Task<LocationSettingsResponse> task = client.checkLocationSettings(builder.build()); task.addOnSuccessListener(this, locationSettingsResponse -> { // All location settings are satisfied. Navigate to home. Toast.makeText(this, "Location is on. You're all set!", Toast.LENGTH_SHORT).show(); navigateToHome(); }); task.addOnFailureListener(this, e -> { if (e instanceof ResolvableApiException) { // Location settings are not satisfied, but this can be fixed by showing the user a dialog. try { // Show the dialog by calling startResolutionForResult() ResolvableApiException resolvable = (ResolvableApiException) e; resolvable.startResolutionForResult(SignUpActivity.this, REQUEST_CHECK_SETTINGS); } catch (IntentSender.SendIntentException sendEx) { // Ignore the error. Log.e(TAG, "Error resolving location settings", sendEx); navigateToHome(); } } else { // Non-resolvable error. navigateToHome(); } }); } @Override protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) { super.onActivityResult(requestCode, resultCode, data); if (requestCode == REQUEST_CHECK_SETTINGS) { if (resultCode == RESULT_OK) { // The user agreed to change location settings. Toast.makeText(this, "Location services enabled!", Toast.LENGTH_SHORT).show(); } else { // The user did not agree to change location settings. Toast.makeText(this, "Location services are required for the best experience.", Toast.LENGTH_LONG).show(); } // In either case, proceed to the home screen. navigateToHome(); } } private void navigateToHome() { if (locationDialog != null && locationDialog.isShowing()) { locationDialog.dismiss(); } Intent intent = new Intent(SignUpActivity.this, HomeActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK); startActivity(intent); finish(); } @Override protected void onDestroy() { super.onDestroy(); if (locationDialog != null && locationDialog.isShowing()) { locationDialog.dismiss(); } if (nameEntryDialog != null && nameEntryDialog.isShowing()) { nameEntryDialog.dismiss(); } if (birthdayPromptDialog != null && birthdayPromptDialog.isShowing()) { birthdayPromptDialog.dismiss(); } if (phoneEntryDialog != null && phoneEntryDialog.isShowing()) { phoneEntryDialog.dismiss(); } } }
```

# app\src\main\java\com\example\alayaapp\SplashActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AppCompatActivity; import android.annotation.SuppressLint; import android.content.Intent; import android.os.Bundle; import android.os.Handler; import android.os.Looper; import com.example.alayaapp.databinding.ActivitySplashBinding; import com.google.firebase.auth.FirebaseAuth; // Firebase Import import com.google.firebase.auth.FirebaseUser; // Firebase Import @SuppressLint("CustomSplashScreen") public class SplashActivity extends AppCompatActivity { private static final long SPLASH_DELAY = 2500; private ActivitySplashBinding binding; private FirebaseAuth mAuth; // Firebase Auth instance @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivitySplashBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); mAuth = FirebaseAuth.getInstance(); new Handler(Looper.getMainLooper()).postDelayed(() -> { FirebaseUser currentUser = mAuth.getCurrentUser(); Intent intent; if (currentUser != null) { intent = new Intent(SplashActivity.this, HomeActivity.class); } else { intent = new Intent(SplashActivity.this, LoginActivity.class); } startActivity(intent); finish(); }, SPLASH_DELAY); } }
```

# app\src\main\java\com\example\alayaapp\TransportationModeActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AppCompatActivity; import android.content.Intent; import android.os.Bundle; import android.view.View; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityTransportationModeBinding; import com.example.alayaapp.databinding.ItemTransportOptionBinding; public class TransportationModeActivity extends AppCompatActivity { private ActivityTransportationModeBinding binding; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityTransportationModeBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); setupTransportationOptions(); setupBottomNavListener(); binding.bottomNavigationTransportPage.setSelectedItemId(R.id.navigation_home); // Or relevant default } private void setupTransportationOptions() { populateTransportOption(binding.transportTaxi, "Taxi", "Best!", R.drawable.ic_taxi, "5 mins", "30 - 50", R.drawable.bg_best_badge, R.color.badge_best_text); populateTransportOption(binding.transportBus, "Bus", "Fastest!", R.drawable.ic_bus, "4 mins", "15 - 20", R.drawable.bg_fastest_badge, R.color.badge_fastest_text); populateTransportOption(binding.transportBike, "Bike", null, R.drawable.ic_bike, "4 mins", "FREE", 0, 0); populateTransportOption(binding.transportMotorcycle, "Motorcycle", null, R.drawable.ic_motorcycle, "4 mins", "FREE", 0, 0); populateTransportOption(binding.transportWalk, "Walk", null, R.drawable.ic_walk, "10 mins", "FREE", 0, 0); binding.transportTaxi.getRoot().setOnClickListener(v -> showToastForMode("taxi")); binding.transportBus.getRoot().setOnClickListener(v -> showToastForMode("bus")); binding.transportBike.getRoot().setOnClickListener(v -> showToastForMode("bike")); binding.transportMotorcycle.getRoot().setOnClickListener(v -> showToastForMode("motorcycle")); binding.transportWalk.getRoot().setOnClickListener(v -> showToastForMode("walk")); } private void showToastForMode(String mode) { Toast.makeText(this, "Selected mode: " + mode + " (Map route display TBD)", Toast.LENGTH_SHORT).show(); } private void populateTransportOption(ItemTransportOptionBinding itemBinding, String name, String badgeText, int iconRes, String duration, String price, int badgeBgRes, int badgeTextColorRes) { itemBinding.tvTransportName.setText(name); itemBinding.ivTransportIcon.setImageResource(iconRes); itemBinding.tvTransportDuration.setText(duration); itemBinding.tvTransportPrice.setText(price); if (badgeText != null) { itemBinding.tvTransportBadge.setText(badgeText); itemBinding.tvTransportBadge.setBackgroundResource(badgeBgRes); // Use ContextCompat for deprecated getColor method if minSdk < 23 itemBinding.tvTransportBadge.setTextColor(getResources().getColor(badgeTextColorRes, getTheme())); itemBinding.tvTransportBadge.setVisibility(View.VISIBLE); } else { itemBinding.tvTransportBadge.setVisibility(View.GONE); } } private void setupBottomNavListener() { binding.bottomNavigationTransportPage.setOnItemSelectedListener(item -> { int destinationItemId = item.getItemId(); Class<?> destinationActivityClass = null; if (destinationItemId == R.id.navigation_home) { destinationActivityClass = HomeActivity.class; } else if (destinationItemId == R.id.navigation_itineraries) { destinationActivityClass = ItinerariesActivity.class; } else if (destinationItemId == R.id.navigation_map) { destinationActivityClass = MapsActivity.class; } else if (destinationItemId == R.id.navigation_profile) { destinationActivityClass = ProfileActivity.class; } if (destinationActivityClass != null) { navigateTo(destinationActivityClass, destinationItemId); return true; } return false; }); } private void navigateTo(Class<?> destinationActivityClass, int destinationItemId) { Intent intent = new Intent(getApplicationContext(), destinationActivityClass); // Clear previous activities if navigating to a main tab like Home if (destinationActivityClass == HomeActivity.class || destinationActivityClass == ItinerariesActivity.class || destinationActivityClass == MapsActivity.class || destinationActivityClass == ProfileActivity.class) { intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP); } startActivity(intent); overridePendingTransition(android.R.anim.fade_in, android.R.anim.fade_out); finish(); // Close this activity } }
```

# app\src\main\java\com\example\alayaapp\Trip.java

```java
package com.example.alayaapp; import com.google.firebase.firestore.Exclude; import com.google.firebase.firestore.ServerTimestamp; import java.util.Date; import java.util.List; import java.util.Map; public class Trip { @Exclude private String documentId; private String tripTitle; private String tripDate; private String tripSignature; // NEW: For checking duplicates @ServerTimestamp private Date savedAt; private List<Map<String, String>> itinerary; public Trip() { // Public no-arg constructor needed for Firestore } public Trip(String tripTitle, String tripDate, String tripSignature, List<Map<String, String>> itinerary) { this.tripTitle = tripTitle; this.tripDate = tripDate; this.tripSignature = tripSignature; this.itinerary = itinerary; } public String getDocumentId() { return documentId; } public void setDocumentId(String documentId) { this.documentId = documentId; } public String getTripTitle() { return tripTitle; } public void setTripTitle(String tripTitle) { this.tripTitle = tripTitle; } public String getTripDate() { return tripDate; } public void setTripDate(String tripDate) { this.tripDate = tripDate; } public String getTripSignature() { return tripSignature; } public void setTripSignature(String tripSignature) { this.tripSignature = tripSignature; } public Date getSavedAt() { return savedAt; } public void setSavedAt(Date savedAt) { this.savedAt = savedAt; } public List<Map<String, String>> getItinerary() { return itinerary; } public void setItinerary(List<Map<String, String>> itinerary) { this.itinerary = itinerary; } }
```

# app\src\main\java\com\example\alayaapp\TripHistoryActivity.java

```java
package com.example.alayaapp; import androidx.appcompat.app.AlertDialog; import androidx.appcompat.app.AppCompatActivity; import androidx.recyclerview.widget.LinearLayoutManager; import android.content.Intent; import android.os.Bundle; import android.util.Log; import android.view.View; import android.widget.Toast; import com.example.alayaapp.databinding.ActivityTripHistoryBinding; import com.google.firebase.auth.FirebaseAuth; import com.google.firebase.auth.FirebaseUser; import com.google.firebase.firestore.FirebaseFirestore; import com.google.firebase.firestore.Query; import com.google.firebase.firestore.QueryDocumentSnapshot; import java.util.ArrayList; import java.util.List; public class TripHistoryActivity extends AppCompatActivity implements TripHistoryAdapter.OnTripInteractionListener { private ActivityTripHistoryBinding binding; private FirebaseFirestore db; private FirebaseAuth mAuth; private TripHistoryAdapter adapter; private List<Trip> tripList; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityTripHistoryBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); db = FirebaseFirestore.getInstance(); mAuth = FirebaseAuth.getInstance(); setupRecyclerView(); binding.ivBackArrowTripHistory.setOnClickListener(v -> finish()); // The code related to the bottom navigation has been removed. // binding.bottomNavigationTripHistory.setSelectedItemId(...); // binding.bottomNavigationTripHistory.setOnItemSelectedListener(...); loadTripHistory(); } private void setupRecyclerView() { tripList = new ArrayList<>(); adapter = new TripHistoryAdapter(this, tripList, this); binding.rvTripHistory.setLayoutManager(new LinearLayoutManager(this)); binding.rvTripHistory.setAdapter(adapter); } private void loadTripHistory() { FirebaseUser currentUser = mAuth.getCurrentUser(); if (currentUser == null) { binding.tvNoHistoryMessage.setText("Please sign in to view your trip history."); binding.tvNoHistoryMessage.setVisibility(View.VISIBLE); binding.rvTripHistory.setVisibility(View.GONE); return; } db.collection("users").document(currentUser.getUid()) .collection("tripHistory") .orderBy("savedAt", Query.Direction.DESCENDING) .get() .addOnCompleteListener(task -> { if (task.isSuccessful()) { tripList.clear(); for (QueryDocumentSnapshot document : task.getResult()) { Trip trip = document.toObject(Trip.class); trip.setDocumentId(document.getId()); tripList.add(trip); } if (tripList.isEmpty()) { binding.tvNoHistoryMessage.setText("You haven't saved any trips yet."); binding.tvNoHistoryMessage.setVisibility(View.VISIBLE); binding.rvTripHistory.setVisibility(View.GONE); } else { binding.tvNoHistoryMessage.setVisibility(View.GONE); binding.rvTripHistory.setVisibility(View.VISIBLE); adapter.notifyDataSetChanged(); } } else { Log.w("TripHistoryActivity", "Error getting documents.", task.getException()); Toast.makeText(this, "Failed to load trip history.", Toast.LENGTH_SHORT).show(); binding.tvNoHistoryMessage.setText("Could not load trip history."); binding.tvNoHistoryMessage.setVisibility(View.VISIBLE); } }); } @Override public void onTripLongPressed(Trip trip, int position) { new AlertDialog.Builder(this) .setTitle("Delete Trip") .setMessage("Are you sure you want to permanently delete your '" + trip.getTripTitle() + "'?") .setPositiveButton("Delete", (dialog, which) -> { deleteTripFromFirestore(trip, position); }) .setNegativeButton("Cancel", null) .setIcon(android.R.drawable.ic_dialog_alert) .show(); } private void deleteTripFromFirestore(Trip trip, int position) { FirebaseUser currentUser = mAuth.getCurrentUser(); if (currentUser == null || trip.getDocumentId() == null || trip.getDocumentId().isEmpty()) { Toast.makeText(this, "Error: Could not delete trip.", Toast.LENGTH_SHORT).show(); return; } db.collection("users").document(currentUser.getUid()) .collection("tripHistory").document(trip.getDocumentId()) .delete() .addOnSuccessListener(aVoid -> { tripList.remove(position); adapter.notifyItemRemoved(position); adapter.notifyItemRangeChanged(position, tripList.size()); Toast.makeText(this, "Trip deleted successfully.", Toast.LENGTH_SHORT).show(); if (tripList.isEmpty()) { binding.tvNoHistoryMessage.setVisibility(View.VISIBLE); binding.rvTripHistory.setVisibility(View.GONE); } }) .addOnFailureListener(e -> { Toast.makeText(this, "Failed to delete trip. Please try again.", Toast.LENGTH_SHORT).show(); Log.e("TripHistoryActivity", "Error deleting trip", e); }); } }
```

# app\src\main\java\com\example\alayaapp\TripHistoryAdapter.java

```java
package com.example.alayaapp; import android.content.Context; import android.content.Intent; import android.view.LayoutInflater; import android.view.View; import android.view.ViewGroup; import android.widget.TextView; import android.widget.Toast; import androidx.annotation.NonNull; import androidx.cardview.widget.CardView; import androidx.recyclerview.widget.RecyclerView; import java.text.SimpleDateFormat; import java.util.List; import java.util.Locale; public class TripHistoryAdapter extends RecyclerView.Adapter<TripHistoryAdapter.TripViewHolder> { private final Context context; private final List<Trip> tripList; private final OnTripInteractionListener listener; // Interface for communication with the Activity public interface OnTripInteractionListener { void onTripLongPressed(Trip trip, int position); } public TripHistoryAdapter(Context context, List<Trip> tripList, OnTripInteractionListener listener) { this.context = context; this.tripList = tripList; this.listener = listener; } @NonNull @Override public TripViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) { View view = LayoutInflater.from(context).inflate(R.layout.item_trip_history, parent, false); return new TripViewHolder(view); } @Override public void onBindViewHolder(@NonNull TripViewHolder holder, int position) { Trip trip = tripList.get(position); holder.tvTripTitle.setText(trip.getTripTitle()); holder.tvTripDate.setText(trip.getTripDate()); // --- ROBUST LOGIC FOR THE MONTH/YEAR HEADER --- SimpleDateFormat sdf = new SimpleDateFormat("MMMM yyyy", Locale.getDefault()); String currentMonthYear = (trip.getSavedAt() != null) ? sdf.format(trip.getSavedAt()) : "Unknown Date"; if (position == 0) { holder.tvTripMonthYear.setVisibility(View.VISIBLE); holder.tvTripMonthYear.setText(currentMonthYear); } else { Trip previousTrip = tripList.get(position - 1); String previousMonthYear = (previousTrip.getSavedAt() != null) ? sdf.format(previousTrip.getSavedAt()) : "Unknown Date"; if (currentMonthYear.equals(previousMonthYear)) { holder.tvTripMonthYear.setVisibility(View.GONE); } else { holder.tvTripMonthYear.setVisibility(View.VISIBLE); holder.tvTripMonthYear.setText(currentMonthYear); } } // --- Itinerary Preview Logic --- if (trip.getItinerary() != null && !trip.getItinerary().isEmpty()) { StringBuilder preview = new StringBuilder("Starts with: "); preview.append(trip.getItinerary().get(0).get("activity")); if (trip.getItinerary().size() > 1) { preview.append(", ").append(trip.getItinerary().get(1).get("activity")); } if (trip.getItinerary().size() > 2) { preview.append("..."); } holder.tvItineraryPreview.setText(preview.toString()); holder.tvItineraryPreview.setVisibility(View.VISIBLE); } else { holder.tvItineraryPreview.setVisibility(View.GONE); } // --- Click Listener for Viewing Details --- holder.tripCard.setOnClickListener(v -> { if (trip.getDocumentId() != null && !trip.getDocumentId().isEmpty()) { Intent intent = new Intent(context, ItineraryLogDetailActivity.class); intent.putExtra("TRIP_ID", trip.getDocumentId()); context.startActivity(intent); } else { Toast.makeText(context, "Error: Cannot open trip details.", Toast.LENGTH_SHORT).show(); } }); // --- NEW: Long-Press Listener for Deleting --- holder.tripCard.setOnLongClickListener(v -> { if (listener != null) { listener.onTripLongPressed(trip, position); return true; // Consume the event } return false; }); } @Override public int getItemCount() { return tripList.size(); } static class TripViewHolder extends RecyclerView.ViewHolder { TextView tvTripTitle, tvTripDate, tvTripMonthYear, tvItineraryPreview; CardView tripCard; public TripViewHolder(@NonNull View itemView) { super(itemView); tvTripTitle = itemView.findViewById(R.id.tv_name_trip); tvTripDate = itemView.findViewById(R.id.tv_date_trip); tvTripMonthYear = itemView.findViewById(R.id.tv_month_year_header); tvItineraryPreview = itemView.findViewById(R.id.tv_itinerary_preview); tripCard = itemView.findViewById(R.id.card_trip_item); } } }
```

# app\src\main\res\anim\slide_in_left.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <set xmlns:android="http://schemas.android.com/apk/res/android" android:shareInterpolator="false"> <translate android:fromXDelta="-100%p" android:toXDelta="0%p" android:fromYDelta="0%" android:toYDelta="0%" android:duration="@android:integer/config_shortAnimTime"/> </set>
```

# app\src\main\res\anim\slide_in_right.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <set xmlns:android="http://schemas.android.com/apk/res/android" android:shareInterpolator="false"> <translate android:fromXDelta="100%p" android:toXDelta="0%p" android:fromYDelta="0%" android:toYDelta="0%" android:duration="@android:integer/config_shortAnimTime"/> </set>
```

# app\src\main\res\anim\slide_out_left.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <set xmlns:android="http://schemas.android.com/apk/res/android" android:shareInterpolator="false"> <translate android:fromXDelta="0%p" android:toXDelta="-100%p" android:fromYDelta="0%" android:toYDelta="0%" android:duration="@android:integer/config_shortAnimTime"/> <!-- Optional: Add fade out effect simultaneously --> <!-- <alpha android:fromAlpha="1.0" android:toAlpha="0.0" android:duration="@android:integer/config_shortAnimTime" /> --> </set>
```

# app\src\main\res\anim\slide_out_right.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <set xmlns:android="http://schemas.android.com/apk/res/android" android:shareInterpolator="false"> <translate android:fromXDelta="0%p" android:toXDelta="100%p" android:fromYDelta="0%" android:toYDelta="0%" android:duration="@android:integer/config_shortAnimTime"/> </set>
```

# app\src\main\res\color\bottom_nav_color_selector.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <selector xmlns:android="http://schemas.android.com/apk/res/android"> <item android:state_checked="true" android:color="@color/colorPrimary" /> <item android:color="@color/textSecondary" /> </selector>
```

# app\src\main\res\color\button_previous_tint_selector.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <selector xmlns:android="http://schemas.android.com/apk/res/android"> <!-- State when the button is disabled --> <item android:state_enabled="false" android:color="@color/button_disabled_grey" /> <!-- Default state (enabled) --> <item android:color="@color/colorErrorRed" /> </selector>
```

# app\src\main\res\drawable\bg_best_badge.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#E0F2F1" /> <!-- Light teal/green background --> <corners android:radius="6dp" /> </shape>
```

# app\src\main\res\drawable\bg_bottom_sheet_maps.xml

```xml
<!-- res/drawable/bg_bottom_sheet_maps.xml --> <shape xmlns:android="http://schemas.android.com/apk/res/android"> <solid android:color="@android:color/white"/> <!-- Optional: Add rounded top corners if desired --> <!-- <corners android:topLeftRadius="16dp" android:topRightRadius="16dp"/> --> </shape>
```

# app\src\main\res\drawable\bg_button_filled_green.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="@color/colorPrimary"/> <!-- Your primary green --> <corners android:radius="8dp"/> </shape>
```

# app\src\main\res\drawable\bg_button_outlined_green.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="@android:color/transparent"/> <!-- Transparent fill --> <stroke android:width="1.5dp" android:color="@color/colorPrimary"/> <!-- Green border --> <corners android:radius="8dp"/> </shape>
```

# app\src\main\res\drawable\bg_button_white_rounded.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="@color/white"/> <corners android:radius="8dp"/> </shape>
```

# app\src\main\res\drawable\bg_dialog_success.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <!-- Adjust alpha for transparency if needed, e.g., #E6008037 --> <solid android:color="#00642C"/> <!-- Darker shade of green --> <corners android:radius="16dp"/> </shape>
```

# app\src\main\res\drawable\bg_fastest_badge.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#E3F2FD" /> <!-- Light blue background --> <corners android:radius="6dp" /> </shape>
```

# app\src\main\res\drawable\bg_itinerary_number_indicator.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="oval"> <solid android:color="@color/colorPrimary" /> <size android:width="24dp" android:height="24dp" /> </shape>
```

# app\src\main\res\drawable\bg_location_history_item.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#F5F5F5"/> <!-- Light grey --> <corners android:radius="8dp"/> </shape>
```

# app\src\main\res\drawable\bg_rounded_button.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <!-- Background Color --> <solid android:color="@color/myButtonColor" /> <!-- Rounded Corners --> <corners android:radius="12dp" /> <!-- Adjust dp value for more/less rounding --> </shape>
```

# app\src\main\res\drawable\bg_rounded_light_gray.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#F0F0F0"/> <!-- Light gray, adjust as needed --> <corners android:radius="12dp"/> <!-- Adjust corner radius --> </shape>
```

# app\src\main\res\drawable\bg_transport_card.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#F5F5F5" /> <!-- Light grey background, or use @color/your_light_grey --> <corners android:radius="12dp" /> </shape>
```

# app\src\main\res\drawable\botanical.png

This is a binary file of the type: Image

# app\src\main\res\drawable\burnham.png

This is a binary file of the type: Image

# app\src\main\res\drawable\calendar.png

This is a binary file of the type: Image

# app\src\main\res\drawable\campjohn.png

This is a binary file of the type: Image

# app\src\main\res\drawable\circle_gradient_background.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="oval"> <!-- CHANGE to oval to make it a circle --> <gradient android:angle="270" android:startColor="#26925C" android:endColor="#2E7D32" android:type="linear" /> <!-- No corners needed for oval, it's inherently round --> </shape>
```

# app\src\main\res\drawable\dialog_background_gradient_rounded.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <!-- Copied from your original gradient file --> <gradient android:angle="270" android:startColor="#26925C" android:endColor="#2E7D32" android:type="linear" /> <!-- ADDED corners SPECIFICALLY for the dialog --> <corners android:radius="16dp" /> <!-- Adjust "16dp" as needed --> </shape>
```

# app\src\main\res\drawable\dialog_background_rounded.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android"> <solid android:color="@android:color/white"/> <corners android:radius="12dp"/> </shape>
```

# app\src\main\res\drawable\edit.xml

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android" android:height="24dp" android:tint="#000000" android:viewportHeight="24" android:viewportWidth="24" android:width="24dp"> <path android:fillColor="@android:color/white" android:pathData="M3,17.25V21h3.75L17.81,9.94l-3.75,-3.75L3,17.25zM20.71,7.04c0.39,-0.39 0.39,-1.02 0,-1.41l-2.34,-2.34c-0.39,-0.39 -1.02,-0.39 -1.41,0l-1.83,1.83 3.75,3.75 1.83,-1.83z"/> </vector>
```

# app\src\main\res\drawable\edittext_border_dialog.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="@android:color/white"/> <stroke android:width="1dp" android:color="#D3D3D3" /> <!-- Light gray border --> <corners android:radius="4dp"/> </shape>
```

# app\src\main\res\drawable\gradient_background.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <gradient android:angle="0" android:startColor="#26925C" android:endColor="#2E7D32" android:type="linear" /> </shape>
```

# app\src\main\res\drawable\home.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_arrow_upward_circle.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_bike.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_bus.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_calendar_today.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_drag_handle.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_email.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_history.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_launcher_background.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <vector xmlns:android="http://schemas.android.com/apk/res/android" android:width="108dp" android:height="108dp" android:viewportWidth="108" android:viewportHeight="108"> <!-- This path creates a solid green rectangle filling the entire viewport --> <path android:fillColor="@color/colorPrimary" android:pathData="M0,0h108v108h-108z" /> <!-- All the grid line paths have been removed --> </vector>
```

# app\src\main\res\drawable\ic_launcher_foreground.xml

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android" xmlns:aapt="http://schemas.android.com/aapt" android:width="108dp" android:height="108dp" android:viewportWidth="108" android:viewportHeight="108"> <path android:pathData="M31,63.928c0,0 6.4,-11 12.1,-13.1c7.2,-2.6 26,-1.4 26,-1.4l38.1,38.1L107,108.928l-32,-1L31,63.928z"> <aapt:attr name="android:fillColor"> <gradient android:endX="85.84757" android:endY="92.4963" android:startX="42.9492" android:startY="49.59793" android:type="linear"> <item android:color="#44000000" android:offset="0.0" /> <item android:color="#00000000" android:offset="1.0" /> </gradient> </aapt:attr> </path> <path android:fillColor="#FFFFFF" android:fillType="nonZero" android:pathData="M65.3,45.828l3.8,-6.6c0.2,-0.4 0.1,-0.9 -0.3,-1.1c-0.4,-0.2 -0.9,-0.1 -1.1,0.3l-3.9,6.7c-6.3,-2.8 -13.4,-2.8 -19.7,0l-3.9,-6.7c-0.2,-0.4 -0.7,-0.5 -1.1,-0.3C38.8,38.328 38.7,38.828 38.9,39.228l3.8,6.6C36.2,49.428 31.7,56.028 31,63.928h46C76.3,56.028 71.8,49.428 65.3,45.828zM43.4,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2c-0.3,-0.7 -0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C45.3,56.528 44.5,57.328 43.4,57.328L43.4,57.328zM64.6,57.328c-0.8,0 -1.5,-0.5 -1.8,-1.2s-0.1,-1.5 0.4,-2.1c0.5,-0.5 1.4,-0.7 2.1,-0.4c0.7,0.3 1.2,1 1.2,1.8C66.5,56.528 65.6,57.328 64.6,57.328L64.6,57.328z" android:strokeWidth="1" android:strokeColor="#00000000" /> </vector>
```

# app\src\main\res\drawable\ic_logo.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_logout.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_motorcycle.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_phone.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_profile_placeholder.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_profile.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_show_itinerary_route.xml

```xml
<vector xmlns:android="http://schemas.android.com/apk/res/android" android:width="24dp" android:height="24dp" android:viewportWidth="24" android:viewportHeight="24"> <path android:fillColor="#000000" android:pathData="M19,15.18V7c0,-2.21 -1.79,-4 -4,-4s-4,1.79 -4,4v10c0,1.1 -0.9,2 -2,2s-2,-0.9 -2,-2V8.82C8.16,8.4 9,7.3 9,6c0,-1.66 -1.34,-3 -3,-3S3,4.34 3,6c0,1.3 0.84,2.4 2,2.82V17c0,2.21 1.79,4 4,4s4,-1.79 4,-4V7c0,-1.1 0.9,-2 2,-2s2,0.9 2,2v8.18c-1.16,0.41 -2,1.51 -2,2.82c0,1.66 1.34,3 3,3s3,-1.34 3,-3C21,16.69 20.16,15.59 19,15.18zM6,7C5.45,7 5,6.55 5,6s0.45,-1 1,-1s1,0.45 1,1S6.55,7 6,7zM18,19c-0.55,0 -1,-0.45 -1,-1s0.45,-1 1,-1s1,0.45 1,1S18.55,19 18,19z"/> </vector>
```

# app\src\main\res\drawable\ic_taxi.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_visibility_on.png

This is a binary file of the type: Image

# app\src\main\res\drawable\ic_walk.png

This is a binary file of the type: Image

# app\src\main\res\drawable\img_error.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#FFCDD2"/> <!-- Light red color for error --> <corners android:radius="4dp"/> <!-- You could add an icon inside using a layer-list if desired --> </shape>
```

# app\src\main\res\drawable\img_placeholder.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="#E0E0E0"/> <!-- Light grey color --> <size android:width="100dp" android:height="100dp"/> <!-- Optional: default size --> </shape>
```

# app\src\main\res\drawable\iteneraries.png

This is a binary file of the type: Image

# app\src\main\res\drawable\left_back_button.png

This is a binary file of the type: Image

# app\src\main\res\drawable\location_picture.png

This is a binary file of the type: Image

# app\src\main\res\drawable\location.png

This is a binary file of the type: Image

# app\src\main\res\drawable\logo_black_text.PNG

This is a binary file of the type: Image

# app\src\main\res\drawable\logo_white_text.png

This is a binary file of the type: Image

# app\src\main\res\drawable\map.png

This is a binary file of the type: Image

# app\src\main\res\drawable\mines.png

This is a binary file of the type: Image

# app\src\main\res\drawable\profile_header_background.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle"> <solid android:color="@color/colorPrimary" /> <!-- Define this color in colors.xml --> <corners android:bottomLeftRadius="200dp" android:bottomRightRadius="200dp" /> </shape>
```

# app\src\main\res\drawable\profile.png

This is a binary file of the type: Image

# app\src\main\res\drawable\right_proceed_button.png

This is a binary file of the type: Image

# app\src\main\res\drawable\rounded_button_white.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <layer-list xmlns:android="http://schemas.android.com/apk/res/android"> <item android:right="2dp" android:bottom="2dp"> <shape android:shape="rectangle"> <solid android:color="#40FFFFFF"/> <corners android:radius="10dp"/> </shape> </item> <item> <shape android:shape="rectangle"> <solid android:color="@android:color/white"/> <stroke android:width="2dp" android:color="#80000000"/> <corners android:radius="10dp"/> <padding android:left="16dp" android:top="10dp" android:right="16dp" android:bottom="10dp"/> </shape> </item> </layer-list>
```

# app\src\main\res\drawable\star.png

This is a binary file of the type: Image

# app\src\main\res\drawable\undraw_map_cuix.png

This is a binary file of the type: Image

# app\src\main\res\font\poppins_bold_regular.ttf

This is a binary file of the type: Binary

# app\src\main\res\font\poppins_bold.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <font-family xmlns:android="http://schemas.android.com/apk/res/android"> <font android:fontStyle="normal" android:fontWeight="700" android:font="@font/poppins_bold_regular" /> </font-family>
```

# app\src\main\res\font\roboto_bold.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <font-family xmlns:app="http://schemas.android.com/apk/res-auto" app:fontProviderAuthority="com.google.android.gms.fonts" app:fontProviderPackage="com.google.android.gms" app:fontProviderQuery="Roboto:wght700" app:fontProviderCerts="@array/com_google_android_gms_fonts_certs"> </font-family>
```

# app\src\main\res\font\roboto_condensed_light_italic_regular.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <font-family xmlns:android="http://schemas.android.com/apk/res/android"> <font android:fontStyle="italic" android:fontWeight="300" android:font="@font/roboto_condensed_light_italic" /> </font-family>
```

# app\src\main\res\font\roboto_condensed_light_italic.ttf

This is a binary file of the type: Binary

# app\src\main\res\font\roboto_medium_regular.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <font-family xmlns:android="http://schemas.android.com/apk/res/android"> <font android:fontStyle="normal" android:fontWeight="500" android:font="@font/roboto_medium" /> </font-family>
```

# app\src\main\res\font\roboto_medium.ttf

This is a binary file of the type: Binary

# app\src\main\res\font\roboto_thin.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <font-family xmlns:app="http://schemas.android.com/apk/res-auto" app:fontProviderAuthority="com.google.android.gms.fonts" app:fontProviderPackage="com.google.android.gms" app:fontProviderQuery="Roboto:wght100" app:fontProviderCerts="@array/com_google_android_gms_fonts_certs"> </font-family>
```

# app\src\main\res\layout\activity_change_password.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".ChangePasswordActivity"> <ImageView android:id="@+id/iv_back_arrow_change_password" android:layout_width="70dp" android:layout_height="50dp" android:layout_marginStart="4dp" android:layout_marginTop="4dp" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:contentDescription="Back" android:focusable="true" android:padding="8dp" android:src="@drawable/left_back_button" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/colorPrimary" /> <ImageView android:id="@+id/iv_app_logo_change_password" android:layout_width="237dp" android:layout_height="158dp" android:layout_marginTop="32dp" android:contentDescription="App Logo" android:src="@drawable/logo_black_text" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintHorizontal_bias="0.481" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/iv_back_arrow_change_password" /> <TextView android:id="@+id/tv_change_password_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:text="Change your Password" android:textColor="@color/textPrimary" android:textSize="20sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/iv_app_logo_change_password" /> <!-- New Password Field --> <com.google.android.material.textfield.TextInputLayout android:id="@+id/til_new_password" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="32dp" android:layout_marginTop="32dp" android:layout_marginEnd="32dp" android:hint="New Password" app:boxStrokeColor="@color/colorPrimary" app:hintTextColor="@color/colorPrimary" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tv_change_password_title" app:passwordToggleEnabled="true" app:passwordToggleTint="@color/lightGrayBackground"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/et_new_password" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textPassword" android:maxLines="1" /> </com.google.android.material.textfield.TextInputLayout> <!-- Confirm New Password Field --> <com.google.android.material.textfield.TextInputLayout android:id="@+id/til_confirm_password" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="32dp" android:layout_marginTop="16dp" android:layout_marginEnd="32dp" android:hint="Confirm Password" app:boxStrokeColor="@color/colorPrimary" app:hintTextColor="@color/colorPrimary" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/til_new_password" app:passwordToggleEnabled="true" app:passwordToggleTint="@color/lightGrayBackground"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/et_confirm_password" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textPassword" android:maxLines="1" android:imeOptions="actionDone"/> </com.google.android.material.textfield.TextInputLayout> <com.google.android.material.button.MaterialButton android:id="@+id/btn_change_password_submit" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="32dp" android:layout_marginEnd="32dp" android:layout_marginBottom="32dp" android:backgroundTint="@color/colorPrimary" android:paddingVertical="14dp" android:text="Change" android:textAllCaps="false" android:textColor="@color/white" android:textSize="16sp" app:cornerRadius="8dp" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/til_confirm_password" app:layout_constraintVertical_bias="0.3" /> <!-- Adjust bias to position button --> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_home.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".HomeActivity"> <ScrollView android:id="@+id/scrollView" android:layout_width="0dp" android:layout_height="0dp" android:fillViewport="true" android:scrollbars="none" app:layout_constraintBottom_toTopOf="@+id/bottom_navigation" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="16dp" android:paddingEnd="16dp" android:paddingTop="24dp" android:paddingBottom="16dp"> <!-- Home Title --> <TextView android:id="@+id/tv_home_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="@string/title_home" android:textColor="@color/colorPrimary" android:textSize="34sp" android:textStyle="bold" /> <!-- NEW: Redesigned Trip Schedule Section --> <TextView android:id="@+id/tv_trip_schedule_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="20dp" android:text="Trip Schedule" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold"/> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="12dp" android:background="@drawable/bg_rounded_light_gray" android:orientation="vertical" android:paddingHorizontal="14dp"> <!-- Date Row --> <RelativeLayout android:id="@+id/rl_trip_date" android:layout_width="match_parent" android:layout_height="wrap_content" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:paddingVertical="14dp"> <ImageView android:id="@+id/iv_date_icon" android:layout_width="24dp" android:layout_height="24dp" android:layout_alignParentStart="true" android:layout_centerVertical="true" android:src="@drawable/calendar" app:tint="@color/textPrimary" /> <TextView android:id="@+id/tv_trip_date" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_marginStart="12dp" android:layout_toEndOf="@id/iv_date_icon" android:textColor="@color/textPrimary" android:textSize="16sp" tools:text="Mon, Jul 29, 2024" /> <ImageView android:layout_width="24dp" android:layout_height="24dp" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:src="@drawable/right_proceed_button" app:tint="@color/textSecondary" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="#DADADA" /> <!-- Time Row --> <RelativeLayout android:id="@+id/rl_trip_time" android:layout_width="match_parent" android:layout_height="wrap_content" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:paddingVertical="14dp"> <ImageView android:id="@+id/iv_time_icon" android:layout_width="24dp" android:layout_height="24dp" android:layout_alignParentStart="true" android:layout_centerVertical="true" android:src="@drawable/ic_calendar_today" app:tint="@color/textPrimary" /> <TextView android:id="@+id/tv_trip_time" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_marginStart="12dp" android:layout_toEndOf="@id/iv_time_icon" android:textColor="@color/textPrimary" android:textSize="16sp" tools:text="9:00 AM - 6:00 PM" /> <ImageView android:layout_width="24dp" android:layout_height="24dp" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:src="@drawable/right_proceed_button" app:tint="@color/textSecondary" /> </RelativeLayout> </LinearLayout> <!-- Current Location Title --> <TextView android:id="@+id/tv_current_location_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:text="Current Location" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold" /> <!-- Location Display Box with Edit Button --> <androidx.constraintlayout.widget.ConstraintLayout android:id="@+id/cl_location_container" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="12dp" android:background="@drawable/bg_rounded_light_gray" android:padding="14dp"> <ImageView android:id="@+id/iv_location_icon_home" android:layout_width="24dp" android:layout_height="24dp" android:contentDescription="Location Icon" android:src="@drawable/location" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/textPrimary" /> <TextView android:id="@+id/tv_location_city2" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="12dp" android:layout_marginEnd="8dp" android:text="Tap to get current location" android:textColor="@color/textPrimary" android:textSize="16sp" android:textStyle="bold" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toStartOf="@+id/ib_edit_location" app:layout_constraintStart_toEndOf="@id/iv_location_icon_home" app:layout_constraintTop_toTopOf="parent" tools:text="Tap to get current location" /> <ImageButton android:id="@+id/ib_edit_location" android:layout_width="36dp" android:layout_height="36dp" android:background="?attr/selectableItemBackgroundBorderless" android:contentDescription="Edit Location" android:src="@drawable/edit" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/colorPrimary" /> </androidx.constraintlayout.widget.ConstraintLayout> <!-- Direction/Status Text --> <TextView android:id="@+id/tv_direction_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:textColor="@color/textSecondary" android:textSize="12sp" tools:text="Location status will show here" /> <!-- Tourist and Food Spots Title --> <TextView android:id="@+id/tv_spots_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:text="Tourist and Food Spots Near You" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold" /> <!-- Loading Indicator --> <ProgressBar android:id="@+id/progressBar_home" style="?android:attr/progressBarStyle" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginTop="24dp" android:visibility="gone" tools:visibility="visible" /> <TextView android:id="@+id/tv_empty_places" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginTop="24dp" android:text="No places found nearby." android:textColor="@color/textSecondary" android:textSize="16sp" android:visibility="gone" tools:visibility="gone" /> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_places_list" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="16dp" app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" tools:itemCount="3" tools:listitem="@layout/item_place_card" /> </LinearLayout> </ScrollView> <!-- Bottom Navigation --> <com.google.android.material.bottomnavigation.BottomNavigationView android:id="@+id/bottom_navigation" android:layout_width="0dp" android:layout_height="wrap_content" android:background="?android:attr/windowBackground" app:elevation="8dp" app:itemActiveIndicatorStyle="@null" app:itemIconTint="@color/bottom_nav_color_selector" app:itemTextColor="@color/bottom_nav_color_selector" app:labelVisibilityMode="labeled" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:menu="@menu/bottom_nav_menu" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_itineraries.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".ItinerariesActivity"> <!-- The ONE RecyclerView that controls the whole scrolling body --> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_itineraries_main" android:layout_width="0dp" android:layout_height="0dp" android:clipToPadding="false" android:paddingBottom="16dp" app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" app:layout_constraintBottom_toTopOf="@+id/bottom_navigation" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" tools:listitem="@layout/list_item_itinerary" /> <!-- NEW: Loading Indicator --> <ProgressBar android:id="@+id/pb_itineraries" android:layout_width="wrap_content" android:layout_height="wrap_content" android:visibility="gone" app:layout_constraintBottom_toTopOf="@+id/bottom_navigation" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" tools:visibility="visible" /> <!-- NEW: Save Trip Floating Action Button --> <com.google.android.material.floatingactionbutton.FloatingActionButton android:id="@+id/fab_save_trip" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="16dp" android:layout_marginBottom="16dp" android:clickable="true" android:contentDescription="Save Trip" android:focusable="true" android:visibility="gone" app:backgroundTint="@color/colorPrimary" app:layout_constraintBottom_toTopOf="@+id/bottom_navigation" app:layout_constraintEnd_toEndOf="parent" app:srcCompat="@drawable/ic_profile_placeholder" app:tint="@color/white" tools:visibility="visible" /> <com.google.android.material.bottomnavigation.BottomNavigationView android:id="@+id/bottom_navigation" android:layout_width="0dp" android:layout_height="wrap_content" android:background="?android:attr/windowBackground" app:elevation="8dp" app:itemActiveIndicatorStyle="@null" app:itemIconTint="@color/bottom_nav_color_selector" app:itemTextColor="@color/bottom_nav_color_selector" app:labelVisibilityMode="labeled" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:menu="@menu/bottom_nav_menu" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_itinerary_adapter.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/main" android:layout_width="match_parent" android:layout_height="match_parent" tools:context=".ItineraryAdapter"> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_itinerary_item.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/main" android:layout_width="match_parent" android:layout_height="match_parent" tools:context=".ItineraryItem"> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_itinerary_log_detail.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".ItineraryLogDetailActivity"> <ImageView android:id="@+id/iv_back_arrow_log_detail" android:layout_width="74dp" android:layout_height="65dp" android:layout_marginStart="4dp" android:layout_marginTop="8dp" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:contentDescription="Back" android:focusable="true" android:padding="16dp" android:src="@drawable/left_back_button" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/colorPrimary" /> <!-- The ScrollView now extends to the bottom of the parent screen --> <ScrollView android:id="@+id/sv_log_detail_content" android:layout_width="0dp" android:layout_height="0dp" android:fillViewport="true" android:scrollbars="none" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/iv_back_arrow_log_detail"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="24dp" android:paddingTop="16dp" android:paddingEnd="24dp" android:paddingBottom="24dp"> <TextView android:id="@+id/tv_location_header_log_detail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/textPrimary" android:textSize="24sp" android:textStyle="bold" tools:text="Trip to Baguio City" /> <TextView android:id="@+id/tv_date_range_log_detail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:textColor="@color/text_secondary_dark" android:textSize="14sp" tools:text="April 23, 2024" /> <TextView android:id="@+id/tv_itinerary_log_header_log_detail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:text="Saved Itinerary" android:textColor="@color/textPrimary" android:textSize="22sp" android:textStyle="bold" /> <!-- This RecyclerView replaces the old static list --> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_itinerary_log" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:background="@drawable/bg_rounded_light_gray" android:nestedScrollingEnabled="false" android:paddingTop="4dp" android:paddingBottom="4dp" app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" tools:itemCount="5" tools:listitem="@layout/item_itinerary_log_entry_detail" /> </LinearLayout> </ScrollView> <!-- The BottomNavigationView has been removed. --> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_login.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" android:padding="24dp" tools:context=".LoginActivity"> <ImageView android:id="@+id/form_logo" android:layout_width="251dp" android:layout_height="150dp" android:layout_marginTop="60dp" android:contentDescription="@string/app_logo_description" android:src="@drawable/logo_black_text" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <TextView android:id="@+id/form_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:text="@string/login_title" android:textColor="@color/textColorPrimary" android:textSize="20sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_logo" /> <com.google.android.material.textfield.TextInputLayout android:id="@+id/email_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:hint="@string/email_hint" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_title"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/email_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textEmailAddress" /> </com.google.android.material.textfield.TextInputLayout> <com.google.android.material.textfield.TextInputLayout android:id="@+id/password_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:hint="@string/password_hint" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/email_layout" app:passwordToggleEnabled="true"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/password_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textPassword" /> </com.google.android.material.textfield.TextInputLayout> <Button android:id="@+id/login_button" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="56dp" android:backgroundTint="@color/colorPrimary" android:paddingTop="12dp" android:paddingBottom="12dp" android:text="@string/sign_in_button" android:textColor="@color/buttonTextColor" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintHorizontal_bias="0.0" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/password_layout" /> <TextView android:id="@+id/tv_forgot_password" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:text="Forgot Password?" android:textColor="@color/colorPrimary" android:textSize="14sp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintHorizontal_bias="0.0" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@+id/password_layout" /> <LinearLayout android:id="@+id/switch_to_signup_layout" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:orientation="horizontal" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/login_button"> <TextView android:id="@+id/prompt_no_account_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="4dp" android:text="@string/prompt_no_account" android:textColor="@color/textColorSecondary" /> <TextView android:id="@+id/link_sign_up_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="@string/link_sign_up" android:textColor="@color/colorPrimary" android:textStyle="bold" /> </LinearLayout> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_manual_location_picker.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context=".ManualLocationPickerActivity"> <androidx.appcompat.widget.Toolbar android:id="@+id/toolbar_manual_location" android:layout_width="0dp" android:layout_height="?attr/actionBarSize" android:background="?attr/colorPrimary" android:elevation="4dp" android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar" app:popupTheme="@style/ThemeOverlay.AppCompat.Light" app:layout_constraintTop_toTopOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent" /> <androidx.fragment.app.FragmentContainerView android:id="@+id/map_fragment_picker_container" android:name="com.google.android.gms.maps.SupportMapFragment" android:layout_width="0dp" android:layout_height="0dp" app:layout_constraintTop_toBottomOf="@id/toolbar_manual_location" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent" /> <androidx.cardview.widget.CardView android:id="@+id/search_bar_card_container" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginTop="8dp" android:layout_marginEnd="16dp" app:cardCornerRadius="8dp" app:cardElevation="6dp" app:layout_constraintTop_toBottomOf="@id/toolbar_manual_location" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent"> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content"> <EditText android:id="@+id/et_search_location" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginEnd="8dp" android:hint="Search or tap map to select" android:imeOptions="actionSearch" android:inputType="text" android:maxLines="1" android:background="@null" android:paddingTop="14dp" android:paddingBottom="14dp" app:layout_constraintTop_toTopOf="parent" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toStartOf="@+id/btn_clear_search" /> <ImageButton android:id="@+id/btn_clear_search" android:layout_width="wrap_content" android:layout_height="0dp" android:layout_marginEnd="8dp" android:src="@android:drawable/ic_menu_close_clear_cancel" app:tint="@color/textSecondary" android:background="?attr/selectableItemBackgroundBorderless" android:contentDescription="Clear Search Text" android:visibility="gone" tools:visibility="visible" app:layout_constraintTop_toTopOf="@id/et_search_location" app:layout_constraintBottom_toBottomOf="@id/et_search_location" app:layout_constraintEnd_toEndOf="parent"/> </androidx.constraintlayout.widget.ConstraintLayout> </androidx.cardview.widget.CardView> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_location_suggestions" android:layout_width="0dp" android:layout_height="wrap_content" android:background="#E6FFFFFF" android:elevation="5dp" android:visibility="gone" tools:visibility="gone" app:layout_constraintTop_toBottomOf="@id/search_bar_card_container" app:layout_constraintStart_toStartOf="@id/search_bar_card_container" app:layout_constraintEnd_toEndOf="@id/search_bar_card_container" app:layout_constraintHeight_max="240dp" app:layout_constrainedHeight="true" /> <com.google.android.material.floatingactionbutton.FloatingActionButton android:id="@+id/fab_picker_my_location" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="16dp" android:layout_marginBottom="16dp" android:src="@drawable/map" app:tint="@color/colorPrimary" app:backgroundTint="@color/white" app:elevation="6dp" app:layout_constraintBottom_toTopOf="@id/btn_confirm_location" app:layout_constraintEnd_toEndOf="parent" android:contentDescription="Go to my current location"/> <Button android:id="@+id/btn_confirm_location" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginEnd="16dp" android:layout_marginBottom="16dp" android:text="Confirm This Location" android:backgroundTint="@color/colorPrimary" android:textColor="@color/white" android:enabled="false" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent"/> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_maps.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/main_maps_coordinator_layout" android:layout_width="match_parent" android:layout_height="match_parent" tools:context=".MapsActivity"> <androidx.cardview.widget.CardView android:id="@+id/card_map_top_panel" android:layout_width="0dp" android:layout_height="wrap_content" app:cardElevation="4dp" app:cardPreventCornerOverlap="false" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="24dp" android:paddingTop="24dp" android:paddingEnd="24dp" android:paddingBottom="16dp"> <RelativeLayout android:layout_width="match_parent" android:layout_height="wrap_content"> <TextView android:id="@+id/tv_maps_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentStart="true" android:layout_centerVertical="true" android:text="Maps" android:textColor="@color/colorPrimary" android:textSize="32sp" android:textStyle="bold" /> <ImageButton android:id="@+id/btn_show_itinerary_route" android:layout_width="48dp" android:layout_height="48dp" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:background="?attr/selectableItemBackgroundBorderless" android:contentDescription="Show Itinerary Route" android:src="@drawable/ic_show_itinerary_route" app:tint="@color/colorPrimary" /> </RelativeLayout> <LinearLayout android:id="@+id/ll_current_direction" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:gravity="center_vertical" android:orientation="horizontal"> <ImageView android:id="@+id/iv_direction_icon" android:layout_width="30dp" android:layout_height="30dp" android:contentDescription="Current Direction" android:src="@drawable/ic_arrow_upward_circle" app:tint="@color/text_grey_dark" /> <TextView android:id="@+id/tv_direction_text" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="12dp" android:layout_weight="1" android:text="Loading map..." android:textColor="@color/text_grey_dark" android:textSize="15sp" /> </LinearLayout> </LinearLayout> </androidx.cardview.widget.CardView> <!-- Transportation Mode Selector --> <LinearLayout android:id="@+id/transport_mode_selector_container" android:layout_width="0dp" android:layout_height="wrap_content" android:background="@color/white" android:elevation="4dp" android:gravity="center_vertical" android:orientation="horizontal" android:paddingStart="12dp" android:paddingTop="8dp" android:paddingEnd="12dp" android:paddingBottom="8dp" android:visibility="gone" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/card_map_top_panel" tools:visibility="visible"> <LinearLayout android:id="@+id/btn_mode_walk_card" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:gravity="center" android:orientation="vertical" android:padding="8dp"> <ImageView android:id="@+id/iv_mode_walk" android:layout_width="24dp" android:layout_height="24dp" android:src="@drawable/ic_walk" app:tint="@color/colorPrimary" /> <TextView android:id="@+id/tv_mode_walk" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Walk" android:textColor="@color/colorPrimary" android:textSize="12sp" /> </LinearLayout> <LinearLayout android:id="@+id/btn_mode_taxi_card" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:gravity="center" android:orientation="vertical" android:padding="8dp"> <ImageView android:id="@+id/iv_mode_taxi" android:layout_width="24dp" android:layout_height="24dp" android:src="@drawable/ic_taxi" app:tint="@color/textSecondary" /> <TextView android:id="@+id/tv_mode_taxi" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Taxi" android:textColor="@color/textSecondary" android:textSize="12sp" /> </LinearLayout> <LinearLayout android:id="@+id/btn_mode_two_wheels_card" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:gravity="center" android:orientation="vertical" android:padding="8dp"> <ImageView android:id="@+id/iv_mode_two_wheels" android:layout_width="24dp" android:layout_height="24dp" android:src="@drawable/ic_bike" app:tint="@color/textSecondary" /> <TextView android:id="@+id/tv_mode_two_wheels" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="2-Wheels" android:textColor="@color/textSecondary" android:textSize="12sp" /> </LinearLayout> </LinearLayout> <!-- Google Map Fragment --> <androidx.fragment.app.FragmentContainerView android:id="@+id/map_fragment_container" android:name="com.google.android.gms.maps.SupportMapFragment" android:layout_width="0dp" android:layout_height="0dp" app:layout_constraintBottom_toTopOf="@id/bottom_navigation_maps_page" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/transport_mode_selector_container" /> <com.google.android.material.floatingactionbutton.FloatingActionButton android:id="@+id/fab_my_location" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="16dp" android:layout_marginBottom="16dp" android:contentDescription="My Location" android:src="@drawable/map" app:backgroundTint="@color/white" app:elevation="10dp" app:layout_constraintBottom_toTopOf="@id/route_info_pane" app:layout_constraintEnd_toEndOf="parent" app:tint="@color/green_brand_primary" /> <!-- Route Information Pane --> <androidx.cardview.widget.CardView android:id="@+id/route_info_pane" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginEnd="16dp" android:layout_marginBottom="@dimen/route_pane_margin_bottom" android:visibility="gone" app:cardCornerRadius="12dp" app:cardElevation="8dp" app:layout_constraintBottom_toTopOf="@id/bottom_navigation_maps_page" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" tools:visibility="visible"> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:padding="16dp"> <!-- Left Column: Text Info --> <TextView android:id="@+id/tv_route_eta" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/colorPrimary" android:textSize="20sp" android:textStyle="bold" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" tools:text="15 min" /> <TextView android:id="@+id/tv_route_distance" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:textColor="@color/textSecondary" android:textSize="16sp" app:layout_constraintBaseline_toBaselineOf="@id/tv_route_eta" app:layout_constraintStart_toEndOf="@id/tv_route_eta" tools:text="(1.2 km)" /> <TextView android:id="@+id/tv_route_itinerary_number" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="12dp" android:textColor="@color/textPrimary" android:textSize="16sp" android:textStyle="bold" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tv_route_eta" tools:text="1st location" /> <TextView android:id="@+id/tv_route_destination_name" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="2dp" android:layout_marginEnd="16dp" android:ellipsize="end" android:maxLines="2" android:textColor="@color/textSecondary" android:textSize="16sp" app:layout_constraintEnd_toStartOf="@+id/buttons_container" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tv_route_itinerary_number" tools:text="Burnham Park" /> <!-- Right Column: Buttons --> <LinearLayout android:id="@+id/buttons_container" android:layout_width="wrap_content" android:layout_height="wrap_content" android:gravity="center_horizontal" android:orientation="vertical" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="parent"> <Button android:id="@+id/btn_route_next" android:layout_width="match_parent" android:layout_height="wrap_content" android:text="Next" /> <Button android:id="@+id/btn_route_previous" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:enabled="false" android:text="Previous" android:textColor="@color/white" app:backgroundTint="@color/button_previous_tint_selector" /> </LinearLayout> </androidx.constraintlayout.widget.ConstraintLayout> </androidx.cardview.widget.CardView> <com.google.android.material.bottomnavigation.BottomNavigationView android:id="@+id/bottom_navigation_maps_page" android:layout_width="0dp" android:layout_height="wrap_content" android:background="?android:attr/windowBackground" app:elevation="8dp" app:itemActiveIndicatorStyle="@null" app:itemIconTint="@color/bottom_nav_color_selector" app:itemTextColor="@color/bottom_nav_color_selector" app:labelVisibilityMode="labeled" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:menu="@menu/bottom_nav_menu" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_place_details.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white"> <ImageView android:id="@+id/iv_back_arrow" android:layout_width="78dp" android:layout_height="85dp" android:layout_marginTop="8dp" android:contentDescription="Back" android:padding="16dp" android:src="@drawable/left_back_button" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <!-- The ScrollView's bottom constraint is now tied to the parent, allowing it to fill the screen --> <ScrollView android:id="@+id/scrollView" android:layout_width="0dp" android:layout_height="0dp" android:fillViewport="true" android:scrollbars="none" app:layout_constraintTop_toBottomOf="@id/iv_back_arrow" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="24dp" android:paddingEnd="24dp" android:paddingTop="8dp" android:paddingBottom="16dp"> <androidx.cardview.widget.CardView android:id="@+id/cv_park_image_container" android:layout_width="match_parent" android:layout_height="wrap_content" app:cardCornerRadius="15dp" app:cardElevation="0dp"> <ImageView android:id="@+id/iv_park_image" android:layout_width="match_parent" android:layout_height="200dp" android:scaleType="centerCrop" android:src="@drawable/burnham" android:contentDescription="Burnham Park Image" /> </androidx.cardview.widget.CardView> <TextView android:id="@+id/tv_park_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Burnham Park" android:textColor="@android:color/black" android:textSize="30sp" android:textStyle="bold" android:layout_marginTop="16dp" /> <LinearLayout android:layout_width="wrap_content" android:layout_height="wrap_content" android:orientation="horizontal" android:gravity="center_vertical" android:layout_marginTop="8dp"> <TextView android:id="@+id/tv_rating_label" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Rating: " android:textColor="@android:color/darker_gray" android:textSize="16sp"/> <TextView android:id="@+id/tv_rating_value" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="4.4" android:textColor="@android:color/black" android:textSize="16sp" android:textStyle="bold"/> <ImageView android:id="@+id/iv_rating_star" android:layout_width="20dp" android:layout_height="20dp" android:layout_marginStart="4dp" android:src="@drawable/star"/> <TextView android:id="@+id/tv_review_count" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="(31K)" android:textColor="@android:color/darker_gray" android:textSize="16sp" android:layout_marginStart="4dp"/> </LinearLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@android:color/darker_gray" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_about_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="About" android:textColor="@android:color/black" android:textSize="18sp" android:textStyle="bold" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_about_description" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Famous park for biking and riding a boat." android:textColor="@android:color/darker_gray" android:textSize="16sp" android:layout_marginTop="4dp"/> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@android:color/darker_gray" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_open_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Open" android:textColor="@android:color/black" android:textSize="18sp" android:textStyle="bold" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_open_description" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Open 24 hours." android:textColor="@android:color/darker_gray" android:textSize="16sp" android:layout_marginTop="4dp"/> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@android:color/darker_gray" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_best_time_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Best Time to Visit" android:textColor="@android:color/black" android:textSize="18sp" android:textStyle="bold" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_best_time_description" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="8:00 AM to 12:00 PM" android:textColor="@android:color/darker_gray" android:textSize="16sp" android:layout_marginTop="4dp"/> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@android:color/darker_gray" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_entrance_fee_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Entrance Fee" android:textColor="@android:color/black" android:textSize="18sp" android:textStyle="bold" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_entrance_fee_description" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Free" android:textColor="@android:color/darker_gray" android:textSize="16sp" android:layout_marginTop="4dp"/> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@android:color/darker_gray" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_view" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="View in Maps" android:textColor="#4CAF50" android:textSize="16sp" android:textStyle="bold" android:drawableEnd="@drawable/right_proceed_button" android:drawablePadding="8dp" android:gravity="center_vertical" android:layout_marginTop="16dp"/> <TextView android:id="@+id/tv_view_transportation" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="View in Mode of Transportation" android:textColor="#4CAF50" android:textSize="16sp" android:textStyle="bold" android:drawableEnd="@drawable/right_proceed_button" android:drawablePadding="8dp" android:gravity="center_vertical" android:layout_marginTop="12dp"/> </LinearLayout> </ScrollView> <!-- The BottomNavigationView has been removed. --> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_profile.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".ProfileActivity"> <!-- The main ScrollView that wraps everything --> <ScrollView android:id="@+id/scrollViewProfile" android:layout_width="0dp" android:layout_height="0dp" android:fillViewport="true" android:scrollbars="none" app:layout_constraintBottom_toTopOf="@id/bottom_navigation_profile_page" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent"> <!-- A ConstraintLayout to hold all the scrolling content --> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingBottom="16dp"> <!-- Header Section --> <View android:id="@+id/viewHeaderBackground" android:layout_width="0dp" android:layout_height="249dp" android:background="@drawable/profile_header_background" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <TextView android:id="@+id/tvProfileNameHeader" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="32dp" android:textColor="@android:color/white" android:textSize="28sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="@id/viewHeaderBackground" tools:text="Alice Go" /> <!-- Profile Image Container --> <FrameLayout android:id="@+id/flProfileImageContainer" android:layout_width="200dp" android:layout_height="200dp" android:layout_marginTop="50dp" android:elevation="8dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tvProfileNameHeader"> <ImageView android:id="@+id/ivProfileBackground" android:layout_width="match_parent" android:layout_height="match_parent" android:scaleType="fitXY" android:src="@drawable/circle_gradient_background" /> <ImageView android:id="@+id/ivProfileBorder" android:layout_width="match_parent" android:layout_height="match_parent" /> <ImageView android:id="@+id/ivProfileIcon" android:layout_width="100dp" android:layout_height="100dp" android:layout_gravity="center" android:contentDescription="Profile Picture" android:scaleType="fitCenter" android:src="@drawable/ic_profile_placeholder" /> </FrameLayout> <!-- THE FIX: This LinearLayout now correctly starts BELOW the profile image --> <LinearLayout android:id="@+id/details_container" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:orientation="vertical" android:paddingStart="16dp" android:paddingEnd="16dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@+id/flProfileImageContainer"> <!-- The "Complete Profile" prompt card will now appear correctly --> <androidx.cardview.widget.CardView android:id="@+id/card_complete_profile_prompt" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="16dp" android:visibility="gone" app:cardBackgroundColor="@color/light_teal_background" app:cardCornerRadius="8dp" app:cardElevation="2dp" tools:visibility="visible"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:padding="16dp"> <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Complete Your Profile" android:textColor="@color/colorPrimaryDarker" android:textSize="16sp" android:textStyle="bold" /> <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:text="@string/profile_completion_prompt" android:textColor="@color/text_secondary_dark" android:textSize="14sp" /> </LinearLayout> </androidx.cardview.widget.CardView> <!-- Name Row --> <RelativeLayout android:id="@+id/layoutName" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconName" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="Name Icon" android:src="@drawable/ic_profile" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfileNameDetail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toStartOf="@id/ivLogout" android:layout_toEndOf="@id/iconName" android:background="?attr/selectableItemBackground" android:padding="4dp" android:text="Alice Go" android:textColor="@color/black" android:textSize="16sp" /> <ImageView android:id="@+id/ivLogout" android:layout_width="24dp" android:layout_height="24dp" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:contentDescription="Logout" android:focusable="true" android:src="@drawable/ic_logout" app:tint="@color/colorPrimaryDarker" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> <!-- Birthday Row --> <RelativeLayout android:id="@+id/layoutBirthday" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconBirthday" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="Birthday Icon" android:src="@drawable/ic_calendar_today" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfileBirthday" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toEndOf="@id/iconBirthday" android:background="?attr/selectableItemBackground" android:padding="4dp" android:text="January 1, 2000" android:textColor="@color/textPrimary" android:textSize="16sp" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> <!-- Email Row --> <RelativeLayout android:id="@+id/layoutEmail" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconEmail" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="Email Icon" android:src="@drawable/ic_email" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfileEmail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toStartOf="@+id/tvEditEmail" android:layout_toEndOf="@id/iconEmail" android:padding="4dp" android:text="alicego@gmail.com" android:textColor="@color/textPrimary" android:textSize="16sp" /> <TextView android:id="@+id/tvEditEmail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:focusable="true" android:padding="4dp" android:text="edit" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" android:visibility="gone" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> <!-- Phone Row --> <RelativeLayout android:id="@+id/layoutPhone" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconPhone" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="Phone Icon" android:src="@drawable/ic_phone" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfilePhone" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toStartOf="@+id/tvEditPhone" android:layout_toEndOf="@id/iconPhone" android:background="?attr/selectableItemBackground" android:padding="4dp" android:text="09215687102" android:textColor="@color/textPrimary" android:textSize="16sp" /> <TextView android:id="@+id/tvEditPhone" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:focusable="true" android:padding="4dp" android:text="edit" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" android:visibility="gone" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> <!-- Password Row --> <RelativeLayout android:id="@+id/layoutPassword" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconPassword" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="Password Icon" android:src="@drawable/ic_visibility_on" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfilePassword" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toEndOf="@id/iconPassword" android:padding="4dp" android:text="************" android:textColor="@color/textPrimary" android:textSize="16sp" /> <LinearLayout android:id="@+id/layoutChangePassword" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:background="?attr/selectableItemBackgroundBorderless" android:clickable="true" android:focusable="true" android:orientation="horizontal" android:padding="4dp"> <ImageView android:layout_width="18dp" android:layout_height="18dp" android:layout_gravity="center_vertical" android:layout_marginEnd="4dp" android:contentDescription="Change Password Icon" android:src="@drawable/ic_visibility_on" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvChangePassword" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="change" android:textColor="@color/colorPrimary" android:textSize="14sp" /> </LinearLayout> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> <!-- History Row --> <RelativeLayout android:id="@+id/layoutHistory" android:layout_width="match_parent" android:layout_height="wrap_content" android:background="?attr/selectableItemBackground" android:clickable="true" android:focusable="true" android:paddingVertical="12dp"> <ImageView android:id="@+id/iconHistory" android:layout_width="24dp" android:layout_height="24dp" android:layout_centerVertical="true" android:layout_marginEnd="16dp" android:contentDescription="History Icon" android:src="@drawable/ic_history" app:tint="@color/colorPrimaryDarker" /> <TextView android:id="@+id/tvProfileHistory" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_centerVertical="true" android:layout_toEndOf="@id/iconHistory" android:padding="4dp" android:text="Location and Itinerary History" android:textColor="@color/textPrimary" android:textSize="16sp" /> </RelativeLayout> <View android:layout_width="match_parent" android:layout_height="1dp" android:background="@color/colorPrimaryDarker" /> </LinearLayout> </androidx.constraintlayout.widget.ConstraintLayout> </ScrollView> <!-- Bottom Navigation --> <com.google.android.material.bottomnavigation.BottomNavigationView android:id="@+id/bottom_navigation_profile_page" android:layout_width="0dp" android:layout_height="wrap_content" android:background="?android:attr/windowBackground" app:elevation="8dp" app:itemActiveIndicatorStyle="@null" app:itemIconTint="@color/bottom_nav_color_selector" app:itemTextColor="@color/bottom_nav_color_selector" app:labelVisibilityMode="labeled" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:menu="@menu/bottom_nav_menu" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_reset_password.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:padding="24dp" android:background="@color/white" tools:context=".ResetPasswordActivity"> <ImageView android:id="@+id/iv_back_arrow" android:layout_width="52dp" android:layout_height="52dp" android:layout_marginTop="4dp" android:contentDescription="Back" android:padding="8dp" android:src="@drawable/left_back_button" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <ImageView android:id="@+id/form_logo" android:layout_width="251dp" android:layout_height="150dp" android:layout_marginTop="60dp" android:contentDescription="@string/app_logo_description" android:src="@drawable/logo_black_text" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <TextView android:id="@+id/form_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:text="Reset your Password" android:textColor="@color/textColorPrimary" android:textSize="20sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_logo" /> <com.google.android.material.textfield.TextInputLayout android:id="@+id/email_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:hint="@string/email_hint" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_title"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/email_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textEmailAddress" /> </com.google.android.material.textfield.TextInputLayout> <!-- The password fields have been removed --> <Button android:id="@+id/reset_button" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:backgroundTint="@color/colorPrimary" android:paddingTop="12dp" android:paddingBottom="12dp" android:text="Send Reset Email" android:textColor="@color/buttonTextColor" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/email_layout" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_sign_up.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:padding="24dp" android:background="@color/white" tools:context=".SignUpActivity"> <ImageView android:id="@+id/form_logo" android:layout_width="251dp" android:layout_height="150dp" android:layout_marginTop="60dp" android:contentDescription="@string/app_logo_description" android:src="@drawable/logo_black_text" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <TextView android:id="@+id/form_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:text="@string/signup_title" android:textColor="@color/textColorPrimary" android:textSize="20sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_logo" /> <com.google.android.material.textfield.TextInputLayout android:id="@+id/email_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:hint="@string/email_hint" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/form_title"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/email_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textEmailAddress" /> </com.google.android.material.textfield.TextInputLayout> <com.google.android.material.textfield.TextInputLayout android:id="@+id/password_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:hint="@string/password_hint" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/email_layout" app:passwordToggleEnabled="true"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/password_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textPassword" /> </com.google.android.material.textfield.TextInputLayout> <com.google.android.material.textfield.TextInputLayout android:id="@+id/confirm_password_layout" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:hint="@string/confirm_password_hint" android:visibility="visible" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/password_layout" app:passwordToggleEnabled="true"> <com.google.android.material.textfield.TextInputEditText android:id="@+id/confirm_password_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textPassword" /> </com.google.android.material.textfield.TextInputLayout> <Button android:id="@+id/signup_button" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:backgroundTint="@color/colorPrimary" android:paddingTop="12dp" android:paddingBottom="12dp" android:text="@string/sign_up_button" android:textColor="@color/buttonTextColor" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/confirm_password_layout" /> <LinearLayout android:id="@+id/switch_to_login_layout" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:orientation="horizontal" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/signup_button"> <TextView android:id="@+id/prompt_have_account_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="4dp" android:text="@string/prompt_have_account" android:textColor="@color/textColorSecondary" /> <TextView android:id="@+id/link_sign_in_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="@string/link_sign_in" android:textColor="@color/colorPrimary" android:textStyle="bold" /> </LinearLayout> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_splash.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/colorPrimary" tools:context=".SplashActivity"> <ImageView android:id="@+id/splash_logo_only" android:layout_width="300dp" android:layout_height="300dp" android:src="@drawable/logo_white_text" android:contentDescription="@string/app_logo_description" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_transportation_mode.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@android:color/white" tools:context=".TransportationModeActivity"> <ScrollView android:id="@+id/sv_transport_content" android:layout_width="0dp" android:layout_height="0dp" android:fillViewport="true" app:layout_constraintTop_toTopOf="parent" app:layout_constraintBottom_toTopOf="@id/map_fragment_container_transport" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent"> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="24dp" android:paddingEnd="24dp" android:paddingTop="24dp" android:paddingBottom="24dp" android:clipToPadding="false"> <!-- Allows shadows from cards to extend into padding --> <TextView android:id="@+id/tv_transportation_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Transportation" android:textColor="@color/colorPrimary" android:textSize="32sp" android:textStyle="bold" /> <TextView android:id="@+id/tv_transportation_subtitle" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:text="Ways to Travel from Hotel Veniz to Burnham Park" android:textColor="@color/text_secondary_dark" android:textSize="16sp" /> <GridLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:columnCount="2" android:rowCount="3" android:alignmentMode="alignMargins" android:useDefaultMargins="true" android:padding="8dp"> <!-- Row 1, Item 1 --> <include android:id="@+id/transport_taxi" layout="@layout/item_transport_option" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_columnWeight="1" android:layout_gravity="fill_horizontal" /> <!-- Bus Card --> <include android:id="@+id/transport_bus" layout="@layout/item_transport_option" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_columnWeight="1" android:layout_gravity="fill_horizontal" /> <!-- Bike Card --> <include android:id="@+id/transport_bike" layout="@layout/item_transport_option" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_columnWeight="1" android:layout_gravity="fill_horizontal" /> <!-- Motorcycle Card --> <include android:id="@+id/transport_motorcycle" layout="@layout/item_transport_option" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_columnWeight="1" android:layout_gravity="fill_horizontal" /> <!-- Walk Card (Spanning two columns) --> <include android:id="@+id/transport_walk" layout="@layout/item_transport_option" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_columnSpan="2" android:layout_gravity="fill_horizontal" /> </GridLayout> </LinearLayout> </ScrollView> <FrameLayout android:id="@+id/map_fragment_container_transport" android:layout_width="0dp" android:layout_height="195dp" android:layout_marginStart="24dp" android:layout_marginEnd="24dp" android:layout_marginBottom="16dp" app:layout_constraintBottom_toTopOf="@id/bottom_navigation_transport_page" app:layout_constraintStart_toStartOf="parent" app:layout_constraintEnd_toEndOf="parent" /> <!-- Bottom Navigation --> <com.google.android.material.bottomnavigation.BottomNavigationView android:id="@+id/bottom_navigation_transport_page" android:layout_width="0dp" android:layout_height="wrap_content" android:background="?android:attr/windowBackground" app:elevation="8dp" app:itemIconTint="@color/bottom_nav_color_selector" app:itemTextColor="@color/bottom_nav_color_selector" app:labelVisibilityMode="labeled" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:menu="@menu/bottom_nav_menu" /> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_trip_history.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@color/white" tools:context=".TripHistoryActivity"> <ImageView android:id="@+id/iv_back_arrow_trip_history" android:layout_width="74dp" android:layout_height="65dp" android:contentDescription="Back" android:padding="16dp" android:src="@drawable/left_back_button" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/colorPrimary" /> <TextView android:id="@+id/tv_trip_history_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="24dp" android:layout_marginTop="16dp" android:text="Trip History" android:textColor="@color/colorPrimary" android:textSize="30sp" android:textStyle="bold" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/iv_back_arrow_trip_history" /> <!-- RecyclerView is now constrained to the bottom of the parent --> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_trip_history" android:layout_width="0dp" android:layout_height="0dp" android:layout_marginTop="16dp" android:clipToPadding="false" android:paddingBottom="8dp" app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tv_trip_history_title" tools:listitem="@layout/item_trip_history" /> <TextView android:id="@+id/tv_no_history_message" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="You haven't saved any trips yet." android:textColor="@color/textSecondary" android:textSize="16sp" android:visibility="gone" app:layout_constraintBottom_toBottomOf="@id/rv_trip_history" app:layout_constraintEnd_toEndOf="@id/rv_trip_history" app:layout_constraintStart_toStartOf="@id/rv_trip_history" app:layout_constraintTop_toTopOf="@id/rv_trip_history" tools:visibility="visible" /> <!-- The BottomNavigationView has been completely removed from this file. --> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\activity_welcome_page.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@drawable/gradient_background" android:padding="24dp"> <ImageView android:id="@+id/splash_image" android:layout_width="387dp" android:layout_height="421dp" android:scaleType="fitCenter" android:src="@drawable/undraw_map_cuix" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintHorizontal_bias="0.666" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:layout_constraintVertical_bias="0.0" /> <TextView android:id="@+id/title_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:fontFamily="@font/poppins_bold" android:lineSpacingExtra="6dp" android:text="Welcome to\nALAYA" android:textAlignment="center" android:textColor="@android:color/white" android:textSize="32sp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/splash_image" /> <TextView android:id="@+id/subtitle_text" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="20dp" android:fontFamily="@font/roboto_condensed_light_italic" android:text="Your journey, our guidance" android:textAlignment="center" android:textColor="@android:color/white" android:textSize="16sp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/title_text" /> <com.google.android.material.button.MaterialButton android:id="@+id/get_started_button" android:layout_width="0dp" android:layout_height="52dp" android:layout_marginStart="32dp" android:layout_marginEnd="32dp" android:layout_marginTop="24dp" app:backgroundTint="@android:color/white" android:fontFamily="@font/roboto_medium" android:text="Get Started" android:textColor="#09510D" android:textSize="16sp" app:cornerRadius="10dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/subtitle_text" app:layout_constraintWidth_max="298dp"/> </androidx.constraintlayout.widget.ConstraintLayout>
```

# app\src\main\res\layout\custom_info_window.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="wrap_content" android:layout_height="wrap_content" android:orientation="horizontal" android:background="@drawable/bg_button_white_rounded" android:padding="10dp" android:elevation="4dp"> <ImageView android:id="@+id/info_window_image" android:layout_width="80dp" android:layout_height="80dp" android:scaleType="centerCrop" android:src="@drawable/img_placeholder" android:visibility="gone" tools:visibility="visible" android:layout_marginEnd="10dp" android:contentDescription="Place Image" /> <LinearLayout android:layout_width="wrap_content" android:minWidth="180dp" android:layout_height="wrap_content" android:orientation="vertical"> <TextView android:id="@+id/info_window_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textStyle="bold" android:textColor="@color/textPrimary" android:textSize="16sp" tools:text="Place Name" /> <TextView android:id="@+id/info_window_category" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/textSecondary" android:textSize="13sp" tools:text="Category: Tourist Spot" android:layout_marginTop="4dp"/> <TextView android:id="@+id/info_window_rating" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/textSecondary" android:textSize="13sp" tools:text="Rating: 4.5 " android:layout_marginTop="2dp"/> <TextView android:id="@+id/info_window_open" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/textSecondary" android:textSize="13sp" tools:text="Open: 24 hours" android:layout_marginTop="2dp"/> </LinearLayout> </LinearLayout>
```

# app\src\main\res\layout\dialog_changes_saved.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="wrap_content" android:layout_height="wrap_content" xmlns:app="http://schemas.android.com/apk/res-auto" android:orientation="vertical" android:padding="32dp" android:gravity="center" android:background="@drawable/dialog_background_gradient_rounded"> <TextView android:id="@+id/tv_dialog_message" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Your changes have been saved successfully." android:textColor="@color/white" android:textSize="18sp" android:layout_marginBottom="24dp" android:gravity="center" /> /> <Button android:id="@+id/btn_dialog_continue" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="36dp" android:background="@drawable/bg_button_white_rounded" android:paddingStart="24dp" android:paddingEnd="24dp" android:text="Continue" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" android:textStyle="bold" app:backgroundTint="@null" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_customize_itinerary.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:padding="24dp"> <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginBottom="24dp" android:text="Customize Your Plan" android:textColor="@color/textPrimary" android:textSize="20sp" android:textStyle="bold" /> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:gravity="center_vertical" android:orientation="horizontal"> <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Number of Stops:" android:textColor="@color/textSecondary" android:textSize="16sp" /> <TextView android:id="@+id/tv_stop_count" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:gravity="end" android:textColor="@color/textPrimary" android:textSize="16sp" android:textStyle="bold" tools:text="4 Stops" /> </LinearLayout> <com.google.android.material.slider.Slider android:id="@+id/slider_stops" android:layout_width="match_parent" android:layout_height="wrap_content" android:stepSize="1.0" android:value="4.0" android:valueFrom="3.0" android:valueTo="6.0" app:labelBehavior="gone" /> <View android:layout_width="match_parent" android:layout_height="1dp" android:layout_marginTop="16dp" android:layout_marginBottom="16dp" android:background="#E0E0E0" /> <LinearLayout android:id="@+id/container_category_spinners" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" /> <Button android:id="@+id/btn_apply_and_generate" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:backgroundTint="@color/colorPrimary" android:paddingVertical="12dp" android:text="Apply and Generate" android:textColor="@color/white" app:cornerRadius="8dp" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_edit_text.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:padding="20dp"> <EditText android:id="@+id/et_dialog_input" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="textCapWords" android:hint="Enter location" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_enter_name.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:padding="24dp" android:background="@drawable/dialog_background_gradient_rounded" > <TextView android:id="@+id/dialog_title_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:text="What do you want us to call you?" android:textSize="20sp" android:fontFamily="@font/poppins_bold" android:textColor="@color/white" android:layout_marginBottom="20dp"/> <EditText android:id="@+id/dialog_name_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:hint="Name" android:inputType="textCapWords" android:background="@drawable/edittext_border_dialog" android:padding="12dp" android:textColor="@android:color/black" android:textColorHint="#888888" android:layout_marginBottom="24dp"/> <Button android:id="@+id/dialog_next_button" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="match_parent" android:layout_height="wrap_content" android:minHeight="48dp" android:text="Next" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:background="@drawable/bg_button_white_rounded" app:backgroundTint="@null" android:textSize="16sp" android:textStyle="bold" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_enter_phone.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content" android:padding="24dp" android:background="@drawable/dialog_background_gradient_rounded"> <TextView android:layout_width="match_parent" android:layout_height="wrap_content" android:text="What's your phone number?" android:textSize="20sp" android:fontFamily="@font/poppins_bold" android:textColor="@color/white" android:layout_marginBottom="8dp"/> <TextView android:layout_width="match_parent" android:layout_height="wrap_content" android:text="(Optional, for account recovery)" android:textColor="@color/white" android:alpha="0.8" android:textSize="14sp" android:layout_marginBottom="20dp"/> <EditText android:id="@+id/dialog_phone_edit_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:hint="e.g., 09123456789" android:inputType="phone" android:background="@drawable/edittext_border_dialog" android:padding="12dp" android:textColor="@android:color/black" android:textColorHint="#888888" android:layout_marginBottom="24dp"/> <Button android:id="@+id/btn_save_phone" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="match_parent" android:layout_height="wrap_content" android:minHeight="48dp" android:text="Save" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:background="@drawable/bg_button_white_rounded" app:backgroundTint="@null" android:textSize="16sp" android:textStyle="bold" /> <Button android:id="@+id/btn_skip_phone" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginTop="8dp" android:text="Skip" android:textColor="@color/white" android:alpha="0.9" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_location_notification.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center" android:background="@drawable/dialog_background_gradient_rounded" android:gravity="start|center_horizontal" android:minWidth="300dp" android:orientation="vertical" android:paddingStart="24dp" android:paddingTop="24dp" android:paddingEnd="24dp" android:paddingBottom="24dp" tools:context=".SignUpActivity"> <!-- Title TextView --> <TextView android:id="@+id/tv_dialog_title" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="12dp" android:text="For a better experience, your device will need to use Location Accuracy" android:textAlignment="viewStart" android:textColor="@color/white" android:textSize="18sp" android:textStyle="bold" /> <!-- Subtitle TextView --> <TextView android:id="@+id/tv_dialog_subtitle" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="16dp" android:text="The following setting should be on:" android:textAlignment="viewStart" android:textColor="@color/white" android:textSize="14sp" /> <!-- Device Location Item --> <TextView android:id="@+id/tv_device_location" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginBottom="24dp" android:drawableStart="@drawable/location_picture" android:drawablePadding="12dp" android:gravity="center_vertical" android:text="Device Location" android:textColor="@color/white" android:textSize="14sp" /> <!-- Turn On Button --> <Button android:id="@+id/btn_turn_on" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:minHeight="40dp" android:background="@drawable/bg_button_white_rounded" android:paddingStart="32dp" android:paddingTop="8dp" android:paddingEnd="32dp" android:paddingBottom="8dp" android:text="Turn on" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" app:backgroundTint="@null" /> <!-- NEW: Skip Button --> <Button android:id="@+id/btn_skip_location" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginTop="8dp" android:alpha="0.8" android:text="Skip for now" android:textColor="@color/white" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_prompt_birthday.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:orientation="vertical" android:layout_width="match_parent" android:layout_height="wrap_content" android:padding="24dp" android:background="@drawable/dialog_background_gradient_rounded"> <TextView android:layout_width="match_parent" android:layout_height="wrap_content" android:text="When is your birthday?" android:textSize="20sp" android:fontFamily="@font/poppins_bold" android:textColor="@color/white" android:layout_marginBottom="8dp"/> <TextView android:layout_width="match_parent" android:layout_height="wrap_content" android:text="(Optional, for a personalized experience)" android:textColor="@color/white" android:alpha="0.8" android:textSize="14sp" android:layout_marginBottom="24dp"/> <Button android:id="@+id/btn_select_date" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="match_parent" android:layout_height="wrap_content" android:minHeight="48dp" android:text="Select Date" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:background="@drawable/bg_button_white_rounded" app:backgroundTint="@null" android:textSize="16sp" android:textStyle="bold" /> <Button android:id="@+id/btn_skip_birthday" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center_horizontal" android:layout_marginTop="8dp" android:text="Skip" android:textColor="@color/white" android:alpha="0.9" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_success_password_change.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="wrap_content" android:layout_height="wrap_content" xmlns:app="http://schemas.android.com/apk/res-auto" android:orientation="vertical" android:padding="32dp" android:gravity="center" android:background="@drawable/dialog_background_gradient_rounded"> <!-- Updated message for the user --> <TextView android:id="@+id/tv_dialog_message" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Password reset email sent. Please check your inbox to complete the process." android:textColor="@color/white" android:textSize="18sp" android:layout_marginBottom="24dp" android:gravity="center" /> <!-- Updated button text --> <Button android:id="@+id/btn_dialog_continue" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="36dp" android:background="@drawable/bg_button_white_rounded" android:paddingStart="24dp" android:paddingEnd="24dp" android:text="OK" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" android:textStyle="bold" app:backgroundTint="@null" /> </LinearLayout>
```

# app\src\main\res\layout\dialog_welcome_alaya.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center" android:background="@drawable/dialog_background_gradient_rounded" android:gravity="center" android:orientation="vertical" android:paddingStart="32dp" android:paddingTop="32dp" android:paddingEnd="32dp" android:paddingBottom="32dp" tools:context=".MainActivity"> <!-- Title TextView --> <TextView android:id="@+id/tv_dialog_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginBottom="8dp" android:text="WELCOME TO ALAYA!" android:textAlignment="center" android:textAllCaps="true" android:textColor="@color/white" android:textSize="18sp" android:textStyle="bold" /> <!-- Subtitle TextView (Corrected Version) --> <TextView android:id="@+id/tv_dialog_subtitle" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginBottom="24dp" android:text="Click continue to proceed to your destination." android:textAlignment="center" android:textColor="@color/white" android:textSize="14sp" /> <!-- Clean closing tag --> <!-- Continue Button --> <Button android:id="@+id/btn_dialog_continue" style="@style/Widget.AppCompat.Button.Borderless" android:layout_width="wrap_content" android:layout_height="wrap_content" android:minHeight="40dp" android:background="@drawable/bg_button_white_rounded" android:paddingStart="24dp" android:paddingTop="8dp" android:paddingEnd="24dp" android:paddingBottom="8dp" android:text="Continue" android:textAllCaps="false" android:textColor="@color/colorPrimaryDarker" android:textSize="14sp" app:backgroundTint="@null" tools:ignore="DuplicateSpeakableTextCheck" /> </LinearLayout>
```

# app\src\main\res\layout\item_customize_spinner_row.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <com.google.android.material.textfield.TextInputLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/til_category_spinner" style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox.ExposedDropdownMenu" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="8dp" tools:hint="Stop 1"> <AutoCompleteTextView android:id="@+id/actv_category_spinner" android:layout_width="match_parent" android:layout_height="wrap_content" android:inputType="none" tools:ignore="LabelFor" /> </com.google.android.material.textfield.TextInputLayout>
```

# app\src\main\res\layout\item_itinerary_footer_message.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <TextView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/tv_footer_message" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingStart="16dp" android:paddingTop="12dp" android:paddingEnd="16dp" android:paddingBottom="12dp" android:textColor="@color/textSecondary" android:textSize="12sp" android:textStyle="italic" tools:text="This is a footer message or disclaimer." />
```

# app\src\main\res\layout\item_itinerary_header.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <TextView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/tv_section_header" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:layout_marginTop="24dp" android:layout_marginEnd="8dp" android:layout_marginBottom="8dp" android:textColor="@color/textPrimary" android:textSize="20sp" android:textStyle="bold" tools:text="Section Header" />
```

# app\src\main\res\layout\item_itinerary_horizontal_list.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <!-- This layout now includes a title for the section --> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical"> <TextView android:id="@+id/tv_horizontal_section_header" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginStart="20dp" android:layout_marginTop="24dp" android:layout_marginEnd="20dp" android:layout_marginBottom="8dp" android:textColor="@color/textPrimary" android:textSize="20sp" android:textStyle="bold" tools:text="Section Header" /> <androidx.recyclerview.widget.RecyclerView android:id="@+id/rv_horizontal" android:layout_width="match_parent" android:layout_height="wrap_content" android:clipToPadding="false" android:orientation="horizontal" android:paddingStart="12dp" android:paddingEnd="12dp" app:layoutManager="androidx.recyclerview.widget.LinearLayoutManager" tools:itemCount="4" tools:listitem="@layout/item_itinerary_recommended" /> </LinearLayout>
```

# app\src\main\res\layout\item_itinerary_location_header.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/ll_header_container" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="20dp" android:paddingTop="24dp" android:paddingEnd="20dp" android:paddingBottom="16dp"> <TextView android:id="@+id/tv_itineraries_title" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="@string/title_itineraries" android:textColor="@color/colorPrimary" android:textSize="34sp" android:textStyle="bold" /> <!-- NEW: Message/Disclaimer TextView --> <TextView android:id="@+id/tv_header_message" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:background="@drawable/bg_rounded_light_gray" android:padding="12dp" android:textColor="@color/text_secondary_dark" android:textSize="14sp" android:visibility="gone" tools:text="This is a sample message explaining why the itinerary was changed." tools:visibility="visible" /> <TextView android:id="@+id/tv_current_location_header" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="24dp" android:text="Current Location:" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold" /> <androidx.constraintlayout.widget.ConstraintLayout android:id="@+id/cl_location_container_itineraries" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:background="@drawable/bg_rounded_light_gray" android:padding="14dp"> <ImageView android:id="@+id/iv_location_icon_itineraries" android:layout_width="24dp" android:layout_height="24dp" android:contentDescription="Location Icon" android:src="@drawable/location" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/textPrimary" /> <TextView android:id="@+id/tv_location_city_itineraries" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="12dp" android:layout_marginEnd="8dp" android:textColor="@color/textPrimary" android:textSize="16sp" android:textStyle="bold" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toStartOf="@+id/ib_edit_location_itineraries" app:layout_constraintStart_toEndOf="@id/iv_location_icon_itineraries" app:layout_constraintTop_toTopOf="parent" tools:text="Tap to get current location" /> <ImageButton android:id="@+id/ib_edit_location_itineraries" android:layout_width="36dp" android:layout_height="36dp" android:background="?attr/selectableItemBackgroundBorderless" android:contentDescription="Edit Location" android:src="@drawable/edit" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/colorPrimary" /> </androidx.constraintlayout.widget.ConstraintLayout> <TextView android:id="@+id/tv_location_status_itineraries" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="4dp" android:textColor="@color/textSecondary" android:textSize="12sp" tools:text="Location status will show here" /> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:gravity="center_vertical" android:orientation="horizontal"> <Button android:id="@+id/btn_regenerate_itinerary" style="@style/Widget.MaterialComponents.Button.OutlinedButton" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:text="New Plan" android:textColor="@color/colorPrimary" app:strokeColor="@color/colorPrimary" /> <Button android:id="@+id/btn_customize_itinerary" style="@style/Widget.MaterialComponents.Button.OutlinedButton" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:layout_weight="1" android:text="Customize" android:textColor="@color/colorPrimary" app:strokeColor="@color/colorPrimary" /> <Button android:id="@+id/btn_clear_itinerary" style="@style/Widget.MaterialComponents.Button.TextButton" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:text="Clear" android:textColor="@color/colorErrorRed" /> </LinearLayout> </LinearLayout>
```

# app\src\main\res\layout\item_itinerary_log_entry_detail.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingStart="16dp" android:paddingEnd="16dp" android:paddingTop="10dp" android:paddingBottom="10dp"> <TextView android:id="@+id/tv_itinerary_time" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentStart="true" android:layout_centerVertical="true" android:text="9:00 AM" tools:text="9:00 AM" android:textColor="@color/black" android:textSize="14sp"/> <TextView android:id="@+id/tv_itinerary_activity" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_toEndOf="@id/tv_itinerary_time" android:layout_toStartOf="@+id/ll_rating_container_detail" android:layout_centerVertical="true" android:layout_marginStart="16dp" android:layout_marginEnd="8dp" android:text="Sample Activity Item" tools:text="Breakfast at Caf by the Ruins" android:textColor="@color/textPrimary" android:textSize="15sp"/> <LinearLayout android:id="@+id/ll_rating_container_detail" android:layout_width="wrap_content" android:layout_height="wrap_content" android:orientation="horizontal" android:gravity="center_vertical" android:layout_alignParentEnd="true" android:layout_centerVertical="true"> <TextView android:id="@+id/tv_itinerary_rating" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="4.5" tools:text="4.5" android:textColor="@color/textPrimary" android:textSize="14sp"/> <ImageView android:id="@+id/iv_itinerary_star" android:layout_width="16dp" android:layout_height="16dp" android:src="@drawable/star" android:layout_marginStart="3dp" android:contentDescription="Rating Star"/> </LinearLayout> </RelativeLayout>
```

# app\src\main\res\layout\item_itinerary_recommended.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="160dp" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:layout_marginEnd="8dp" android:layout_marginTop="4dp" android:layout_marginBottom="4dp" android:clickable="true" android:focusable="true" android:foreground="?android:attr/selectableItemBackground" app:cardBackgroundColor="@color/lightGrayBackground" app:cardCornerRadius="12dp" app:cardElevation="3dp" android:minHeight="80dp"> <!-- This is the fix --> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:padding="12dp"> <TextView android:id="@+id/tv_recommended_place_name" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="4dp" android:ellipsize="end" android:maxLines="2" android:textColor="@color/textPrimary" android:textSize="14sp" android:textStyle="bold" tools:text="Arca's Yard Cafe" /> <!-- I've added an ID to this LinearLayout --> <LinearLayout android:id="@+id/ll_rating_container" android:layout_width="match_parent" android:layout_height="wrap_content" android:gravity="center_vertical" android:orientation="horizontal"> <ImageView android:layout_width="14dp" android:layout_height="14dp" android:contentDescription="Rating Star" android:src="@drawable/star" app:tint="@color/starColor" /> <TextView android:id="@+id/tv_recommended_place_rating" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="4dp" android:textColor="@color/textSecondary" android:textSize="12sp" tools:text="3.0" /> <TextView android:id="@+id/tv_recommended_place_reviews" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="4dp" android:textColor="@color/textSecondary" android:textSize="12sp" tools:text="(1K)" /> </LinearLayout> </LinearLayout> </androidx.cardview.widget.CardView>
```

# app\src\main\res\layout\item_place_card.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginTop="8dp" android:layout_marginStart="8dp" android:layout_marginEnd="8dp" android:layout_marginBottom="4dp" app:cardCornerRadius="15dp" app:cardElevation="2dp" app:cardBackgroundColor="@color/lightGrayBackground" android:clickable="true" android:focusable="true" android:foreground="?android:attr/selectableItemBackground"> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:minHeight="96dp"> <ImageView android:id="@+id/iv_item_place_image" android:layout_width="100dp" android:layout_height="0dp" android:contentDescription="@string/content_desc_spot_image" android:scaleType="centerCrop" tools:src="@drawable/burnham" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /> <TextView android:id="@+id/tv_item_place_name" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginTop="12dp" android:layout_marginEnd="8dp" tools:text="Place Name That Is Potentially Very Long And Might Need To Wrap Or Ellipsize" android:textColor="@color/textPrimary" android:textSize="16sp" android:textStyle="bold" android:maxLines="2" android:ellipsize="end" app:layout_constraintStart_toEndOf="@id/iv_item_place_image" app:layout_constraintTop_toTopOf="parent" app:layout_constraintEnd_toStartOf="@+id/tv_item_place_distance"/> <ImageView android:id="@+id/iv_item_star" android:layout_width="16dp" android:layout_height="16dp" android:layout_marginTop="4dp" android:src="@drawable/star" app:tint="@color/starColor" app:layout_constraintStart_toStartOf="@id/tv_item_place_name" app:layout_constraintTop_toBottomOf="@id/tv_item_place_name" android:contentDescription="@string/content_desc_rating_star"/> <!-- Use string resource --> <TextView android:id="@+id/tv_item_place_rating" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="4dp" tools:text="4.4" android:textColor="@color/textSecondary" android:textSize="14sp" app:layout_constraintBottom_toBottomOf="@id/iv_item_star" app:layout_constraintStart_toEndOf="@id/iv_item_star" app:layout_constraintTop_toTopOf="@id/iv_item_star" /> <TextView android:id="@+id/tv_item_place_reviews" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="4dp" tools:text="(31K)" android:textColor="@color/textSecondary" android:textSize="14sp" app:layout_constraintBottom_toBottomOf="@id/tv_item_place_rating" app:layout_constraintStart_toEndOf="@id/tv_item_place_rating" app:layout_constraintTop_toTopOf="@id/tv_item_place_rating" /> <TextView android:id="@+id/tv_item_place_distance" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="16dp" tools:text="0.5 km" android:textColor="@color/textSecondary" android:textSize="14sp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="@id/tv_item_place_name" app:layout_constraintBottom_toBottomOf="@id/tv_item_place_name"/> </androidx.constraintlayout.widget.ConstraintLayout> </androidx.cardview.widget.CardView>
```

# app\src\main\res\layout\item_transport_option.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="0dp" android:layout_height="90dp" android:orientation="vertical" android:padding="12dp" android:background="@drawable/bg_transport_card" android:layout_gravity="fill_horizontal" android:clickable="true" android:focusable="true" tools:layout_width="150dp" tools:layout_height="90dp"> <RelativeLayout android:layout_width="match_parent" android:layout_height="wrap_content"> <TextView android:id="@+id/tv_transport_name" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentStart="true" android:layout_centerVertical="true" tools:text="Taxi" android:textColor="@color/text_secondary_dark" android:textSize="16sp" android:textStyle="bold" /> <TextView android:id="@+id/tv_transport_badge" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_alignParentEnd="true" android:layout_centerVertical="true" android:paddingStart="6dp" android:paddingEnd="6dp" android:paddingTop="2dp" android:paddingBottom="2dp" tools:text="Best!" tools:background="@drawable/bg_best_badge" tools:textColor="@color/badge_best_text" android:textSize="10sp" android:textStyle="bold" android:visibility="gone" tools:visibility="visible"/> </RelativeLayout> <LinearLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="horizontal" android:layout_marginTop="8dp" android:gravity="center_vertical"> <ImageView android:id="@+id/iv_transport_icon" android:layout_width="24dp" android:layout_height="24dp" tools:src="@drawable/ic_taxi" app:tint="@color/colorPrimary" /> <TextView android:id="@+id/tv_transport_duration" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="8dp" tools:text="5 mins" android:textColor="@android:color/darker_gray" android:textSize="14sp"/> <TextView android:id="@+id/tv_transport_price" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_weight="1" android:gravity="end" tools:text="30 - 50" android:textColor="@android:color/darker_gray" android:textSize="14sp" android:textStyle="bold"/> </LinearLayout> </LinearLayout>
```

# app\src\main\res\layout\item_trip_history.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingHorizontal="16dp"> <TextView android:id="@+id/tv_month_year_header" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="16dp" android:layout_marginBottom="8dp" android:textAllCaps="true" android:textColor="@color/textSecondary" android:textSize="14sp" android:textStyle="bold" tools:text="APRIL 2024" /> <!-- THE FIX IS HERE: The ID has no space after the slash --> <androidx.cardview.widget.CardView android:id="@+id/card_trip_item" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginBottom="8dp" android:clickable="true" android:focusable="true" android:foreground="?attr/selectableItemBackground" app:cardCornerRadius="12dp" app:cardElevation="3dp"> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:padding="16dp"> <ImageView android:id="@+id/iv_icon_trip" android:layout_width="24dp" android:layout_height="24dp" android:contentDescription="Location" android:src="@drawable/location" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/textPrimary" /> <TextView android:id="@+id/tv_name_trip" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginEnd="8dp" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold" app:layout_constraintEnd_toStartOf="@+id/iv_view_arrow" app:layout_constraintStart_toEndOf="@id/iv_icon_trip" app:layout_constraintTop_toTopOf="parent" tools:text="Trip to Baguio City" /> <TextView android:id="@+id/tv_date_trip" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="2dp" android:textColor="@color/textSecondary" android:textSize="14sp" app:layout_constraintEnd_toEndOf="@id/tv_name_trip" app:layout_constraintStart_toStartOf="@id/tv_name_trip" app:layout_constraintTop_toBottomOf="@id/tv_name_trip" tools:text="April 23, 2024" /> <TextView android:id="@+id/tv_itinerary_preview" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginTop="6dp" android:ellipsize="end" android:maxLines="2" android:textColor="@color/textSecondary" android:textSize="12sp" android:textStyle="italic" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="@id/tv_date_trip" app:layout_constraintStart_toStartOf="@id/tv_date_trip" app:layout_constraintTop_toBottomOf="@id/tv_date_trip" tools:text="Starts with: Burnham Park, Caf by the Ruins..." /> <ImageView android:id="@+id/iv_view_arrow" android:layout_width="24dp" android:layout_height="24dp" android:src="@drawable/right_proceed_button" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="parent" app:tint="@color/text_secondary_dark" /> </androidx.constraintlayout.widget.ConstraintLayout> </androidx.cardview.widget.CardView> </LinearLayout>
```

# app\src\main\res\layout\list_item_itinerary.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginStart="8dp" android:layout_marginTop="8dp" android:layout_marginEnd="8dp" android:layout_marginBottom="8dp" app:cardCornerRadius="12dp" app:cardElevation="4dp"> <androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content"> <!-- Number Indicator --> <TextView android:id="@+id/tv_item_number" android:layout_width="24dp" android:layout_height="24dp" android:layout_marginTop="12dp" android:layout_marginEnd="12dp" android:background="@drawable/bg_itinerary_number_indicator" android:gravity="center" android:textColor="@color/white" android:textSize="12sp" android:textStyle="bold" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="parent" tools:text="1" /> <TextView android:id="@+id/tv_item_activity" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginTop="16dp" android:layout_marginEnd="8dp" android:textColor="@color/textPrimary" android:textSize="18sp" android:textStyle="bold" app:layout_constraintEnd_toStartOf="@+id/tv_item_number" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" tools:text="Breakfast at Caf by the Ruins" /> <ImageView android:id="@+id/iv_item_image" android:layout_width="0dp" android:layout_height="180dp" android:layout_marginTop="12dp" android:contentDescription="Image of the location" android:scaleType="centerCrop" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/tv_item_activity" tools:src="@drawable/burnham" /> <TextView android:id="@+id/tv_item_time" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginStart="16dp" android:layout_marginTop="12dp" android:layout_marginBottom="16dp" android:drawableStart="@drawable/ic_calendar_today" android:drawablePadding="6dp" android:gravity="center_vertical" android:textColor="@color/textSecondary" android:textSize="14sp" app:drawableTint="@color/textSecondary" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@id/iv_item_image" tools:text="9:00 AM" /> <TextView android:id="@+id/tv_item_rating" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginEnd="16dp" android:drawableStart="@drawable/star" android:drawablePadding="6dp" android:gravity="center_vertical" android:textColor="@color/textSecondary" android:textSize="14sp" app:drawableTint="@color/starColor" app:layout_constraintBottom_toBottomOf="@id/tv_item_time" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintTop_toTopOf="@id/tv_item_time" tools:text="4.5" /> </androidx.constraintlayout.widget.ConstraintLayout> </androidx.cardview.widget.CardView>
```

# app\src\main\res\layout\list_item_location_suggestion.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="wrap_content" android:orientation="vertical" android:paddingStart="16dp" android:paddingTop="10dp" android:paddingEnd="16dp" android:paddingBottom="10dp" android:background="?attr/selectableItemBackground"> <TextView android:id="@+id/tv_suggestion_main_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:textSize="16sp" android:textColor="@android:color/black" android:maxLines="1" android:ellipsize="end"/> <TextView android:id="@+id/tv_suggestion_secondary_text" android:layout_width="match_parent" android:layout_height="wrap_content" android:textSize="13sp" android:textColor="@android:color/darker_gray" android:maxLines="1" android:ellipsize="end" android:visibility="gone"/> </LinearLayout>
```

# app\src\main\res\menu\bottom_nav_menu.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <menu xmlns:android="http://schemas.android.com/apk/res/android"> <item android:id="@+id/navigation_home" android:icon="@drawable/home" android:title="@string/title_home" /> <item android:id="@+id/navigation_itineraries" android:icon="@drawable/iteneraries" android:title="@string/title_itineraries" /> <item android:id="@+id/navigation_map" android:icon="@drawable/map" android:title="@string/title_map" /> <item android:id="@+id/navigation_profile" android:icon="@drawable/profile" android:title="@string/title_profile" /> </menu>
```

# app\src\main\res\mipmap-anydpi-v26\ic_launcher_round.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android"> <background android:drawable="@drawable/ic_launcher_background" /> <foreground android:drawable="@drawable/logo_white_text" /> <monochrome android:drawable="@drawable/logo_white_text" /> </adaptive-icon>
```

# app\src\main\res\mipmap-anydpi-v26\ic_launcher.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <adaptive-icon xmlns:android="http://schemas.android.com/apk/res/android"> <background android:drawable="@drawable/ic_launcher_background" /> <foreground android:drawable="@drawable/logo_white_text" /> <monochrome android:drawable="@drawable/logo_white_text" /> </adaptive-icon>
```

# app\src\main\res\mipmap-hdpi\ic_launcher_round.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-hdpi\ic_launcher.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-mdpi\ic_launcher_round.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-mdpi\ic_launcher.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xhdpi\ic_launcher_round.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xhdpi\ic_launcher.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xxhdpi\ic_launcher_round.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xxhdpi\ic_launcher.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xxxhdpi\ic_launcher_round.webp

This is a binary file of the type: Image

# app\src\main\res\mipmap-xxxhdpi\ic_launcher.webp

This is a binary file of the type: Image

# app\src\main\res\values-night\themes.xml

```xml
<resources xmlns:tools="http://schemas.android.com/tools"> <!-- Base application theme. --> <style name="Base.Theme.AlayaApp" parent="Theme.Material3.DayNight.NoActionBar"> <!-- Customize your dark theme here. --> <!-- <item name="colorPrimary">@color/my_dark_primary</item> --> </style> </resources>
```

# app\src\main\res\values\colors.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <resources> <color name="black">#FF000000</color> <color name="colorPrimary">#3f9453</color> <color name="colorPrimaryDark">#2E7D32</color> <color name="buttonTextColor">#FFFFFF</color> <color name="textColorPrimary">#DE000000</color> <color name="textColorSecondary">#8A000000</color> <color name="myButtonColor">#D9D9D9</color> <color name="myButtonTextColor">#FFFFFF</color> <color name="colorPrimaryDarker">#00642C</color> <color name="textPrimary">#212121</color> <color name="textSecondary">#757575</color> <color name="lightGrayBackground">#F0F0F0</color> <color name="white">#FFFFFF</color> <color name="starColor">#FFC107</color> <color name="your_primary_color">#3f9453</color> <color name="your_variant">#2E7D32</color> <color name="green_brand_primary">#4F7942</color> <color name="text_secondary_dark">#424242</color> <color name="badge_best_text">#00796B</color> <color name="badge_fastest_text">#1E88E5</color> <color name="light_grey_background">#F5F5F5</color> <color name="light_teal_background">#E0F2F1</color> <color name="light_blue_background">#E3F2FD</color> <color name="text_black_primary">#212121</color> <color name="text_grey_dark">#424242</color> <color name="text_grey_medium">#757575</color> <color name="map_route_blue">#4285F4</color> <color name="map_overlay_color">#99808080</color> <color name="colorErrorRed">#D32F2F</color> <!-- ADDED FOR THE DISABLED PREVIOUS BUTTON --> <color name="button_disabled_grey">#BDBDBD</color> </resources>
```

# app\src\main\res\values\dimens.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <resources> <dimen name="route_pane_margin_bottom">8dp</dimen> </resources>
```

# app\src\main\res\values\font_certs.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <resources> <array name="com_google_android_gms_fonts_certs"> <item>@array/com_google_android_gms_fonts_certs_dev</item> <item>@array/com_google_android_gms_fonts_certs_prod</item> </array> <string-array name="com_google_android_gms_fonts_certs_dev"> <item> MIIEqDCCA5CgAwIBAgIJANWFuGx90071MA0GCSqGSIb3DQEBBAUAMIGUMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEQMA4GA1UEChMHQW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDEiMCAGCSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbTAeFw0wODA0MTUyMzM2NTZaFw0zNTA5MDEyMzM2NTZaMIGUMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEQMA4GA1UEChMHQW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDEiMCAGCSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbTCCASAwDQYJKoZIhvcNAQEBBQADggENADCCAQgCggEBANbOLggKv+IxTdGNs8/TGFy0PTP6DHThvbbR24kT9ixcOd9W+EaBPWW+wPPKQmsHxajtWjmQwWfna8mZuSeJS48LIgAZlKkpFeVyxW0qMBujb8X8ETrWy550NaFtI6t9+u7hZeTfHwqNvacKhp1RbE6dBRGWynwMVX8XW8N1+UjFaq6GCJukT4qmpN2afb8sCjUigq0GuMwYXrFVee74bQgLHWGJwPmvmLHC69EH6kWr22ijx4OKXlSIx2xT1AsSHee70w5iDBiK4aph27yH3TxkXy9V89TDdexAcKk/cVHYNnDBapcavl7y0RiQ4biu8ymM8Ga/nmzhRKya6G0cGw8CAQOjgfwwgfkwHQYDVR0OBBYEFI0cxb6VTEM8YYY6FbBMvAPyT+CyMIHJBgNVHSMEgcEwgb6AFI0cxb6VTEM8YYY6FbBMvAPyT+CyoYGapIGXMIGUMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEQMA4GA1UEChMHQW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDEiMCAGCSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbYIJANWFuGx90071MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEEBQADggEBABnTDPEF+3iSP0wNfdIjIz1AlnrPzgAIHVvXxunW7SBrDhEglQZBbKJEk5kT0mtKoOD1JMrSu1xuTKEBahWRbqHsXclaXjoBADb0kkjVEJu/Lh5hgYZnOjvlba8Ld7HCKePCVePoTJBdI4fvugnL8TsgK05aIskyY0hKI9L8KfqfGTl1lzOv2KoWD0KWwtAWPoGChZxmQ+nBli+gwYMzM1vAkP+aayLe0a1EQimlOalO762r0GXO0ks+UeXde2Z4e+8S/pf7pITEI/tP+MxJTALw9QUWEv9lKTk+jkbqxbsh8nfBUapfKqYn0eidpwq2AzVp3juYl7//fKnaPhJD9gs= </item> </string-array> <string-array name="com_google_android_gms_fonts_certs_prod"> <item> MIIEQzCCAyugAwIBAgIJAMLgh0ZkSjCNMA0GCSqGSIb3DQEBBAUAMHQxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtHb29nbGUgSW5jLjEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDAeFw0wODA4MjEyMzEzMzRaFw0zNjAxMDcyMzEzMzRaMHQxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtHb29nbGUgSW5jLjEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDCCASAwDQYJKoZIhvcNAQEBBQADggENADCCAQgCggEBAKtWLgDYO6IIrgqWbxJOKdoR8qtW0I9Y4sypEwPpt1TTcvZApxsdyxMJZ2JORland2qSGT2y5b+3JKkedxiLDmpHpDsz2WCbdxgxRczfey5YZnTJ4VZbH0xqWVW/8lGmPav5xVwnIiJS6HXk+BVKZF+JcWjAsb/GEuq/eFdpuzSqeYTcfi6idkyugwfYwXFU1+5fZKUaRKYCwkkFQVfcAs1fXA5V+++FGfvjJ/CxURaSxaBvGdGDhfXE28LWuT9ozCl5xw4Yq5OGazvV24mZVSoOO0yZ31j7kYvtwYK6NeADwbSxDdJEqO4k//0zOHKrUiGYXtqw/A0LFFtqoZKFjnkCAQOjgdkwgdYwHQYDVR0OBBYEFMd9jMIhF1Ylmn/Tgt9r45jk14alMIGmBgNVHSMEgZ4wgZuAFMd9jMIhF1Ylmn/Tgt9r45jk14aloXikdjB0MQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLR29vZ2xlIEluYy4xEDAOBgNVBAsTB0FuZHJvaWQxEDAOBgNVBAMTB0FuZHJvaWSCCQDC4IdGZEowjTAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBAUAA4IBAQBt0lLO74UwLDYKqs6Tm8/yzKkEu116FmH4rkaymUIE0P9KaMftGlMexFlaYjzmB2OxZyl6euNXEsQH8gjwyxCUKRJNexBiGcCEyj6z+a1fuHHvkiaai+KL8W1EyNmgjmyy8AW7P+LLlkR+ho5zEHatRbM/YAnqGcFh5iZBqpknHf1SKMXFh4dd239FJ1jWYfbMDMy3NS5CTMQ2XFI1MvcyUTdZPErjQfTbQe3aDQsQcafEQPD+nqActifKZ0Np0IS9L9kR/wbNvyz6ENwPiTrjV2KRkEjH78ZMcUQXg0L3BYHJ3lc69Vs5Ddf9uUGGMYldX3WfMBEmh/9iFBDAaTCK </item> </string-array> </resources>
```

# app\src\main\res\values\preloaded_fonts.xml

```xml
<?xml version="1.0" encoding="utf-8"?> <resources> <array name="preloaded_fonts" translatable="false"> <item>@font/roboto_bold</item> <item>@font/roboto_thin</item> </array> </resources>
```

# app\src\main\res\values\strings.xml

```xml
<resources> <string name="app_name">AlayaApp</string> <string name="app_logo_description">AlayaApp Logo</string> <string name="email_hint">Email</string> <string name="password_hint">Password</string> <string name="confirm_password_hint">Confirm Password</string> <string name="login_title">Login to your Account</string> <string name="signup_title">Create your Account</string> <string name="sign_in_button">Sign In</string> <string name="sign_up_button">Sign Up</string> <string name="prompt_no_account">Don\'t have an account?</string> <string name="prompt_have_account">Already have an account?</string> <string name="link_sign_up">Sign Up</string> <string name="link_sign_in">Sign In</string> <string name="title_home">Home</string> <string name="title_itineraries">Itineraries</string> <string name="title_map">Map</string> <string name="title_profile">Profile</string> <string name="content_description_back_arrow">Back</string> <string name="preview_transport_name_taxi">Taxi</string> <string name="preview_transport_badge_best">Best!</string> <string name="preview_transport_duration_5mins">5 mins</string> <string name="preview_transport_price_30_50">30 - 50</string> <string name="content_desc_spot_image">Image of the tourist spot</string> <string name="content_desc_rating_star">Rating star icon</string> <string name="profile_completion_prompt">Add your remaining details for a more personalized experience and easier trip planning.</string> </resources>
```

# app\src\main\res\values\themes.xml

```xml
<resources xmlns:tools="http://schemas.android.com/tools"> <style name="Base.Theme.AlayaApp" parent="Theme.Material3.DayNight.NoActionBar"> <item name="colorPrimary">@color/colorPrimary</item> <item name="colorPrimaryVariant">@color/colorPrimaryDark</item> <item name="colorOnPrimary">@color/white</item> <item name="android:statusBarColor">?attr/colorPrimaryVariant</item> </style> <style name="Theme.AlayaApp" parent="Base.Theme.AlayaApp" /> <style name="Theme.AlayaApp.SplashImitation" parent="Theme.Material3.DayNight.NoActionBar"> <item name="android:windowBackground">@color/colorPrimary</item> <item name="android:statusBarColor">@color/colorPrimary</item> <item name="android:windowLightStatusBar" tools:targetApi="m">false</item> </style> <style name="TransparentDialog" parent="Theme.AppCompat.Light.Dialog.Alert"> <item name="android:windowBackground">@android:color/transparent</item> </style> </resources>
```

# app\src\main\res\xml\backup_rules.xml

```xml
<?xml version="1.0" encoding="utf-8"?><!-- Sample backup rules file; uncomment and customize as necessary. See https://developer.android.com/guide/topics/data/autobackup for details. Note: This file is ignored for devices older that API 31 See https://developer.android.com/about/versions/12/backup-restore --> <full-backup-content> <!-- <include domain="sharedpref" path="."/> <exclude domain="sharedpref" path="device.xml"/> --> </full-backup-content>
```

# app\src\main\res\xml\data_extraction_rules.xml

```xml
<?xml version="1.0" encoding="utf-8"?><!-- Sample data extraction rules file; uncomment and customize as necessary. See https://developer.android.com/about/versions/12/backup-restore#xml-changes for details. --> <data-extraction-rules> <cloud-backup> <!-- TODO: Use <include> and <exclude> to control what is backed up. <include .../> <exclude .../> --> </cloud-backup> <!-- <device-transfer> <include .../> <exclude .../> </device-transfer> --> </data-extraction-rules>
```

# app\src\test\java\com\example\alayaapp\ExampleUnitTest.java

```java
package com.example.alayaapp; import org.junit.Test; import static org.junit.Assert.*; /** * Example local unit test, which will execute on the development machine (host). * * @see <a href="http://d.android.com/tools/testing">Testing documentation</a> */ public class ExampleUnitTest { @Test public void addition_isCorrect() { assertEquals(4, 2 + 2); } }
```

# build.gradle.kts

```kts
// Top-level build file where you can add configuration options common to all sub-projects/modules. plugins { alias(libs.plugins.android.application) apply false id("com.google.gms.google-services") version "4.4.1" apply false }
```

# gradle.properties

```properties
# Project-wide Gradle settings. # IDE (e.g. Android Studio) users: # Gradle settings configured through the IDE *will override* # any settings specified in this file. # For more details on how to configure your build environment visit # http://www.gradle.org/docs/current/userguide/build_environment.html # Specifies the JVM arguments used for the daemon process. # The setting is particularly useful for tweaking memory settings. org.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8 # When configured, Gradle will run in incubating parallel mode. # This option should only be used with decoupled projects. For more details, visit # https://developer.android.com/r/tools/gradle-multi-project-decoupled-projects # org.gradle.parallel=true # AndroidX package structure to make it clearer which packages are bundled with the # Android operating system, and which are packaged with your app's APK # https://developer.android.com/topic/libraries/support-library/androidx-rn android.useAndroidX=true # Enables namespacing of each library's R class so that its R class includes only the # resources declared in the library itself and none from the library's dependencies, # thereby reducing the size of the R class for that library android.nonTransitiveRClass=true
```

# gradle\libs.versions.toml

```toml
[versions] agp = "8.9.2" # UPDATED to a recent stable AGP version (e.g., 8.4.1, check latest stable if needed) junit = "4.13.2" junitVersion = "1.1.5" espressoCore = "3.5.1" appcompat = "1.6.1" material = "1.10.0" activity = "1.8.0" constraintlayout = "2.1.4" playServicesMaps = "19.2.0" # This seems a bit old, current is 18.2.0. But let's keep if it works. playServicesLocation = "21.3.0" mapsUtils = "3.4.0" # UPDATED to a common stable version for android-maps-utils [libraries] junit = { group = "junit", name = "junit", version.ref = "junit" } ext-junit = { group = "androidx.test.ext", name = "junit", version.ref = "junitVersion" } espresso-core = { group = "androidx.test.espresso", name = "espresso-core", version.ref = "espressoCore" } appcompat = { group = "androidx.appcompat", name = "appcompat", version.ref = "appcompat" } material = { group = "com.google.android.material", name = "material", version.ref = "material" } activity = { group = "androidx.activity", name = "activity", version.ref = "activity" } constraintlayout = { group = "androidx.constraintlayout", name = "constraintlayout", version.ref = "constraintlayout" } play-services-maps = { group = "com.google.android.gms", name = "play-services-maps", version.ref = "playServicesMaps" } play-services-location = { group = "com.google.android.gms", name = "play-services-location", version.ref = "playServicesLocation" } maps-utils = { group = "com.google.maps.android", name = "android-maps-utils", version.ref = "mapsUtils" } # Make sure this line is correct [plugins] android-application = { id = "com.android.application", version.ref = "agp" }
```

# gradle\wrapper\gradle-wrapper.jar

This is a binary file of the type: Binary

# gradle\wrapper\gradle-wrapper.properties

```properties
#Mon Apr 21 17:43:17 SGT 2025 distributionBase=GRADLE_USER_HOME distributionPath=wrapper/dists distributionUrl=https\://services.gradle.org/distributions/gradle-8.11.1-bin.zip zipStoreBase=GRADLE_USER_HOME zipStorePath=wrapper/dists
```

# gradlew

```
#!/usr/bin/env sh # # Copyright 2015 the original author or authors. # # Licensed under the Apache License, Version 2.0 (the "License"); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # https://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an "AS IS" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. # ############################################################################## ## ## Gradle start up script for UN*X ## ############################################################################## # Attempt to set APP_HOME # Resolve links: $0 may be a link PRG="$0" # Need this for relative symlinks. while [ -h "$PRG" ] ; do ls=`ls -ld "$PRG"` link=`expr "$ls" : '.*-> \(.*\)$'` if expr "$link" : '/.*' > /dev/null; then PRG="$link" else PRG=`dirname "$PRG"`"/$link" fi done SAVED="`pwd`" cd "`dirname \"$PRG\"`/" >/dev/null APP_HOME="`pwd -P`" cd "$SAVED" >/dev/null APP_NAME="Gradle" APP_BASE_NAME=`basename "$0"` # Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script. DEFAULT_JVM_OPTS='"-Xmx64m" "-Xms64m"' # Use the maximum available, or set MAX_FD != -1 to use that value. MAX_FD="maximum" warn () { echo "$*" } die () { echo echo "$*" echo exit 1 } # OS specific support (must be 'true' or 'false'). cygwin=false msys=false darwin=false nonstop=false case "`uname`" in CYGWIN* ) cygwin=true ;; Darwin* ) darwin=true ;; MINGW* ) msys=true ;; NONSTOP* ) nonstop=true ;; esac CLASSPATH=$APP_HOME/gradle/wrapper/gradle-wrapper.jar # Determine the Java command to use to start the JVM. if [ -n "$JAVA_HOME" ] ; then if [ -x "$JAVA_HOME/jre/sh/java" ] ; then # IBM's JDK on AIX uses strange locations for the executables JAVACMD="$JAVA_HOME/jre/sh/java" else JAVACMD="$JAVA_HOME/bin/java" fi if [ ! -x "$JAVACMD" ] ; then die "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME Please set the JAVA_HOME variable in your environment to match the location of your Java installation." fi else JAVACMD="java" which java >/dev/null 2>&1 || die "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH. Please set the JAVA_HOME variable in your environment to match the location of your Java installation." fi # Increase the maximum file descriptors if we can. if [ "$cygwin" = "false" -a "$darwin" = "false" -a "$nonstop" = "false" ] ; then MAX_FD_LIMIT=`ulimit -H -n` if [ $? -eq 0 ] ; then if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ] ; then MAX_FD="$MAX_FD_LIMIT" fi ulimit -n $MAX_FD if [ $? -ne 0 ] ; then warn "Could not set maximum file descriptor limit: $MAX_FD" fi else warn "Could not query maximum file descriptor limit: $MAX_FD_LIMIT" fi fi # For Darwin, add options to specify how the application appears in the dock if $darwin; then GRADLE_OPTS="$GRADLE_OPTS \"-Xdock:name=$APP_NAME\" \"-Xdock:icon=$APP_HOME/media/gradle.icns\"" fi # For Cygwin or MSYS, switch paths to Windows format before running java if [ "$cygwin" = "true" -o "$msys" = "true" ] ; then APP_HOME=`cygpath --path --mixed "$APP_HOME"` CLASSPATH=`cygpath --path --mixed "$CLASSPATH"` JAVACMD=`cygpath --unix "$JAVACMD"` # We build the pattern for arguments to be converted via cygpath ROOTDIRSRAW=`find -L / -maxdepth 1 -mindepth 1 -type d 2>/dev/null` SEP="" for dir in $ROOTDIRSRAW ; do ROOTDIRS="$ROOTDIRS$SEP$dir" SEP="|" done OURCYGPATTERN="(^($ROOTDIRS))" # Add a user-defined pattern to the cygpath arguments if [ "$GRADLE_CYGPATTERN" != "" ] ; then OURCYGPATTERN="$OURCYGPATTERN|($GRADLE_CYGPATTERN)" fi # Now convert the arguments - kludge to limit ourselves to /bin/sh i=0 for arg in "$@" ; do CHECK=`echo "$arg"|egrep -c "$OURCYGPATTERN" -` CHECK2=`echo "$arg"|egrep -c "^-"` ### Determine if an option if [ $CHECK -ne 0 ] && [ $CHECK2 -eq 0 ] ; then ### Added a condition eval `echo args$i`=`cygpath --path --ignore --mixed "$arg"` else eval `echo args$i`="\"$arg\"" fi i=`expr $i + 1` done case $i in 0) set -- ;; 1) set -- "$args0" ;; 2) set -- "$args0" "$args1" ;; 3) set -- "$args0" "$args1" "$args2" ;; 4) set -- "$args0" "$args1" "$args2" "$args3" ;; 5) set -- "$args0" "$args1" "$args2" "$args3" "$args4" ;; 6) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" ;; 7) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" ;; 8) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" "$args7" ;; 9) set -- "$args0" "$args1" "$args2" "$args3" "$args4" "$args5" "$args6" "$args7" "$args8" ;; esac fi # Escape application args save () { for i do printf %s\\n "$i" | sed "s/'/'\\\\''/g;1s/^/'/;\$s/\$/' \\\\/" ; done echo " " } APP_ARGS=`save "$@"` # Collect all arguments for the java command, following the shell quoting and substitution rules eval set -- $DEFAULT_JVM_OPTS $JAVA_OPTS $GRADLE_OPTS "\"-Dorg.gradle.appname=$APP_BASE_NAME\"" -classpath "\"$CLASSPATH\"" org.gradle.wrapper.GradleWrapperMain "$APP_ARGS" exec "$JAVACMD" "$@"
```

# gradlew.bat

```bat
@rem @rem Copyright 2015 the original author or authors. @rem @rem Licensed under the Apache License, Version 2.0 (the "License"); @rem you may not use this file except in compliance with the License. @rem You may obtain a copy of the License at @rem @rem https://www.apache.org/licenses/LICENSE-2.0 @rem @rem Unless required by applicable law or agreed to in writing, software @rem distributed under the License is distributed on an "AS IS" BASIS, @rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. @rem See the License for the specific language governing permissions and @rem limitations under the License. @rem @if "%DEBUG%" == "" @echo off @rem ########################################################################## @rem @rem Gradle startup script for Windows @rem @rem ########################################################################## @rem Set local scope for the variables with windows NT shell if "%OS%"=="Windows_NT" setlocal set DIRNAME=%~dp0 if "%DIRNAME%" == "" set DIRNAME=. set APP_BASE_NAME=%~n0 set APP_HOME=%DIRNAME% @rem Resolve any "." and ".." in APP_HOME to make it shorter. for %%i in ("%APP_HOME%") do set APP_HOME=%%~fi @rem Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script. set DEFAULT_JVM_OPTS="-Xmx64m" "-Xms64m" @rem Find java.exe if defined JAVA_HOME goto findJavaFromJavaHome set JAVA_EXE=java.exe %JAVA_EXE% -version >NUL 2>&1 if "%ERRORLEVEL%" == "0" goto execute echo. echo ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH. echo. echo Please set the JAVA_HOME variable in your environment to match the echo location of your Java installation. goto fail :findJavaFromJavaHome set JAVA_HOME=%JAVA_HOME:"=% set JAVA_EXE=%JAVA_HOME%/bin/java.exe if exist "%JAVA_EXE%" goto execute echo. echo ERROR: JAVA_HOME is set to an invalid directory: %JAVA_HOME% echo. echo Please set the JAVA_HOME variable in your environment to match the echo location of your Java installation. goto fail :execute @rem Setup the command line set CLASSPATH=%APP_HOME%\gradle\wrapper\gradle-wrapper.jar @rem Execute Gradle "%JAVA_EXE%" %DEFAULT_JVM_OPTS% %JAVA_OPTS% %GRADLE_OPTS% "-Dorg.gradle.appname=%APP_BASE_NAME%" -classpath "%CLASSPATH%" org.gradle.wrapper.GradleWrapperMain %* :end @rem End local scope for the variables with windows NT shell if "%ERRORLEVEL%"=="0" goto mainEnd :fail rem Set variable GRADLE_EXIT_CONSOLE if you need the _script_ return code instead of rem the _cmd.exe /c_ return code! if not "" == "%GRADLE_EXIT_CONSOLE%" exit 1 exit /b 1 :mainEnd if "%OS%"=="Windows_NT" endlocal :omega
```

# local.properties

```properties
## This file must *NOT* be checked into Version Control Systems, # as it contains information specific to your local configuration. # # Location of the SDK. This is only used by Gradle. # For customization when using a Version Control System, please read the # header note. #Wed Apr 30 20:41:20 PST 2025 sdk.dir=C\:\\Users\\Fretz\\AppData\\Local\\Android\\Sdk # This is your secret Google Maps API Key MAPS_API_KEY=AIzaSyBTO_iqSF7ZI0KjHOStNId1k_8TymYjtK4
```

# settings.gradle.kts

```kts
// settings.gradle.kts pluginManagement { repositories { google { content { includeGroupByRegex("com\\.android.*") includeGroupByRegex("com\\.google.*") includeGroupByRegex("androidx.*") } } mavenCentral() gradlePluginPortal() } } dependencyResolutionManagement { repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS) repositories { google() mavenCentral() // Add JitPack repository for osmdroid-bonuspack and other libraries maven { url = uri("https://jitpack.io") } } } rootProject.name = "AlayaApp" include(":app")
```

